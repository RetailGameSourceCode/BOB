sandbank			equ	13borgbank			equ	7borgframe			equ	4abank				equ	19		;ancient bankubank				equ	24		;bubble forest bankpussbank			equ	24		;pussman bankufbank				equ	10		;ult. force interior bank (sfr)armbank				equ	11		;bank arm boss (sfr & obj)fatheadbank			equ	10		;ancient fat head boss bank (sfr)mutoidbank			equ	14		;mutoid boss bankvirusbank			equ	4		;ultra force final boss banklifterbank			equ	14		;screen lifter boss bankdeathbank			equ	11		;death boss frames bankqueenbank			equ	12		;queen framesdrain1				equ	5 ***	borg enemy logic***	borg types - used by PIClogicborg_guard		equ	1		;same as patrol nowborg_patrol		equ	2borg_shooter	equ	3borg_jumper		equ	4		borg_small		equ	5borg_flyer		equ	6borg_ducker		equ	7borg_flyerv		equ	8		;vertical flyerborg_tosser		equ	9*	borg actions - used by PICstatusborg_shoot		equ	1borg_start		equ	2borg_stop		equ	3borg_prejump	equ	4borg_land		equ	5borg_jump		equ	6borg_duck		equ	7borg_getup		equ	0borg_turn		equ	8borg_minitank	equ	9hiddengun_rise	equ	10flygun_shoot	equ	11zapperbeam		equ	12		;hovering zapper beamqueensplat		equ	13		;queen splatting apartqueen_hole		equ	14		;queen leggies wiggling aboutsnakehead		equ	15		;borg boss snakeheadborg_stand		equ	16borg_move		equ	17falling_brick	equ	18		;falling ancient brickflower			equ	19		;open arm boss rose flower thingyborg_fall		equ	0borg_sleeping	equ	0borg_waking		equ	0borgbullet5	equ	20borgbullet6	equ	21borgbullet7	equ	22borgbullet8	equ	23borgbullet9	equ	24borgbullet1	equ	25borgbullet2	equ	26borgbullet3	equ	27borgbullet4	equ	28cockroach		equ	29egg				equ	30worker_walk		equ	31worker_jump		equ	32worker_land		equ	33worker_fire		equ	34venomball		equ	35worker_stand	equ	36dropper_left	equ	37backarm_emerge	equ	38		;arm boss arm emergesdropper_chew	equ	39hiddengunbullet	equ	40bottomlarvae	equ	41queensprout		equ	42crab_walk	equ	43crab_attack	equ	44crab_stand	equ	45scorpion_stand	equ	46scorpion_walk	equ	47scorpion_attack	equ	48scorpion_turn	equ	49queenscurry	equ	50druid_walk		equ	51druid_live		equ	52druid_clap		equ	53druid_die		equ	54druid_bolt		equ	55skull_float		equ	56hand_splat		equ	57queen_fire		equ	58queen_tail		equ	59queen_drip		equ	60queen_larvae	equ	61ghost_big		equ	62ghost_small		equ	63ghost_tiny		equ	64ghost_split		equ	65statue_float	equ	66statue_attack	equ	67imp_fly			equ	68lavaman_emerge		equ	69lava_bubble		equ	70planet1		equ	71		;planet shapes #1planet2		equ	72		;planet shape #2planet3		equ	73		;planet #3worker_prejump		equ	74eclipse			equ	75	;ancient eclipse bullet	fourwayside		equ	76		;4 way side shot flamefourwayvert		equ	77		;4 way vertical flamegasjetside		equ	78		;gas jet side shot gasjetvert		equ	79		;gas jet vertical shotmouth_spitball	equ	80		;mouth boss falling spitballmouth_spitball2	equ	81		;mouth boss landed spitballdeath_missile	equ	82		;death boss missileshadow_emerge	equ	83		;shadow man emergesshadow_fly		equ	84		;shadow man fliesshadow_vanish	equ	85		;shadow man vanishesdonut			equ	86		;flying donutvenusattack		equ	87		;venus flytrap tries to eat bobshroom			equ	88		;mushroom grows and explodesrighttreeturret equ	89		;tree fires rightlefttreeturret	equ	90		;tree fires rightbounceball		equ	91		;bouncing fun ball rain arm_grab		equ	92		;arm boss picks up bobarm_hammer		equ	93		;arm boss hammers down on bobarm_head		equ	94		;arm's head rises from flower podforearm_emerge	equ	95		;foreground arm emergesjungbullet		equ	96		;jungle ball bulletvenus_shoot		equ	97		;flytrap shoot bulletlavaboss_burn	equ	98		;lava boss flaming awaylavaboss_shoot	equ	99		;lava boss shooting fireballlavaboss_explode	equ	100	;lava boss explodingbubbleman_walk	equ	101		;bubble man walkingbubbleman_stand	equ	102		;bubble man standing and jigglingpussman1		equ	103		;puss man eye openpussman2		equ	104		;puss man eye closedembryo_ball		equ	105		;embryo in a ballembryo_squirm	equ	106		;embryo squirming aroundfish			equ	107		;jumper fishjellycell		equ	108		;jelly cellshrapnel		equ	109		;generic splat shrapneleel				equ	110		;lamprey eel animationcluster5		equ	111		;cell cluster with 5 cellscluster4		equ	112		;cell cluster with 4 cellscluster3		equ	113		;cell cluster with 3 cellscluster2		equ	114		;cell cluster with 2 cellscluster1		equ	115		;cell cluster with 1 cellpussdropper		equ	116		;ceiling pussball dropperpussdrop		equ	117		;pussball drop from pussdroppernervezapside	equ	118		;nerve zap horiz.nervezapvert	equ	119		;nerve zap verticaljungbullet2		equ	120		;small jungle bulletultrabullet		equ	121		;ultra force bulletpussturretside	equ	122		;puss turret left/rightpussturretvert	equ	123		;puss turret up/downpussmineburst	equ	124		;puss mine expand, explodeancbossbullet	equ	125		;ancient mouth boss bulletdeathbody		equ	126		;death boss body wiggledeathgun1		equ	127		;death gun #1 rotatedeathgun1fire	equ	128		;death gun #1 when firingdeathgun2		equ	129		;death gun #2 rotatedeathgun2fire	equ	130		;death gun #2 when firingdeathvomit		equ	131		;death boss vomit effectdeathheadvomit	equ	132		;death head vomit deathheadlaugh	equ	133		;death head laugh deathheadshoot	equ	134		;death head eyes firedeathbullet		equ	135bossshrapnel	equ	136		;SPECIAL SHRAPNEL FOR BOSSESmanstand			equ	137		;mutoid boss movesmanshuffle			equ	138manjump				equ	139manland				equ	140manjumpkick			equ	141manpunch			equ	142manshoot			equ	143manbullet			equ	144			;actual bulletmanexplode			equ	145		;mutoid boss explodevirusturn1			equ	146		;virus boss spin ver.1virusturnfinal		equ	150		;sucker fuckervirusturntiny		equ	151		;all in distance spinningviruszoomout		equ	152		;zoom outviruszoomin			equ	157		;zoom invirusshoot			equ	162		;shoot at boblavaball_trail		equ	163		;remains from lavaballsfireball			equ	164		;lava/ancient fireballlifterbullet		equ	165		;screen lifter fireball bulletlifterhead			equ	166		;screen lifter bouncing head firesmanskullrise		equ	167		;mutoid skull rises upbabylifterrecoil	equ	168		;baby lifter shoot/startbabylifterstop		equ	169		;baby lifter comes to a stopvirus3dbullet		equ	170		;virus boss 3d bulletvirus_dropmine		equ	171		;virus drops a minevirus_punchleft		equ	172		;virus punches leftvirus_punchright	equ	173		;virus punches rightvirus_death1		equ	174		;virus boss dies big timevirus_death2		equ	175		;virus boss dies - overlay;eye-spitting ancient boss (middle, left then right sides)		mouth_open_m		equ	176	mouth_open_l		equ	177		mouth_open_r		equ	178mouth_jump_m		equ	179mouth_jump_l		equ	180mouth_jump_r		equ	181mouth_land_m		equ	182mouth_land_l		equ	183mouth_land_r		equ	184mouth_spiteye_m		equ	185mouth_spiteye_l		equ	186mouth_spiteye_r		equ	187mouth_lwalk_m		equ	188mouth_lwalk_l		equ	189mouth_lwalk_r		equ	190mouth_rwalk_m		equ	191mouth_rwalk_l		equ	192mouth_rwalk_r		equ	193mouth_die_m			equ	194mouth_die_l			equ	195mouth_die_r			equ	196mouth_wake_m		equ	197mouth_wake_l		equ	198		mouth_wake_r		equ	199mouth_die2_m			equ	200mouth_die2_l			equ	201mouth_die2_r			equ	202lifter_look			equ	203snakeneck			equ	204manskull			equ	205		;mutoid boss spinning skullsvirusbullet			equ	206		;virus boss bulletsnakeeyesopen		equ	207		;snake eyes open upsnakeheadgun		equ	208		;snake head turret pops out/invirus_float			equ	209		;virus boss float framevirus_freak			equ	210		;virus freaks out before dying;-----------------------------------------------------------------borgspeed		equ	3borgshotspeed:	dc.b	35,25,15		;various world shot rates in *2 ticksborg_inittable:	dc.b	borg_start		;guard	dc.b	borg_start		;patroller	dc.b	borg_stand		;attacker	dc.b	borg_prejump	;jumper	dc.b	borg_duck					;	dc.b	borg_prejump	;jumper	dc.b	borg_duck							dc.b	borg_duck					dc.b	borg_duck					borgcolors:	dc.b 1,3,4,1borgtask:	lda #4	sta PICbank,x		lda #2	sta PICscroll,x		jsr initdir		lda #3	clc	adc world	sta PIChealth,x		lda #99	sta PICtemp2,x		;make borg fire right away		;PICologic already holds type of borg	@initialize		;init any special stuff	lda PIClogic,x	tay					;get the initial aniamtions going...	lda borg_inittable-1,y	jsr initanim		;set the first sequence going		@set:	lda PICmaplo,x	clc	adc PICmaphi,x	and #3	tay	lda borgcolors,y	sta PICcolor,x	lda #6	sta PICsize,x		jsl PICput	dw borg1f0			;1st frame for stun bug	;------------main loop--------------------------		jsl TSKsuspend	@initweapons:	lda borgweaponflag	;change weapon dma zone?	and #1	bne @setweapons			;no		lda level	and #1	bra @set2		stz borgweaponbase		;base weapon pointer for fire_bullet		lda #16			;or 18 for other set	bra @setall	@set2:	lda #3	sta borgweaponbase		;use other three types		lda #18@setall:	sta sdmaflag	stz sdmacount	inc borgweaponflag@setweapons:****************************************************** borg attack logic....*****************************************************	lda #0	jsr shootenemy			;blow up?		lda PIClogic,x			;what is current attack?	cmp #borg_patrol	beq @gotoit	cmp #borg_ducker	beq @gotoit	cmp #borg_shooter	bne @main2	@gotoit:	jmp @patrol	@main2:	cmp #borg_jumper	bne @main3		jmp @jump	@main3:;;	jsl TSKcancel		rtl			;unsure of type		**************************************************@jump:	jsr initdir		lda PICstatus,x	cmp #borg_jump	beq @jump2	cmp #borg_land	beq @jump4		lda #1	sta PICscroll,x		;don't let him jump himself offscreen		;still in pre-jump so wait...	lda PICflag,x	bne @readytojump		;done anticipation so now in air!		jmp @donejump	@readytojump	lda #borg_jump	jsr initanim		jmp @donejump	@jump2:				;mid air stuff	lda PICcount2,x		inc PICcount2,x		;read ymove from table		tay	lda jumptable1,y	cmp #128			;eof?	bne @jump3					;reset flight counter	stz PICcount2,x		lda #borg_land	jsr initanim	jmp @donejump	@jump3:	cmp #127	bne @nojumpshot		;fire gun		lda #16	jsl PICysub	jsr fire_borgbullet			;shoot in mid-jump!!!	lda #16	jsl PICyadd		bra @donejump	@nojumpshot:	jsl PICyadd	bra @donejump	@jump4:			;wait for landing to end, then jump again	lda PICflag,x	beq @donejump		;still waiting to finish		lda #2	sta PICscroll,x		;don't let him jump himself offscreen	lda #borg_prejump	jsr initanim	jsr initdir		@donejump:	jmp @animate***********************************************************	patrolling borg *@patrol:			;main loop for borg patrollers		lda PICstatus,x	cmp #borg_start	beq @gotomove	cmp #borg_move	bne @next1	@gotomove:	jmp @move		@next1:	cmp #borg_turn	bne @next2		jmp @turn	@next2:	cmp #borg_stop	bne @next3		jmp @stop	@next3:	cmp #borg_duck	bne @next4		jmp @duck	@next4:	cmp #borg_getup	bne @next5		jmp @getup	@next5	cmp #borg_land	bne @next7		jmp @land	@next7	cmp #borg_stand	bne @next8		jmp @stand	@next8	cmp #borg_shoot	bne @next9		jmp @shoot	@next9	jmp @animate		*********************************************************@stand:				;what should the friggin' borg do now, weeniehead?	jsr facebob	bcc @st1			;already facing bob		lda #borg_turn	;no so turn now	jsr initanim	jmp @animate	@st1:	@notthetarget:		inc PICtemp2,x		ldy world				;rate of fire	lda borgshotspeed,y	sta temp		lda PICtemp2,x	cmp temp			bcc @noshot		;limit shots	@makeshot:	stz PICtemp2,x	jsr borglos				;see bob?	bcc @throw_instead		;no so make other attack (or none)		lda #8	jsl PICysub	jsr fire_borgbullet		;shoot!!!!		lda #8	jsl PICyadd		lda #borg_shoot	jsr initanim	jmp @animate	@throw_instead:	lda #99	sta PICtemp2,x	;make borg fire as soon as bob gets in LOS	@noshot:	jmp @animate	;---------------------------	@getgoing:	lda #borg_start	jsr initanim	jmp @animate		;chase Bob-o, bonehead!***;-------------------------------------------@land:	lda PICflag,x	beq @land2		lda #borg_start		;stop borg now	jsr initanim@land2:	jmp @animate;-----------------------------------------------@duck:	jsr initdir		lda PICanim,x	cmp #4				;standing shot	beq @duckshot	cmp #24				;ducked shot	bne @noduckshot	@duckshot:	lda PICxhi,x	ora PICyhi,x	bne @noduckshot			;offscreen		lda PICcount,x	cmp #1	bne @noduckshot		lda PICanim,x	cmp #4	beq @highshot			;ducked shot or standing?	@lowshot:	lda #16	jsl PICyadd	jsr fire_borgbullet		;shoot while ducked!!!		lda #16	jsl PICysub	bra @noduckshot	@highshot:	lda #8	jsl PICysub	jsr fire_borgbullet		;shoot while ducked!!!		lda #8	jsl PICyadd	@noduckshot:	jmp @animate	;@nostop				;just move - no other checks for now;--------------------------------------@getup:	lda PICflag,x	beq @getup2			;not done yet		lda #borg_move	jsr initanim	@getup2:	jmp @animate	;@nostop				;just move - no other checks for now;-----------------------------------------------------------------@stop:	@shoot:			;same as wait for stop	lda PICflag,x	beq @shoot2		lda #borg_stand	jsr initanim	@shoot2:	jmp @animate	;----------------------------------------------------@move:	lda PICstatus,x		;check for completion of start anim	cmp #borg_move	beq @move2			;must already be moving so skip check		lda PICflag,x	beq @move2			;still waiting to finish startup		lda #borg_move	jsr initanim		;now at full tilt...	@move2:	lda PIClogic,x		;patrolling or guarding move?	cmp #borg_patrol	bne @notmoving			;nothing moves but patroller		@patroller:				;move 64 pixels then stop	lda PICcount2,x	cmp #6	bcc @keepguarding	;not at end of zone so keep going		;reached attack position		lda #borg_stop		;stop borg now	jsr initanim		lda #borg_shooter	sta PIClogic,x	@notmoving	jmp @animate	;---------------------@keepguarding:	inc PICcount2,x		;must be a guard...	@p1:@p11:@p2:				;see which way borg is going...	lda #borgspeed*2	jsr movetaskx		jmp @animate	***************@turn:	lda PICanim,x	cmp #2				;half way through so change dir	bne @keepturning		lda PICcount,x		;only change dir once	bne @keepturning		lda PICdir,x		;turn borg around	eor #1	sta PICdir,x	@keepturning:	lda PICflag,x		;finished turn yet?	beq @kt2	lda #borg_stand	jsr initanim				lda #99	sta PICtemp2,x		;fire right away	@kt2:	jmp @animate	***************************************************		@animate:		jsr animborg		jsr setdir			;flip task left or right depending on PICdir		rtl;----------------------------------------------------fire_borgbullet:		;routine to fire 1 of 6 bullet types....		lda PICylo,x	lsr a	lsr a	lsr a	lsr a	lsr a	tay	lda borgbulletvspeed,y	tay		lda world			;type of shot....(1-3)	clc	adc #3	tax		lda #6					;set speed...	clc	adc world	clc	adc borgweaponbase		;which set of three to use?;	ldy #0	jsr fire_bullet	rtsborgbulletvspeed:	dc.b	3,2,1,0,-1,-2,-3,-4****************************************************jumptable1:			;data for borg jump.	dc.b	-8,-8,-7,-7,-6,-5,-4,-3,-2,-1,-1,0,127	dc.b	0,0,1,1,2,3,4,5,6,7,7,8,8,128;----------------------------------------------------animborg:			;generic borg animation routine	lda PICflag,x	bne @done			;no anim if already done		inc PICcount,x	lda PICcount,x	cmp #2	bcs @nextframe		rts	@nextframe:	lda #0	sta PICcount,x			lda PICstatus,x				;set base addr of anim table for this sequence	bmi @second_table		;which table - upper or lower?	@first_table:	asl a	tay	lda borgframebase-2,y	sta temp	lda borgframebase-1,y	bra @grabframe	@second_table:	sec	sbc #128	asl a	tay	lda borgframebase2,y	sta temp	lda borgframebase2+1,y	@grabframe:	sta temp+1	@grabframe2:	lda PICanim,x	inc PICanim,x		;inc after getting offset!	asl a	tay	lda (temp),y	sta tmp	iny	lda (temp),y	bne @valid	*	reset anim	lda tmp				;now check low byte for flag	cmp #$ff	beq @resetanim	@stopanim:				;anim stops at end	dec PICanim,x	lda #1	sta PICflag,x	bra @done	@resetanim:				;keep looping this anim	lda #0	sta PICanim,x	bra @grabframe2		;start again to show new frame	@valid:	sta tmp+1	jsl PICput2	@done:	rts;---------------------------------------------------------------**********************************************	setdir - face task based on PICdir*********************************************setdir:	lda PICdir,x			;set direction	bne @faceright	@faceleft:	jsl PICxflip	rts	@faceright:	jsl PICxunflip	rts	**********************************************setdir2:				;reverse of setdir - left=1, right=0	lda PICdir,x			;set direction	beq @faceright	@faceleft:	jsl PICxflip	rts	@faceright:	jsl PICxunflip	rts	**********************************************setdirv:			;set vertical dir	lda PICdirv,x			;set direction	bne @facedown	@faceup:	jsl PICyflip	rts	@facedown:	jsl PICyunflip	rts	**********************************************initanim:			;initialize new animation	sta PICstatus,x		;set type of animation						;reset pointers	stz PICanim,x	stz PICflag,x		lda #99	sta PICcount,x		rts	;-----------------------------------------------------------------borgframebase:			;1st table	dc.w	banim1	dc.w	banim2	dc.w	banim3	dc.w	banim4	dc.w	banim5	dc.w	banim6	dc.w	banim7	dc.w	banim8	dc.w	banim9	dc.w	banim10	dc.w	banim11	dc.w	banim12	dc.w	banim13	dc.w	banim14	dc.w	banim15	dc.w	banim16	dc.w	banim17	dc.w	banim18	dc.w	banim19	dc.w	banim20	dc.w	banim21	dc.w	banim22	dc.w	banim23	dc.w	banim24	dc.w	banim25	dc.w	banim26	dc.w	banim27	dc.w	banim28	dc.w	banim29	dc.w	banim30	dc.w	banim31	dc.w	banim32	dc.w	banim33	dc.w	banim34	dc.w	banim35	dc.w	banim36	dc.w	banim37	dc.w	banim38	dc.w	banim39	dc.w	banim40	dc.w	banim41	dc.w	banim42	dc.w	banim43	dc.w	banim44	dc.w	banim45	dc.w	banim46	dc.w	banim47	dc.w	banim48	dc.w	banim49	dc.w	banim50	dc.w	banim51	dc.w	banim52	dc.w	banim53	dc.w	banim54	dc.w	banim55	dc.w	banim56	dc.w	banim57	dc.w	banim58	dc.w	banim59	dc.w	banim60	dc.w	banim61	dc.w	banim62	dc.w	banim63	dc.w	banim64	dc.w	banim65	dc.w	banim66	dc.w	banim67	dc.w	banim68	dc.w	banim69	dc.w	banim70	dc.w	banim71	dc.w	banim72	dc.w	banim73	dc.w	banim74	dc.w	banim75	dc.w	banim76	dc.w	banim77	dc.w	banim78	dc.w	banim79	dc.w	banim80	dc.w	banim81	dc.w	banim82	dc.w	banim83	dc.w	banim84	dc.w	banim85	dc.w	banim86	dc.w	banim87	dc.w	banim88	dc.w	banim89	dc.w	banim90	dc.w	banim91	dc.w	banim92	dc.w	banim93	dc.w	banim94	dc.w	banim95	dc.w	banim96	dc.w	banim97	dc.w	banim98	dc.w	banim99	dc.w	banim100	dc.w	banim101	dc.w	banim102	dc.w	banim103	dc.w	banim104	dc.w	banim105	dc.w	banim106	dc.w	banim107	dc.w	banim108	dc.w	banim109	dc.w	banim110	dc.w	banim111	dc.w	banim112	dc.w	banim113	dc.w	banim114	dc.w	banim115	dc.w	banim116	dc.w	banim117	dc.w	banim118	dc.w	banim119	dc.w	banim120	dc.w	banim121	dc.w	banim122	dc.w	banim123	dc.w	banim124	dc.w	banim125	dc.w	banim126	dc.w	banim127borgframebase2:			;2nd table	dc.w	banim128,banim129,banim130	dc.w	banim131,banim132,banim133,banim134,banim135	dc.w	banim136	dc.w	banim137,banim138,banim139,banim140,banim141	dc.w	banim142,banim143,banim144,banim145,banim146	dc.w	banim147,banim148,banim149,banim150,banim151	dc.w	banim152,banim153,banim154,banim155,banim156	dc.w	banim157,banim158,banim159,banim160,banim161	dc.w	banim162,banim163,banim164,banim165,banim166	dc.w	banim167,banim168,banim169,banim170,banim171	dc.w	banim172,banim173,banim174,banim175,banim176	dc.w	banim177,banim178,banim179,banim180,banim181	dc.w	banim182,banim183,banim184,banim185,banim186	dc.w	banim187,banim188,banim189,banim190,banim191	dc.w	banim192,banim193,banim194,banim195,banim196	dc.w	banim197,banim198,banim199,banim200,banim201	dc.w	banim202,banim203,banim204,banim205,banim206	dc.w	banim207,banim208,banim209,banim210	;,banim206banim1:			;shoot recoil	dc.w	borg1f1,borg1f2,borg1f3,borg1f4	;shoot	dc.w	$0000	banim2:			;start moving	dc.w	borg1f1,borg1f2,borg1f3,borg1f4	;shoot	dc.w	$0000banim3:			;stop moving	dc.w	borg1f5,borg1f6,borg1f7,borg1f8,borg1f9			dc.w	0000banim4:			;anticipate jump	dc.w	borg1f0,borg1f19,borg1f20,borg1f21		dc.w	$0000banim5:			;landing	dc.w	borg1f19,borg1f20,borg1f23,borg1f24,borg1f0	dc.w 	borg1f0,borg1f0,borg1f0,borg1f0,borg1f0	dc.w	0000banim6:			;mid air jump	dc.w	borg1f22	dc.w	0000banim7:			;borg duck & shoot, getup & shoot	dc.w	borg1f0,borg1f0,borg1f0,borg1f0		;stand	dc.w	borg1f2,borg1f2,borg1f2,borg1f3,borg1f3	;shoot	dc.w	borg1f4	dc.w	borg1f0,borg1f0,borg1f0,borg1f0		;stand	dc.w	borg1f10,borg1f11,borg1f12,borg1f13,borg1f14	;duck	dc.w	borg1f14,borg1f14,borg1f14	;ducked	dc.w	borg1f14,borg1f14,borg1f13,borg1f12	;ducked	dc.w	borg1f13,borg1f14,borg1f14	;ducked	dc.w	borg1f13,borg1f15,borg1f16,borg1f17,borg1f18	;getup	dc.w	$ffbanim8:	dc.w	borg1f25,borg1f26	;turning	dc.w	borg1f26,borg1f25	;other way	dc.w	$0000banim9:				;borg mini walking tank	dc.w 	borg1f52,borg1f53,borg1f54,borg1f55	dc.w	$ff			;loop cyclebanim10		;hidden gun rises up	dc.w	borg1f44	dc.w	borg1f45	dc.w	borg1f46	dc.w	borg1f47	dc.w	borg1f47	dc.w	borg1f47	dc.w	borg1f47	dc.w	borg1f47	dc.w	borg1f46	dc.w	borg1f45	dc.w	borg1f44	dc.w 	0000banim11			;flying gun shoot & recoil	dc.w	borg1f42	dc.w	borg1f43	dc.w	borg1f41	dc.w 	0000	banim12		;hovering zapper beam	dc.w	hoverf1,hoverf2,hoverf3,hoverf4	dc.w	hoverf1,hoverf2,hoverf3,hoverf4	dc.w	0	banim13		;queen splat			dc.w	queenf16	dc.w	0000								banim14:		;queen holes	dc.w	queenf7,queenf7,queenf8,queenf8	dc.w	queenf9,queenf9,queenf9,queenf9	dc.w	queenf9,queenf9,queenf9,queenf9	dc.w	queenf9,queenf9,queenf9,queenf9	dc.w	queenf9,queenf9,queenf9,queenf9	dc.w	queenf9,queenf9,queenf9,queenf9	dc.w	queenf9,queenf9,queenf9,queenf9	dc.w	queenf9,queenf9,queenf9,queenf9	dc.w	queenf9,queenf9,queenf9,queenf9	dc.w	queenf9,queenf9,queenf9,queenf9	dc.w	queenf9,queenf9,queenf9,queenf9	dc.w	queenf9,queenf9,queenf9,queenf9	dc.w	queenf8,queenf8,queenf7,queenf7	dc.w	queenf6	dc.w	0000banim15:			;snake head borg boss	dc.w	snakef14,snakef20,snakef21	dc.w 	snakef22,snakef23,snakef24	dc.w 	snakef25,snakef25,snakef25	dc.w	snakef26,snakef13	dc.w	0000banim16	dc.w	borg1f0,0000			;standingbanim17:	dc.w	borg1f0,$0000			;move framebanim18:			;falling ancient brick	dc.w	bowf7,bowf7,bowf7	dc.w	bowf8,bowf8,bowf8	dc.w	bowf9,bowf9,bowf9	dc.w	0000banim19:			;arm boss opening rose flower thingy;	dc.w	arm1f1;	dc.w	arm1f2;	dc.w	0000banim20:			;boomerange bullet	dc.w	bweapon1f0,bweapon1f1,bweapon1f0,bweapon1f1,$ffbanim21:		;photon torperdo bullet	dc.w	bweapon1f3,bweapon1f4,bweapon1f3,bweapon1f4,$ffbanim22:		;small plasma bullet	dc.w	bweapon2f5,$0000banim23:		;big plasma	dc.w	bweapon2f0,bweapon2f1,bweapon2f2,bweapon1f3	dc.w	bweapon2f4,0000banim24:		;star bullet	dc.w	bweapon2f6,$0000banim25:			;spinning bullet	dc.w	borg1f30	dc.w	0000banim26:			;snake head sperm bullet	dc.w	snakef6,snakef7,snakef8	dc.w	$ffbanim27:			;snake head laser bullet	dc.w	snakef9,snakef10	dc.w	$ffbanim28			;regular borg bullet	dc.w 	bweapon1f2,$0000banim29:			;cockroach	dc.w	bugf8,bugf9	dc.w	$ffbanim30:		;cracking good egg!	dc.w	bugf1,bugf2,bugf2	dc.w	0000banim31:			;worker bug walk	dc.w	bugf26,bugf27,bugf28	dc.w	$ff						;cycle itbanim32:		;worker bug jump	dc.w	bugf35,bugf35,bugf36,bugf36	dc.w	bugf29,bugf30,bugf31,bugf29	dc.w	0000banim33:		;worker bug landing	dc.w	bugf37,bugf38,bugf39,bugf29,bugf29,bugf29	dc.w	0000banim34:		;worker bug fire venom	dc.w	bugf29,bugf30,bugf30,bugf30,bugf30,bugf31	dc.w	0000banim35:		;venom ball	dc.w	bugf4,bugf5	dc.w	$ffbanim36:	dc.w	bugf29			;worker standing still	dc.w	0000banim37:					;ceiling dropper left;;;	dc.w	bugf16,bugf15,bugf14,bugf13	dc.w	bugf13,0000;;;	dc.w	$ffbanim38:			;arm boss back arm emerges;	dc.w	arm2f1;	dc.w	0000banim39:			;ceiling dropper chewing bob's head	dc.w	bugf19,bugf20	dc.w	bugf19,bugf20	dc.w	bugf19,bugf20	dc.w	bugf19,bugf20	dc.w	0000banim40:			;hidden gun bullet	dc.w	borg1f48,borg1f49,borg1f50,borg1f51,0000	banim41:			;larvae dropped by queen's tail	dc.w	queenf32,queenf33,queenf34,$ff	banim42:			;queen head sprouts up from ground 	dc.w	queenf0,queenf0,queenf0,queenf0,queenf0	dc.w	queenf24,queenf25,queenf26,queenf27,queenf29,0000banim43:			;sandscrab walk	dc.w 	bug2f13,bug2f14,bug2f15,bug2f16	dc.w 	$ff	banim44:			;sandscrab attack	dc.w 	bug2f9,bug2f10,bug2f11,bug2f12	dc.w 	bug2f12,bug2f11,bug2f10,bug2f9	dc.w 	0000banim45:;	dc.w	sandf28		;standing crab	dc.w	0000banim46:			;scorpion stand	dc.w	bug2f4	dc.w	0000banim47:			;scorpion walk	dc.w 	bug2f0,bug2f1,bug2f2,bug2f3	dc.w	$ffbanim48:			;scorpion attack	dc.w 	bug2f4,bug2f6,bug2f6	dc.w	bug2f7,bug2f7		;sting frames	dc.w	bug2f7,bug2f7		;sting frames	dc.w	bug2f7,bug2f7		;sting frames	dc.w 	bug2f8,bug2f6,bug2f4	dc.w	bug2f4,bug2f4	dc.w	0000banim49:			;scorpion turn	dc.w 	bug2f5,bug2f5,bug2f4,bug2f4	dc.w	0000	banim50:			;queen head scurry	dc.w	queenf28,queenf29,queenf30,queenf31,$ff	banim51:		;druid walk	dc.w	drudf7,0000banim52:		;druid live (rise up)	dc.w	drudf15,drudf14,drudf13,drudf8	dc.w 	0000banim53:		;druid clap for lightening	dc.w	drudf8,drudf8	dc.w	drudf8,drudf9,drudf9,drudf10	dc.w 	drudf11,drudf12			;anim fuzzy stuff	dc.w 	drudf11,drudf12			;anim fuzzy stuff	dc.w 	drudf11,drudf12			;anim fuzzy stuff	dc.w 	drudf11,drudf12			;anim fuzzy stuff	dc.w 	drudf11,drudf12			;anim fuzzy stuff	dc.w 	drudf11,drudf12			;anim fuzzy stuff	dc.w 	drudf11,drudf12			;anim fuzzy stuff	dc.w 	drudf10,drudf9,drudf9,drudf8	dc.w	drudf8,drudf8	dc.w	drudf8,drudf8	dc.w	drudf8,drudf8	dc.w	drudf8,drudf8	dc.w	drudf8,drudf8 	dc.w	drudf8,drudf8	dc.w	drudf8,drudf8	dc.w	drudf8,drudf8	dc.w	drudf8,drudf8	dc.w 	$ffbanim54:		;druid die (fall into heap)	dc.w	drudf13,drudf14,drudf15	dc.w 	0000banim55:		;druid lightening bolt 	dc.w 	drudf0,drudf1,drudf2,drudf3	dc.w 	0000banim56:		;skull crusher thing	dc.w 	skullf1,skullf2,skullf3,skullf4	dc.w	skullf4,skullf4					;hold open mounth	dc.w 	skullf3,skullf2,skullf1	dc.w 	skullf1,skullf1,skullf1			;close mouth	dc.w 	$ffbanim57:			;screaming hand eye splat	dc.w 	handf2,handf4,handf5,handf6,0000banim58:	dc.w	queenf0,queenf1,queenf2	;queen firing larvae	dc.w	queenf0	dc.w	0000banim59:		;queen tail drips	dc.w	queenf13,queenf13,queenf14,queenf14,queenf32	dc.w 	0000banim60:		;dripping ooze from queen body	dc.w	queenf17,queenf17	dc.w	queenf17,queenf18,queenf19,queenf19,queenf20,queenf20,queenf20	dc.w	queenf20,queenf20	dc.w	0000banim61:	dc.w	queenf4,queenf5,$ff		;larvae animatingbanim62:	dc.w	ghostf0,ghostf1,$ff		;big ghost banim63:	dc.w	ghostf2,ghostf3,$ff			;small ghostbanim64:		;teeny weeny ghost	dc.w	nukef1,nukef2,nukef3,nukef4,nukef5,nukef6,nukef7	dc.w	nukef8,nukef9	dc.w	0000banim65:		;big ghost splitting anim	dc.w	nukef0,nukef1,nukef2,nukef3,nukef4	dc.w	nukef3,nukef2,nukef1,ghostf2	dc.w	0000banim66:		;attacker statue	dc.w	shakef0,0000banim67:		;statue attacking with punch	dc.w	shakef1	dc.w	shakef2,shakef2	dc.w	shakef2,shakef3	dc.w	shakef3	dc.w	shakef0,shakef0	dc.w	shakef0,shakef0	dc.w	shakef0,shakef0	dc.w	shakef0,shakef0	dc.w	shakef0,shakef0	dc.w	shakef0,shakef0	dc.w	0000banim68:			;fire imp flying	dc.w	impf0,impf1,impf2,$ffbanim69:		;lava man rises up and throws a ball of crud	dc.w	lavaf11,lavaf11,lavaf12,lavaf12,lavaf13,lavaf13	dc.w	lavaf14,lavaf14,lavaf15,lavaf15,lavaf16,lavaf16	dc.w	lavaf17,lavaf17	dc.w	lavaf18,lavaf18,lavaf19	dc.w	lavaf19,lavaf17,lavaf17	dc.w	lavaf18,lavaf18,lavaf19	dc.w	lavaf19,lavaf17,lavaf17	dc.w	lavaf18,lavaf18,lavaf19	dc.w	lavaf19,lavaf19	dc.w	lavaf19,lavaf19	dc.w	lavaf19,lavaf19	dc.w	lavaf17,lavaf16,lavaf15,lavaf14,lavaf13,lavaf12	dc.w	lavaf11,lavaf11,lavaf11	dc.w	lavaf11,lavaf11,lavaf11	dc.w 	0000banim70:	dc.w	lavaf4,lavaf4,lavaf5,lavaf5,lavaf6,lavaf6,lavaf7	dc.w	lavaf7,lavaf8,lavaf8,lavaf9,lavaf9,lavaf10,lavaf10	dc.w	0000	banim71:			;planet 1	dc.w	planetf0,planetf1,planetf2,planetf3,planetf4,planetf5	dc.w	planetf6,planetf7,planetf8,planetf9,planetf10,planetf11	dc.w	planetf12,planetf13,planetf14,planetf15	dc.w	$ffbanim72:			;planet 2	dc.w	planetf16,planetf17,planetf18,planetf19	dc.w	planetf20,planetf21,planetf22,planetf23	dc.w	$ffbanim73:			;planet 3	dc.w	planetf24,planetf25,planetf26,planetf27	dc.w	planetf28,planetf29,planetf30,planetf31	dc.w	$ffbanim74:			;worker bug jump anticipate	dc.w	bugf29,bugf32,bugf33,bugf34,bugf34	dc.w	0000banim75:			;ancient eclipse bullet	dc.w	bowf4		;,bowf4	dc.w	bowf5		;,bowf5	dc.w	$ffbanim76:		;fourway side	dc.w	fourwayf5,fourwayf6,fourwayf7,fourwayf8	dc.w	fourwayf5,fourwayf6,fourwayf7,fourwayf8	dc.w	fourwayf5,fourwayf6,fourwayf7,fourwayf8	dc.w	0banim77:			;fourway vert	dc.w	fourwayf1,fourwayf2,fourwayf3,fourwayf4	dc.w	fourwayf1,fourwayf2,fourwayf3,fourwayf4	dc.w	fourwayf1,fourwayf2,fourwayf3,fourwayf4	dc.w	0banim78:		;gasjet side	dc.w	gasf0,gasf1,gasf2,gasf3	dc.w	gasf0,gasf1,gasf2,gasf3	dc.w	gasf0,gasf1,gasf2,gasf3	dc.w	gasf0,gasf1,gasf2,gasf3	dc.w	0banim79:			;gasjet vert	dc.w	gasf4,gasf5,gasf6,gasf7	dc.w	gasf4,gasf5,gasf6,gasf7	dc.w	gasf4,gasf5,gasf6,gasf7	dc.w	gasf4,gasf5,gasf6,gasf7	dc.w	0banim80:			;falling spitball (mouth boss)	dc.w	mouthf30,mouthf31,mouthf32,mouthf33	dc.w	mouthf34,mouthf35,mouthf36,mouthf37,mouthf38	dc.w	0000banim81:			;landed spitball (mouth boss)	dc.w	mouthf39	dc.w	mouthf40,mouthf41,mouthf42	dc.w	mouthf39,mouthf40,mouthf41,mouthf42	dc.w	mouthf41,mouthf42,mouthf41	dc.w	mouthf39,mouthf40,mouthf41,mouthf42	dc.w	mouthf40,mouthf41,mouthf40	dc.w	mouthf39,mouthf40,mouthf41,mouthf42	dc.w	mouthf43	dc.w	mouthf44	dc.w	mouthf45	dc.w	mouthf46	dc.w	mouthf47	dc.w	0000banim82:			;eye spit boss dies	dc.w	deathf49,deathf49	dc.w	deathf48,deathf48	dc.w	deathf47,deathf47		dc.w	deathf46,deathf46	dc.w	deathf47,deathf47		dc.w	deathf48,deathf48	dc.w	$ffbanim83:			;shadow man emerge	dc.w	shadowf0	dc.w	shadowf0,shadowf0	dc.w	shadowf0,shadowf0	dc.w	shadowf0,shadowf0,shadowf1,shadowf2	dc.w	shadowf3,shadowf4	dc.w	0000banim84:			;shadow man fly	dc.w	shadowf5,shadowf4	dc.w	$ffbanim85:			;shadow man vanish	dc.w	shadowf4,shadowf4	dc.w	shadowf3,shadowf3	dc.w	shadowf2,shadowf2	dc.w	shadowf1,shadowf1	dc.w	shadowf0,shadowf0	dc.w	0000banim86:			;flying donut	dc.w	donutf0	dc.w	donutf0	dc.w	donutf1	dc.w	donutf1	dc.w	donutf2	dc.w	donutf2	dc.w	donutf3	dc.w	donutf3	dc.w	donutf4	dc.w	donutf4	dc.w	$ffbanim87:		;venus flytrap attack	dc.w	venusf0,venusf1,venusf2,venusf3,venusf3	dc.w	venusf4,venusf5	dc.w	venusf6,venusf7	dc.w	venusf8,venusf9	dc.w	venusf10,venusf11	dc.w	venusf11	dc.w	0000banim88:		;mushroom pops and explodes	dc.w	mushf0,mushf0	dc.w	mushf0,mushf0	dc.w	mushf0,mushf0	dc.w	mushf0,mushf0	dc.w	mushf0,mushf0	dc.w	mushf0,mushf0	dc.w	mushf1,mushf1	dc.w	mushf2,mushf2	dc.w	mushf3,mushf3	dc.w	mushf4,mushf4	dc.w	0000	banim89:		;tree turret right	dc.w	jungf0,jungf0,jungf0,jungf0	dc.w	jungf1	dc.w	jungf2,jungf2,jungf2,jungf2	dc.w	jungf2,jungf2,jungf2,jungf2	dc.w	jungf1	;	dc.w	jungf0,jungf0,jungf0,jungf0	dc.w	0000	banim90:		;tree turret left	dc.w	jungf3,jungf3,jungf3,jungf3	dc.w	jungf4	dc.w	jungf5,jungf5,jungf5,jungf5	dc.w	jungf5,jungf5,jungf5,jungf5	dc.w	jungf4	;	dc.w	jungf3,jungf3,jungf3,jungf3	dc.w	0000banim91:		;bouncing ball rain	dc.w	jungf8,jungf8	dc.w	0000banim92:				;arm picks up & flings bob;	dc.w	arm2f2,arm2f3,arm2f3,arm2f4,arm2f5,arm2f6;	dc.w	arm2f6,arm2f6,arm2f6,arm2f5;	dc.w	arm2f1,0000banim93:				;arm hammers down on bob;	dc.w	arm2f7,arm2f7,arm2f7,arm2f7;	dc.w	arm2f8,arm2f9,arm2f9,arm2f9,arm2f10;	dc.w	arm2f7,arm2f11;	dc.w	arm2f11,arm2f11,arm2f11;	dc.w	0000banim94:		;arm head rises from flower;	dc.w	arm3f0,arm3f0;	dc.w	arm3f1,arm3f1;	dc.w	arm3f2,arm3f2;	dc.w	arm3f3,arm3f3;	dc.w	0000banim95:		;foreground arm emerges from pod;	dc.w 	arm2f0,arm2f7,arm2f11;	dc.w	0000banim96:		;forest ball bullet	dc.w	jungf6,jungf7,jungf8,jungf7	dc.w 	$ff	banim97:		;venus flytrap shoot bullet	dc.w	venusf0,venusf0,0000banim98:			;lavaboss burning	dc.w	lavabossf1	dc.w	lavabossf2	dc.w	lavabossf3	dc.w	$ffbanim99:			;lavaboss shooting fireballs	dc.w	lavabossf4	dc.w	lavabossf5	dc.w	lavabossf6	dc.w	lavabossf4	dc.w	lavabossf5	dc.w	lavabossf6	dc.w	0000banim100:			;lavaboss exploding	dc.w	lavabossf7	dc.w	lavabossf8	dc.w	lavabossf9	dc.w	lavabossf10	dc.w	lavabossf11	dc.w	lavabossf12	dc.w	0000banim101:		;bubble man walking	dc.w	bubblef0,bubblef1,bubblef2,bubblef3	dc.w	bubblef4,bubblef5,bubblef6,bubblef7	dc.w	bubblef8,bubblef9,bubblef10,bubblef11	dc.w	bubblef12,bubblef13,bubblef14,bubblef15	dc.w	$ff	banim102:		;bubble man stand	dc.w	bubblef16,bubblef17,$ff	banim103:		;pussman shoot;	dc.w 	pussf1,pussf2,pussf2,pussf3,pussf3;	dc.w	pussf0,pussf0,pussf0,pussf0,pussf0;	dc.w	pussf0,pussf0,pussf0,pussf0,pussf0	dc.w	0000	banim104:		;pussman eye closedbanim105:		; embryo in bubble	dc.w	mouthf23,mouthf24,mouthf23,mouthf24,mouthf23,mouthf24	dc.w	0000banim106:		; embryo popped out of bubble	dc.w	mouthf25,mouthf26,$ffbanim107:		;fish	dc.w	bodyf7,bodyf8,$ffbanim108:		;jelly celly 	dc.w	jellyf0,jellyf0,jellyf1,jellyf1	dc.w	jellyf2,jellyf2,jellyf3,jellyf3,$ff	banim109:		;shrapnel	dc.w	shrapnelf0	dc.w	shrapnelf1	dc.w	shrapnelf2	dc.w	shrapnelf3,$ffbanim110:		;eel	dc.w 	bodyf9,$0000banim111:		;cluster 5	dc.w	driftf0,driftf1,driftf2,driftf3,$ffbanim112:		;cluster 4	dc.w	driftf4,driftf5,driftf6,driftf7,$ffbanim113:		;cluster 3	dc.w	driftf8,driftf9,driftf10,driftf11,$ffbanim114:		;cluster 2	dc.w	driftf12,driftf13,driftf14,driftf15,$ffbanim115:		;cluster 1	dc.w	driftf16,driftf17,driftf18,driftf19,$ffbanim116:		;ceiling puss dropper	dc.w 	bodyf2,bodyf3,$ffbanim117:		;pusball dropped	dc.w	bodyf4	;,bodyf4,bodyf4	dc.w	bodyf5	;,bodyf5,bodyf5	dc.w	bodyf6	;,bodyf6,bodyf6	dc.w	0000banim118:		;nerve zapper horiz.	dc.w	bodyf11,bodyf12,bodyf13,bodyf14,bodyf15,bodyf16	dc.w	bodyf17,bodyf18	dc.w	bodyf11,bodyf12,bodyf13,bodyf14,bodyf15,bodyf16	dc.w	bodyf17,bodyf18	dc.w	bodyf11,bodyf12,bodyf13,bodyf14,bodyf15,bodyf16	dc.w	bodyf17,bodyf18	dc.w	0000	banim119:		;nerve zapper vertical	dc.w	bodyf19,bodyf20,bodyf21,bodyf22,bodyf23,bodyf24	dc.w	bodyf25,bodyf26	dc.w	bodyf19,bodyf20,bodyf21,bodyf22,bodyf23,bodyf24	dc.w	bodyf25,bodyf26	dc.w	bodyf19,bodyf20,bodyf21,bodyf22,bodyf23,bodyf24	dc.w	bodyf25,bodyf26	dc.w	0000banim120:		;small jungle bullet	dc.w	jungf10,jungf11,$ffbanim121:		;ultra force bullet 	dc.w	bodyf27	dc.w	bodyf28	dc.w	bodyf27	dc.w	bodyf28	dc.w	$ff	;dc.w	bodyf5,bodyf4,$ffbanim122:		;puss turret side	dc.w	spitterf1,spitterf1	dc.w	spitterf0,spitterf0	dc.w	spitterf0,spitterf0	dc.w	spitterf0,spitterf0	dc.w	spitterf0,spitterf0	dc.w	$ffbanim123:		;puss turret vert	dc.w	spitterf3,spitterf3	dc.w	spitterf2,spitterf2	dc.w	spitterf2,spitterf2	dc.w	spitterf2,spitterf2	dc.w	spitterf2,spitterf2	dc.w	$ffbanim124:		;puss mine pulsing away	dc.w	bodyf4,bodyf4	dc.w	bodyf5,bodyf5	dc.w	bodyf6,bodyf6	dc.w	bodyf6,bodyf6	dc.w	bodyf6,bodyf6	dc.w	bodyf6,bodyf6	dc.w	bodyf5,bodyf5	dc.w	$ff	banim125:		;ancient boss bullet	dc.w	mouthf27,mouthf28,mouthf27,mouthf29,$ff	banim126:	;death boss body wiggle	dc.w	deathf21,deathf22,deathf23,deathf24	dc.w	deathf25,deathf26,deathf27,deathf28	dc.w	$ff	banim127:		;death gun 1 not firing		dc.w	death f29,deathf29,deathf30,deathf30,deathf31,deathf31	dc.w	deathf32,deathf32,deathf31,deathf31,deathf30,deathf30	dc.w	$ffbanim128:		;death gun 1 firing		dc.w	deathf36,deathf29,deathf35,deathf30,deathf34,deathf31	dc.w	deathf33,deathf32,deathf34,deathf31,deathf35,deathf30	dc.w	$ffbanim129:		;death gun 2 not firing			dc.w	deathf38,deathf38,deathf39,deathf39	dc.w	deathf40,deathf40,deathf41,deathf41	dc.w	deathf40,deathf40,deathf39,deathf39	dc.w	$ffbanim130:		;death gun 2 firing!		dc.w	deathf45,deathf45,deathf44,deathf44	dc.w	deathf43,deathf43,deathf42,deathf42	dc.w	deathf43,deathf43,deathf44,deathf44	dc.w	$ffbanim131:		;death boss vomit effect		dc.w	deathf42,deathf42	dc.w	deathf42,deathf42	dc.w	deathf42,deathf42	dc.w	deathf43,deathf43	dc.w	deathf44,deathf44	dc.w	deathf45,deathf45	dc.w	deathf53		dc.w	deathf5,deathf6,deathf7	dc.w	deathf8,deathf9,deathf10	dc.w	deathf11,deathf12	dc.w	deathf13,deathf14,deathf15	dc.w	deathf16,deathf17,deathf18	dc.w	deathf19,deathf20,0000banim132:				;head vomit	dc.w	deathf1,deathf1,deathf1,deathf1,deathf1,deathf1	dc.w	deathf1,deathf1,deathf1,deathf1,deathf1,deathf1	dc.w	deathf1,deathf1,deathf1,deathf1,deathf1,deathf0	dc.w	0000	banim133:				;head laugh	dc.w	deathf2	dc.w	deathf3,deathf4,deathf3,deathf4,deathf3,deathf4	dc.w	deathf3,deathf2,deathf0	dc.w	0000	banim134:				;head shoot	dc.w	deathf2,deathf2,deathf2	dc.w	deathf3,deathf3,deathf3	dc.w	deathf4,deathf4,deathf4	dc.w	deathf4,deathf4,deathf4	dc.w	deathf0,0000	banim135:		;death boss bullet	dc.w	deathf50,0000		;37,0000banim136:	;boss shrapnel bits	dc.w	splatf25,splatf26,splatf27,splatf28,$ffbanim137:		;mutoid man stand	dc.w	manf0	dc.w	$0000	banim138:		;mutoid man shuffle	dc.w	manf1,manf1,manf2,manf2,$ff	banim139:		;mutoid man jump	dc.w	manf3,manf3	dc.w	manf4,manf5,manf5,manf5	dc.w	manf6,manf7	dc.w	0000	banim140:		;mutoid man land	dc.w	manf8,manf9,manf9	dc.w	manf4,manf0	dc.w	0000	banim141:		;mutoid man flying kick	dc.w	manf3	dc.w	manf3	dc.w	manf3	dc.w	manf3	dc.w	manf3	dc.w	manf3	dc.w	manf4,manf5	dc.w	manf10	dc.w	manf11	dc.w	manf12	dc.w	manf12	dc.w	manf12	dc.w	manf7	dc.w	0000	banim142:		;mutoid man punch	dc.w	manf0,manf0,manf0,manf0,manf0,manf0	dc.w	manf16,manf17,manf18,manf18	dc.w	manf19,manf19,manf20	dc.w	manf21,manf16	dc.w	manf16,manf16	dc.w	0000	banim143:		;mutoid man shoot	dc.w	manf22,manf22	dc.w	manf22,manf22	dc.w	manf22,manf22	dc.w	manf23	dc.w	manf24,manf25,manf26	dc.w	manf24,manf25,manf26	dc.w	manf24,manf25,manf26	dc.w	manf23,manf22,manf0	dc.w	0000	banim144:		;mutoid man bullet	dc.w	manf27	dc.w	$0000	banim145:		;mutoid man explodes!	dc.w	manf28,manf29,manf30	dc.w	manf31,manf32,manf33	dc.w	manf34,manf35,manf36	dc.w	manf37,manf38,manf39	dc.w	manf40,manf41,manf42	dc.w	manf43,manf44,manf45	dc.w	manf46,manf47,manf48	dc.w	manf49,manf50,manf51	dc.w	manf52,manf53,manf54	dc.w	manf55,manf56,manf57	dc.w	manf58,manf59,manf60		dc.w	0000	banim146:		;virs boss size #1 spinning	dc.w	virusf0,virusf1,virusf2	dc.w	$ffbanim147:		;virs boss size #2 spinning	dc.w	virusf3,virusf4,virusf5	dc.w	$ffbanim148:		;virs boss size #3 spinning	dc.w	virusf6,virusf7,virusf8	dc.w	$ffbanim149:		;virs boss size #4 spinning	dc.w	virusf9,virusf10,virusf11	dc.w	$ffbanim150:		;final boss size #5 spinning	dc.w	virusf12,virusf13,virusf14	dc.w	$ffbanim151:		;boss spinning in distance (all sizes)	dc.w	virusf45,virusf46	dc.w	virusf45,virusf46	dc.w 	$ffbanim152:		;boss zooming out size #1		dc.w	virusf22,virusf23,virusf24,virusf25,virusf26	dc.w 	0000banim153:		;boss zooming out size #2	dc.w	virusf27,virusf28,virusf29,virusf30,virusf31	dc.w 	0000banim154:		;boss zooming out size #3	dc.w	virusf32,virusf33,virusf34,virusf35,virusf36	dc.w 	0000banim155:		;boss zooming out size #4	dc.w	virusf37,virusf38,virusf39,virusf40,virusf41	dc.w 	0000banim156:		;boss zooming out size #5	dc.w	virusf42,virusf43,virusf44,virusf45,virusf46	dc.w 	0000banim157:		;boss zooming in size #1	dc.w	virusf26,virusf25,virusf24,virusf23,virusf22	dc.w	0000banim158:		;boss zooming in size #2	dc.w	virusf31,virusf30,virusf29,virusf28,virusf27	dc.w	0000banim159:		;boss zooming in size #3	dc.w	virusf36,virusf35,virusf34,virusf33,virusf32	dc.w	0000banim160:		;boss zooming in size #4	dc.w	virusf41,virusf40,virusf39,virusf38,virusf37	dc.w	0000banim161:		;boss zooming in size #5	dc.w	virusf46,virusf45,virusf44,virusf43,virusf42	dc.w	0000banim162:		;boss shoots at bob in final form	dc.w	virusf16,virusf16,virusf17,virusf17	dc.w	0000banim163:		;lava ball trail of lava sparks	dc.w	lavaf2,lavaf3,lavaf2,lavaf3	dc.w	$ffbanim164:		;fireball for lava/anceint levels	dc.w	fireballf0,fireballf1,fireballf2,fireballf3	dc.w	fireballf4,fireballf5,$ffbanim165:		;screen lifter bullet	dc.w	lifterf8,lifterf9,lifterf10,lifterf11,$ffbanim166:		;screen lifter bullet	dc.w	lifterf19,lifterf19,lifterf19,lifterf19	dc.w	lifterf19,lifterf19,lifterf19,lifterf19	dc.w	lifterf20,lifterf21,lifterf21,lifterf21	dc.w	lifterf20,lifterf21,lifterf21,lifterf21	dc.w	lifterf21,lifterf21,lifterf21,lifterf20	dc.w	lifterf19,lifterf19,lifterf19,lifterf19	dc.w	lifterf19,lifterf19,lifterf19,lifterf19	dc.w	lifterf19	dc.w	0000	banim167:		;mutoid boss skull rises up	dc.w	man2f0,man2f1,man2f2,man2f3,man2f4	dc.w	man2f5,man2f6,man2f7,man2f8,man2f9	dc.w	man2f10,man2f11	dc.w	0000banim168:		;baby lifter recoil	dc.w	lifterf22,lifterf23,lifterf24,lifterf25,lifterf26	dc.w	lifterf22,0000	banim169:		;baby lifter stop	dc.w	lifterf22,lifterf27,lifterf28,lifterf29,lifterf30	dc.w	lifterf31,lifterf22,0000banim170:		;virus boss 3d bullet	dc.w	virusf47,virusf47,virusf47,virusf48,virusf48,virusf48	dc.w	virusf49,virusf49,virusf49,virusf50,virusf50,virusf50	dc.w	virusf51,virusf52,virusf53,virusf54	dc.w	virusf54,virusf54,virusf54,virusf54,0000	banim171:		;virus boss drops a mine	dc.w	virus2f1,virus2f2,virus2f2,virus2f2	dc.w	virus2f3,virus2f3,virus2f1,0000	banim172:		;virus punch left	dc.w	virus2f8,virus2f9,virus2f9,virus2f10,virus2f10,virus2f1	dc.w	0000banim173:		;virus punch right	dc.w	virus2f5,virus2f6,virus2f6,virus2f7,virus2f7,virus2f1	dc.w	0000banim174:		;virus boss dies - main body effects	dc.w	vdief0,vdief1,vdief2,vdief3,vdief4,vdief5	dc.w	vdief6,vdief7,vdief8,vdief9,vdief10,vdief11	dc.w	vdief12,vdief13,vdief14,vdief15,vdief16,vdief17	dc.w	vdief18,vdief19,vdief20,vdief21,vdief22,vdief23	dc.w	vdief24,vdief25,vdief26,vdief27,vdief28,vdief29	dc.w	vdief30,vdief31,vdief32,vdief33,vdief34,vdief35	dc.w	vdief36,vdief37,0000 	banim175:		;virus boss dies - overlay effects	dc.w	vdief38,vdief38,vdief38,vdief39,vdief39,vdief39	dc.w	vdief40,vdief41,vdief42,vdief43,vdief44,vdief44	dc.w	vdief45,vdief45,vdief45,vdief46,vdief46,vdief46	dc.w	vdief47,vdief48,vdief48,vdief49,vdief49,vdief49	dc.w	0000 banim176:		;mouth opens - middle frames	dc.w	mouthf0,mouthf1,mouthf1,mouthf2,mouthf3	dc.w	mouthf4,mouthf4,mouthf4,mouthf4	dc.w	mouthf3,mouthf7,mouthf0,mouthf1	dc.w	mouthf0,mouthf0,mouthf0,mouthf0,0000banim177:		;mouth opens left framesbanim178:		;same as left - mouth open right frames	dc.w	mouthf9,mouthf9,mouthf9,mouthf9,mouthf9,mouthf9	dc.w	mouthf9,mouthf9,mouthf9,mouthf9,mouthf9,mouthf9	dc.w	mouthf9,mouthf9,mouthf9,mouthf9,mouthf9,0000banim179:	;jump - middle	dc.w	mouthf0,mouthf16,mouthf17,mouthf18,mouthf1	dc.w	mouthf0,0000banim180:		;jump - leftbanim181:		;is also same as left - jump right		dc.w	mouthf9,mouthf13,mouthf13,mouthf14,mouthf15	dc.w	mouthf12,0000banim182:	;land - middle		dc.w	mouthf1,mouthf18,mouthf19,mouthf17	dc.w	mouthf16,mouthf0,0000	banim183:	;land - left	banim184:	;same as left - land right		dc.w	mouthf15,mouthf14,mouthf13,mouthf13	dc.w	mouthf13,mouthf9,0000	banim185:	;spit stuff - middle	dc.w	mouthf0,mouthf0,mouthf0,mouthf1	dc.w	mouthf2,mouthf3,mouthf3,mouthf3	dc.w	mouthf2,mouthf1,mouthf0,0000banim186:	;spit - left sidebanim187:	;spit - right side		dc.w	mouthf9,mouthf9,mouthf9,mouthf9	dc.w	mouthf9,mouthf9,mouthf9,mouthf9	dc.w	mouthf9,mouthf9,mouthf9,0000banim188:	;left walk cycle - middle	dc.w	mouthf0,mouthf0,mouthf0,mouthf0,$ffbanim189:	;left	dc.w	mouthf9,mouthf10,mouthf11,mouthf12,$ffbanim190:	;right	dc.w	mouthf12,mouthf11,mouthf10,mouthf9,$ff	banim191:	;right walk cycle - middle	dc.w	mouthf0,mouthf0,mouthf0,mouthf0,$ffbanim192:	;left		dc.w	mouthf12,mouthf11,mouthf10,mouthf9,$ff	banim193:	;right	dc.w	mouthf9,mouthf10,mouthf11,mouthf12,$ffbanim194:	;middle mouth fall to death	dc.w	mouthf20,0000banim195:	;left	dc.w	mouthf22,0000banim196:	;right	dc.w	mouthf22,0000banim197:	;middle	mouth wake up after 1st death	dc.w	mouthf21,mouthf16,mouthf0,0000banim198:	;leftbanim199:	;right	dc.w	mouthf22,mouthf13,mouthf9,0000banim200:	;middle mouth in hurt pose	dc.w	mouthf20,0000banim201:	;leftbanim202:	;right	dc.w	mouthf22,0000banim203:	;lifter head normal animate	dc.w	lifterf0,lifterf1,lifterf2,lifterf3	dc.w	lifterf4,lifterf5,lifterf6,lifterf7	dc.w	lifterf6,lifterf5,lifterf4,lifterf3	dc.w	lifterf2,lifterf1	dc.w	$ff	banim204:		;snake boss neck pulse	dc.w	snakef3,snakef3	dc.w	snakef4,snakef4	dc.w	snakef5,snakef5	dc.w	snakef3,snakef3	dc.w	snakef4,snakef4	dc.w	snakef5,snakef5	dc.w	$ff	banim205:			;mutoid boss spinning skull	dc.w	manskullf0,manskullf0	dc.w	manskullf1,manskullf1	dc.w	manskullf2,manskullf2	dc.w	manskullf3,manskullf3	dc.w	manskullf4,manskullf4	dc.w	manskullf5,manskullf5	dc.w	manskullf5,manskullf5	dc.w	manskullf4,manskullf4	dc.w	manskullf3,manskullf3	dc.w	manskullf2,manskullf2	dc.w	manskullf1,manskullf1	dc.w	$ff	banim206:			;virus boss special bullet	dc.w	virusf18,virusf19,virusf20,virusf21	dc.w	$ff	banim207:		;snake boss eyes open up	dc.w	snakef0,snakef0	dc.w	snakef0,snakef0	dc.w	snakef0,snakef0	dc.w	snakef0,snakef0	dc.w	snakef0,snakef0	dc.w	snakef0,snakef0	dc.w	snakef1,snakef1	dc.w	snakef2,snakef2	dc.w	snakef13,snakef13	dc.w	snakef14,snakef14	dc.w	0000banim208:		;snake head gun pops out	dc.w	snakef15,snakef15	dc.w	snakef16,snakef16	dc.w	snakef17,snakef17	dc.w	snakef18,snakef18	dc.w	snakef19,snakef19,snakef19,snakef19	dc.w	snakef19,snakef19,snakef19,snakef19	dc.w	snakef18,snakef18	dc.w	snakef17,snakef17	dc.w	snakef16,snakef16	dc.w	snakef15,snakef15	dc.w	snakef14	dc.w	0000	banim209:		;virus float frame	dc.w	virus2f1,0000	banim210:		;virus freaks out before dying	dc.w	virus2f3,virus2f1,virus2f2,virus2f1	dc.w	virus2f5,virus2f6,virus2f5,virus2f1	dc.w	virus2f3,virus2f8,virus2f10,virus2f8,virus2f10	dc.w	virus2f11,virus2f13,virus2f11,virus2f13	dc.w	virus2f8,virus2f7,virus2f1,$ff;------------------------------------------------------	borglos:	;check to see if Bob is in borg's line of sight	lda bobypos	sbc #48	sta tmp+1	adc #64+16	sta tmp		lda PICxhi,x	ora PICyhi,x	bne @cantsee	;offscreen		lda PICylo,x	cmp tmp+1	bcc @cantsee	cmp tmp	bcs @cantsee	@cansee:			;in los = sec	sec	rts	@cantsee:	clc	rts;-----------------------------------------------------------	**	BOBZONE	 - IS BORG WITHIN A CERTAIN HORIZONTAL RANGE OF BOB?*bobzone:	sta tmp			;range to check within +-	stz tmp+1		lda bobxpos		;lo & hi	sta temp	sta temp+2	stz temp+1		;left side	stz temp+3		;right side		lda PICxlo,x	sta temp+4	lda PICxhi,x	sta temp+5			SET16	lda temp+4	clc	adc #1024		;make sure doesn't go neg.	sta temp+4	lda temp		;left side adjusted	sec	sbc tmp	clc	adc #1024		;make sure doesn't go neg.	sta temp		lda temp+2		;right side adjusted	clc	adc tmp	clc	adc #1024		;make sure doesn't go neg.	sta temp+2		lda temp+4	cmp temp	bcc @cantsee		;too far too left	cmp temp+2	bcs @cantsee		;too far to right	;	lda bobxpos;	sec;	sbc tmp;	sta temp;	bcs @bz1;	;	dec temp+1;	;@bz1:;;	lda bobxpos;	clc;	adc tmp;	sta temp+2;	bcc @bz2;	;	inc temp+3;@bz2:;	;	lda PICxhi,x			;check left side zone;	beq @bz3;	cmp temp+1;	bne @cantsee;	;@bz3;	lda PICxlo,x;	cmp temp;	bcc @cantsee;	;@bz4:;	lda PICxhi,x;	beq @bz5;	cmp temp+3;	bne @cantsee;	;@bz5:;	lda PICxlo,x;	cmp temp+2;	bcs @cantsee@cansee:		SET8		sec	rts				;within bob zone	@cantsee:			;out of zone	SET8		clc	rts	;-------------------------	restoretask:	lda PICmaplo,x		;get addr within task map	sta tmp	lda PICmaphi,x	sta tmp+1	ora tmp	beq @noaddr			;but skip update if addr is 0		phb					;save current data bank	lda #$7e			;set bank to task map data	pha	plb	ldy #0	lda PICscroll,x	cmp #3				;type 3 = permanent removal 	beq @removeit	@stunit:					;type 2 			lda (tmp),y	and #%01111111		;clear task active bit for future generation	sta (tmp),y	bra @doneit		@removeit:	lda #0				;type 3 permanent removal of task from task map	sta (tmp),y	@doneit:	plb					;reset current data bank	@noaddr	rts					;--------------------------------------------------------------	**	FIRE BULLETS*fire_bullet:			;try to fire a bullet	stx temp+5			;anim type	sta tmpx			;x velocity	sty tmpy			;y velocity		ldx TSKcurrent		;reset x		lda #type_enemy	jsl TSKschedule	dw borgbullet	bcc @nt		jsl copytask2		lda tmpx	sta PICtemp1,y	lda tmpy	sta PICdirv,y	lda temp+5	sta PIClogic,y		;bullet anim type@nt:	rts		borgbullet:	lda	#type_badbullet	sta	PICtype,x		inc PICprior,x		lda	#4	sta	PICsize,x		lda PIClogic,x	asl a	asl a	tay	lda borgbulletdata,y	sta PICbank,x	lda borgbulletdata+2,y	sta PICcolor,x	lda borgbulletdata+3,y	sta PICtemp2,x	lda borgbulletdata+1,y	jsr initanim		lda PIClogic,x				;generate bullet sound	tay	lda borgbulletsound,y	jsl	soundeffects	lda #2	sta PICscroll,x;----------------------	jsl	TSKsuspend	jsr animborg		lda PIClogic,x	cmp #1	beq @movebullet	;snake boss	cmp #2	beq @movebullet	;snake boss	cmp #4	beq @boomerang		cmp #5	beq @photon		cmp #9	beq @hiddenbul	cmp #13	beq @spinit		;ult. force  bullet	cmp #18	beq @spinit		;virus  bullet		cmp #0	bne @notspinner		;spinning bullet?	@spinit:	lda TSKclock	and #1	bne @flip@unflip	jsl PICxunflip			;make bullet spin	bra @quip	@flip	jsl PICxflip	@quip	bra @movebullet@boomerang:				jsl PICxunflip	jsl PICyunflip		lda PICanim,x	cmp #2	bcc @movebullet	cmp #4	beq @movebullet		jsl PICxflip	jsl PICyflip	bra @movebullet	@photon:				jsl PICyunflip		lda PICanim,x	cmp #3	bcc @notspinner	jsl PICyflip	bra @notspinner@hiddenbul:		;hidden gun bullet	jsr animborg			;animate fast	jsr animborg			;animate fast@notspinner:	jsr setdir	@movebullet:	ldy	PICdir,x	bne	@rightfire@leftfire:		lda PICtemp1,x	jsl	PICxsub		bra @movey	@rightfire:		lda PICtemp1,x	jsl	PICxadd	@movey		lda PICdirv,x			;move vertically	jsl PICyadd		lda PIChit,x	beq @bulletok		lda #drain1	jsl drainstrengthl		lda PICtemp2,x		;special type of explode	jmp explode	@bulletok	rtl	borgbulletsound:	dc.b	sfxturretfire			;0	dc.b	sfxsnakeboss3	dc.b	sfxborgfire1	dc.b	sfxborgfire1	dc.b	sfxborgfire2				dc.b	sfxborgfire1			;5	dc.b	sfxborgfire2	dc.b	sfxborgfire1	dc.b	sfxborgfire2	dc.b	sfxborgfire2	;9 popupgun2	9	dc.b	sfxworker		;10 mutoid bullet	10	dc.b	sfxbubblefire	;POWERORB		;11 power orb	dc.b	sfxtounge		;12 venus trap jungle ball	dc.b	sfxcellmanfire	;13 cell man	dc.b	sfxborgfire2	;14 screen lifter	dc.b	sfxpowerorb		;15 ancient boss	dc.b	sfxjellyfire	;16 death fire	dc.b	sfxeelfire		;17 eel fire	dc.b	sfxcellmanfire	;18 virus boss bullet	borgbulletdata:;0	dc.b 4				;bank # of animation	;rotating 3	dc.b borgbullet1	;anim type	dc.b 7				;color	dc.b 5				;type of explosion;1	dc.b 14				;bank # of animation	;snake sperm	dc.b borgbullet2	;anim type	dc.b 6				;color	dc.b 25				;type of explosion;2	dc.b 14				;bank # of animation	;snake boss laser	dc.b borgbullet3	;anim type	dc.b 6				;color	dc.b 25				;;type of explosion;3	dc.b 14				;bank # of animation	;regular borg	dc.b borgbullet4	;anim type	dc.b 6				;color	dc.b 10				;type of explosion;4	dc.b 14				;bank # of animation	;boomerang	dc.b borgbullet5	;anim type	dc.b 6				;color	dc.b 10				;type of explosion;5	dc.b 14				;bank # of animation	;photon	dc.b borgbullet6	;anim type	dc.b 7				;color	dc.b 5			;type of explosion;6		dc.b 14				;bank # of animation	;small plasma	dc.b borgbullet7	;anim type	dc.b 6				;color	dc.b 10				;type of explosion;7	dc.b 14				;bank # of animation	;big plasma	dc.b borgbullet8	;anim type	dc.b 7				;color	dc.b 5				;type of explosion;8		dc.b 14				;bank # of animation	;star shot	dc.b borgbullet9	;anim type	dc.b 6				;color	dc.b 10				;type of explosion;9		dc.b 4				;bank # of animation	;hidden gun shot	dc.b hiddengunbullet	;anim type	dc.b 6				;color	dc.b 10				;type of explosion;10		dc.b mutoidbank		;bank # of animation	;mutoid boss bullet	dc.b manbullet		;anim type	dc.b 3				;color	dc.b 23				;type of explosion;11		dc.b abank			;bank # of animation	;power orb bullet	dc.b eclipse		;anim type	dc.b 6				;color	dc.b 5				;type of explosion;12		dc.b 24				;bank # of animation	;jungle ball	dc.b jungbullet2		;anim type	dc.b 4				;color	dc.b 20				;type of explosion;13	dc.b	ufbank				;ultra force bullet	dc.b	ultrabullet	dc.b	7	dc.b	16		;14	dc.b	lifterbank				;screen lifter bullet	dc.b	lifterbullet	dc.b	6	dc.b	23	;15	dc.b	fatheadbank				;ancient mouth boss bullet	dc.b	ancbossbullet	dc.b	7	dc.b	14;16	dc.b	deathbank				;death boss bullet	dc.b	deathbullet	dc.b	3	dc.b	23;17	dc.b	ufbank				;eel bullet	dc.b	ultrabullet	dc.b	6	dc.b	19;18	dc.b	#virusbank		;virus bullet	dc.b	virusbullet	dc.b	7	dc.b	23;-------------------------------------------------------------	**		facebob - task faces bob*facebob:	lda PICxhi,x	bmi @right		bne @left		lda PICxlo,x	cmp bobxpos	bcc @right	@left:	lda #0	bra @test	@right:	lda #1	@test:	sta tmp	cmp PICdir,x	beq @samedir		sec	rts	@samedir:	clc	rts		***facebobv	proc					;set vertical direction	lda PICyhi,x	bmi @down		bne @up		lda PICylo,x	cmp bobypos	bcc @down	@up:	lda #0	bra @test	@down:	lda #1	@test:	sta tmp	cmp PICdirv,x			;vertical dir flag	beq @samedir		sec	rts	@samedir:	clc	rts		***;----------------------------------------------------------------------------powerorbtask:			;power orb	lda #abank	sta PICbank,x	lda #5				;set to tiny size	sta PICsize,x		lda #3	sta PIChealth,x		lda #2	sta PICscroll,x		jsl PICput	dw drudf19		;orb frame (1 only);------------------------	jsl TSKsuspend					;main loop follows	;------------------------		lda #5		;small nuke	jsr shootenemy		inc PICcolor,x		inc PICtemp1,x		lda PICtemp1,x	cmp #12	bcc @noshot		stz PICtemp1,x		inc PICcount2,x		lda PICcount2,x	and #1	sta PICdir,x		lda PICcount2,x	and #15	tay	lda orbshoth,y	pha		lda PICcount2,x	and #31	tay	lda orbshotv,y	tay	pla	ldx #11			;eclipse bullet	jsr fire_bullet	;	lda #sfxpowerorb;	jsl soundeffects@noshot:	lda PICcolor,x	lsr a	and #3	beq @roll1	cmp #1	beq @roll2	cmp #2	beq @roll3	@roll4:	jsl PICxflip	jsl PICyflip	rtl	@roll1:	jsl PICxunflip	jsl PICyunflip	rtl	@roll2:	jsl PICxunflip	jsl PICyunflip	rtl	@roll3:	jsl PICxflip	jsl PICyflip	rtl		rtl	orbshoth:	dc.b	0,1,2,3,3,4,5,6,6,5,4,3,3,2,1,0orbshotv:	dc.b	-6,-5,-5,-4,-3,-2,-1,0,0,1,2,3,4,5,5,6	dc.b	6,5,5,4,3,2,1,0,0,-1,-2,-3,-4,-5,-5,-6	;---------------------------------------------------------------	turretspeed	equ	37			;turret fire rate**	CEILING TURRETS*turrettask:				;borg ceiling turrets		lda #2				;32x16	sta PICsize,x			lda #4	sta PICbank,x		lda #2	sta PICscroll,x		lda #5	sta PIChealth,x		lda #5	sta PICcolor,x		jsl PICput	dw borg1f38				;straight down frame	;-------------	jsl TSKsuspend		lda #1	jsr shootenemy			jsr initdir			;always face bob	jsr setdir		lda PICyhi,x		;only fire when onscreen	bne @noshots		lda PICylo,x	cmp #120	bcs @noshots		inc PICcount2,x	lda PICcount2,x	cmp #turretspeed				;fire rate in 1/2 cycles	bcc @waitshot		stz PICcount2,x			jsr borglos			;if not is los, bob must be below	bcc @down	@side:	jsl PICput	dw borg1f40			;side frame		lda #5				;side shot	ldy #0	bra @fireit	@down:	lda #32	jsr bobzone	bcc @angle		jsl PICput	dw borg1f38				;straight down frame		lda #0	ldy #5	bra @fireit				;straight vshot@angle:	jsl PICput	dw borg1f39			;angle shot		lda #3				;diagonal shot	ldy #3@fireit:	ldx #0	jsr fire_bullet		@waitshot:	rtl	@noshots:	lda #99					;this will trigger immediate fire	sta PICcount2,x			;when bob gets within range	rtl	;---------------------------------------------------------------	**	SIDE WALL TURRETS*sideturrettask:				;borg side turrets		lda #3				;32x32	sta PICsize,x			lda #4	sta PICbank,x		lda #2	sta PICscroll,x		lda #5	sta PIChealth,x		lda #5	sta PICcolor,x		jsl PICput	dw borg1f35			;straight side frame		lda PIClogic,x	eor #1	sta PICdir,x		;logic byte holds dir		jsr setdir;-------------	jsl TSKsuspend		lda #1	jsr shootenemy			lda PICyhi,x		;only fire when onscreen	bne @noshots		inc PICcount2,x	lda PICcount2,x	cmp #turretspeed				;fire rate in 1/2 cycles	bcc @waitshot		stz PICcount2,x			jsr borglos			;if not is los, bob must be below	bcc @outofsight	@side:	jsl PICput	dw borg1f35			;side frame		jsl PICyunflip		lda #5				;side shot	ldy #0	bra @fireit	@outofsight:	lda PICylo,x	bmi @upsies	@downsies:	jsl PICput	dw borg1f36				;angle down frame		jsl PICyunflip		lda #3	ldy #3	bra @fireit				@upsies:	jsl PICput	dw borg1f36			;angle shot		jsl PICyflip		lda #3				;angle up shot	ldy #-3	@fireit:	ldx #0	jsr fire_bullet		@waitshot:	rtl	@noshots:	lda #99					;this will trigger immediate fire	sta PICcount2,x			;when bob gets within range	rtl	;;--------------------------------------------------------*roachspeed	equ	3			;scurry speedroachtask:	lda #1	sta PIChealth,x		lda #4	sta PICbank,x	lda #6				;set to tiny size	sta PICsize,x		lda #2	sta PICscroll,x	sta PICprior,x		;make appear in front of bob		lda #3	sta PICcolor,x		lda #cockroach	jsr initanim		jsr initdir	stz PICtemp2,x		lda #sfxdrip		jsl	soundeffects	jsl PICput	dw bugf8		;1st frame for stun bug	jsl TSKsuspend		lda #3	jsr shootenemy			lda PICtemp2,x			;make roaches hop out of egg...	cmp #1	beq @outofegg		jsl PICput	dw bugf10		lda #2			;slow xmove out of egg	jsr movetaskx		lda PICcount2,x	tay	lda cockhop,y	cmp #128	bne @dropping		dec PICcount2,x	lda cockhop-1,y	@dropping:	jsl PICyadd		inc PICcount2,x		lda #0	ldy #8	jsl bgcoll_longer			lda chartype	cmp #solid	bne @roachhit		@gotout:	inc PICtemp2,x		lda PICtemp2,x	cmp #3	bne @firsthit		lda #2	jmp explode	@firsthit		@outofegg:	jsr animborg@scurry:	lda PICdir,x	bne @rightwall		lda #-8	bra @checkwall	@rightwall:	lda #8@checkwall	ldy #8		jsl bgcoll_longer		lda chartype	cmp #solid	beq @nothit1		@fall:			;ran out of floor so jump off edge	lda #16	jsr movetaskx		lda #cockdrop-cockhop		;set to falling motion again	sta PICcount2,x	inc PICtemp2,x		rtl	@nothit1:				;now check to bounce off walls	lda PICdir,x	bne @rightwall2		lda #-16	bra @checkwall2	@rightwall2:	lda #16@checkwall2	ldy #0		jsl bgcoll_longer		lda chartype	cmp #solid	bne @hmove		lda PICdir,x	eor #1	sta PICdir,x	@hmove:		lda #roachspeed	jsr movetaskx	@roachhit:@notnear:	jsr setdir		@roachok	rtlcockhop:		;table of roach hop out ypos	dc.b	-5,-4,-3,-3,-2,-2,-2,-1,-1,-1,0cockdrop:		;past mid point becomes drop stuff	dc.b	0,1,1,1,2,2,3,4,5,6,6	dc.b	128		;-------------------------------------------------rolypolytask:	lda #3	sta PIChealth,x		lda #4	sta PICbank,x	lda #2	sta PICscroll,x		lda #20	sta PICtemp1,x		lda #10	sta PICcount2,x		jsr initdir	lda #3	sta PICcolor,x	lda #0	sta PICsize,x		jsl PICput				;roly guy standing	dw bugf23;-------------------------	jsl TSKsuspend		lda #3	jsr shootenemy		lda PICtemp1,x			;pause from rolling?	beq @rollbabyroll		jsl PICput				;roly guy standing	dw bugf23		jsl PICyunflip	jsr setdir				;current dir facing	dec PICtemp1,x	rtl		@rollbabyroll:	inc PICcount2,x		lda PICcount2,x	cmp #1	bne @nosounds		lda #sfxrolypoly	;start rolling sound	jsl	soundeffects@nosounds:	lda PICcount2,x	cmp #16	bcc @hmove				;roll back and forth		stz PICcount2,x	@stoproly:				;stop rolling , loser	lda #5	sta PICtemp1,x		;stop rolling delay		lda PICdir,x			;reverse direction after pausing for a while	eor #1	sta PICdir,x		rtl	@nohit1@hmove:	lda PICdir,x	bne @right		lda #-4	sta PICmoveh,x	lda #-8	bra @move	@right	ldy #4	sta PICmoveh,x	lda #8@move	jsl PICxadd	@notnear:	lda PICdir,x			;roll which way?	beq @rollright	@rolleft:	dec PICcount,x	bra @drawframe	@rollright:	inc PICcount,x		;animate rolling anim	@drawframe:	jsl PICxunflip	jsl PICyunflip	lda PICcount,x	and #3	beq @roll1	cmp #1	beq @roll2	cmp #2	beq @roll3	@roll4:	jsl PICput	dw bugf25	jsl PICxflip	jsl PICyflip	rtl	@roll1:	jsl PICput	dw bugf24	rtl	@roll2:	jsl PICput	dw bugf25	rtl	@roll3:	jsl PICput	dw bugf24	jsl PICxflip	jsl PICyflip	rtl	;--------------------------------------------------------------eggtask:	lda #4	sta PICbank,x		lda #5	sta PIChealth,x		lda #10	sta PICsize,x		;closed egg size		lda #2	sta PICscroll,x		jsl PICput	dw bugf0		lda #3	sta PICcolor,x		;------------------------------			jsl TSKsuspend		lda #2	jsr shootenemy		lda PICtemp1,x	bne @openegg	;	lda PICvomit,x			;open egg if bob shoots it;	bne @crackit		lda #90	jsr bobzone	bcc @notaroundegg	@crackit:	inc PICtemp1,x		lda #sfxeggopen	jsl	soundeffects	lda #egg	jsr initanim	lda #41	sta PICsize,x		;open egg size		@openegg:		jsr animborg		lda PICflag,x	beq @notaroundegg		inc PICtemp2,x	lda PICtemp2,x	cmp #25	bcc @notaroundegg		stz PICtemp2,x		;make a roach		lda #type_enemy	jsl TSKschedule	dw roachtask	bcc @notasks			;no room?		jsl copytask		@notasks:@notaroundegg:		rtl;;;;;-------------------------------------------------------------------;;	EXPLODE - CREATE AN EXPLOSION FOR THIS ENEMY;;	A = EXPLOSION TYPE;-------------------------------------------------------------------longexplode:	pla	bra explode	bobexplode:	lda bobxpos	sta PICxlo,x	lda bobypos	sta PICylo,x	lda #12			;special bob explosion - no bits	explode:	ldx TSKcurrent	sta	PICstatus,x		lda #7	sta TSKbank,x	pha	plb		jsr restoretask		;any map to be restored?		stz	PICanim,x		;frames counter	lda #3	sta PICcount,x		;delay counter overflow for first draw		jsl PICyunflip		;make sure y not flipped				lda #1	sta PICprior,x	lda	PICtype,x		;ed bug fix so platforms stay!!!	cmp	#type_walk	beq	@noremove	cmp	#type_elevator	bcs	@noremove		lda	#3					sta	PICscroll,x		@noremove:	lda	#type_generic				;turn into harmless	sta	PICtype,x		stz PICcolorhit,x	lda PICstatus,x		;make bits fly off?	cmp #12				;bob death	beq @nobits	cmp #15				;uforce splat w/o bits	beq @nobits	cmp #17				;shroom no bits	beq @nobits	cmp #13				;powerup effect	beq @nobits	cmp #21				;pussmine explosion	beq @nobits	cmp #23				;remote explosion	beq @nobits	cmp #25				;snake boss explosion	beq @nobits	cmp #26				;generic boss safe splat  use anywhere	beq @nobits	cmp #6				;flame?	bcc @bits	cmp #8					bcc @nobits	@bits:	jsr makebits	@nobits:	lda PICstatus,x		;flash colour before death	cmp #6					beq @colorme	cmp #7				;only if a flaming homer	bne @just_blowup	@colorme:	tay	lda explodecolor,y	sta	PICcolor,x		;brief change of enemy to explode colors			lda #2				;hold change	jsl TSKwait;------------------------------@just_blowup:			lda #99	sta PICcount2,x		lda	PICstatus,x	tay	lda	explodesounds,y 	jsl	soundeffects;--------------------------	jsl	TSKsuspend	lda PICstatus,x	cmp #13	bne @not_powerup		;move powerup vertically....		lda #3	jsl PICysub	lda #-2	sta PICmovev,x	@not_powerup:	lda TSKcurrent	and #1	bne @flip		jsl PICxunflip	bra @doneflip@flip:	jsl PICxflip@doneflip	lda PICstatus,x	cmp #10	beq @borgb	cmp #12	beq @borgb	cmp #2	bcs @notborgb			;was bcc	@borgb:	lda PICanim,x	cmp #3	bcc @drawframe	@notborgb:	inc	PICcount,x	lda	PICcount,x	cmp	#2	bcs	@drawframe		rtl		@drawframe:	stz	PICcount,x		lda	PICstatus,x	asl a	tay	lda deathframes,y	sta temp	lda deathframes+1,y	sta temp+1		lda PICanim,x			;get frame	asl a	tay	lda	(temp),y	sta	tmp	iny	lda	(temp),y	sta	tmp+1	ora tmp	beq @endexplode		;eof so kill task	jsl	PICput2		lda PICstatus,x	cmp #10				; explode	beq @borgboom	cmp #12				; explode	beq @borgboom	cmp #24				; screen lifter	beq @borgboom	cmp #25	beq @snakeypoo		;snake boss	cmp #2	bcs @notasmoker	@borgboom:	lda	#17	bra @nextanim			;set bank 17 for borg type explosions only	@snakeypoo:	lda #14	bra @nextanim		;snake boss special	@notasmoker:	lda	#19				;all others in bank 19@nextanim	sta PICbank,x		;picture data is in "ammo.a" bank 0	inc	PICanim,x		lda PICstatus,x	tay	lda explodecolor,y	sta	PICcolor,x	rtl	@endexplode	jsl TSKcancel	rtl** explosion picture data*deathframes:	dc.w	bigexplode			;0	dc.w	mediumexplode		;1			dc.w	bigsplat			;2	dc.w	smallsplat			;3	dc.w	bignuke				;4	dc.w	smallnuke			;5	dc.w	bigflame			;6	dc.w	smallflame			;7	dc.w	bignuke				;8 pickup item thingy	dc.w	bignuke				;9 red bullet nuke out	dc.w	smallexplode		;10	dc.w	bigsplat			;11	;ult. force splat	dc.w	bigexplode			;12	;bob explosion	dc.w	smallnuke			;13	;powerup	dc.w	bosssplat			;14	;ancient boss splat	dc.w	bigsplat			;15	;ult. force - no bits (pussdrop)	dc.w	bigsplat			;16 ;ult force with bits	dc.w	bigsplat			;17 ;mushroom pop no bits	dc.w	bigsplat			;18 ;bubble man burst	dc.w	smallsplat			;19 ;ultra force small & bits	dc.w	bigsplat			;20 ;forest splat big	dc.w	bigsplat			;21 ; pussmine	dc.w	bosssplat			;22 ; ancient boss splat	dc.w	remoteexplode		;23 ; remote/small exp.- no shrap	dc.w	bigexplode			;24 ; screen lifter explode blue	dc.w	snakeblast			;25 ; snake boss special blast	dc.w	bosssplat			;26	;generic boss splat, no bits	explodesounds:	dc.b	#SFXEXPLODE2	dc.b	#SFXEXPLODE1	dc.b	#SFXBUGSPLAT2	dc.b	#SFXBUGSPLAT1	dc.b	#SFXexplode1		;NUKEOUT	dc.b	#SFXexplode2		;NUKEOUT			;5	dc.b	#SFXFLAMEOUT	dc.b	#SFXFLAMEOUT	dc.b	#SFXNUKEOUT	dc.b	#SFXNUKEOUT	dc.b	#SFXEXPLODE1		;10	dc.b	#SFXPUSSMINEBURST	dc.b	#SFXEXPLODE2	dc.b	#SFXpickup	dc.b	#SFXbugsplat2	dc.b	#SFXbugsplat1		;15	dc.b	#SFXbugsplat2	dc.b	#sfxshroompop			;17	dc.b	#sfxbubbledie			;18	dc.b	#sfxbugsplat1			;19	dc.b	#sfxbugsplat2			;20	dc.b	#sfxpussmineburst		;21	dc.b	#sfxeyepop				;22	dc.b	#sfxexplode1			;23	;	dc.b	#sfxexplode2			;24	;	dc.b	#sfxexplode2			;25	;	dc.b	#SFXbugsplat2			;26explodecolor:;0...9	dc.b	6,6,5,5,7,7,6,6,7,6;10..14	dc.b	6,6,6,7,5;15..19	dc.b	3,3,2,3,4;20...	dc.b	3,2,5,6,7,1;26....	dc.b	3remoteexplode:		;remote explode/small explode no shrapnel	dw	remexplodef1	dw	remexplodef2	dw	remexplodef3	dw	remexplodef4	dw	remexplodef5	dw	remexplodef6	dw  0000	bigexplode:	dw	boom1f0	dw	boom1f1	dw	boom1f2	dw	boom1f3	dw	boom1f4	dw	boom1f5	dw	boom1f6	dw	boom1f7	dw	boom1f8	dw	boom1f9	dw	boom1f10	dw	boom1f11	dw	boom1f12	dw	boom1f13	dw	boom1f14	dw	boom1f15	dw	boom1f16	dw	boom1f17	dw	boom1f18	dw	boom1f19	dw	boom1f20	dw	boom1f21	dw	0000	mediumexplode:	dw	boom2f0	dw	boom2f1	dw	boom2f2	dw	boom2f3	dw	boom2f4	dw	boom2f5	dw	boom2f6	dw	boom2f7	dw	boom2f8	dw	boom2f9	dw	boom2f10	dw	boom2f11	dw	boom2f12	dw	boom2f13	dw	0000	smallexplode:	dw	boom3f0	dw	boom3f1	dw	boom3f2	dw	boom3f3	dw	boom3f4	dw	boom3f5	dw	boom3f6	dw	0000		bigsplat:	dw	splatf14	dw	splatf15	dw	splatf16	dw	splatf17	dw	splatf18	dw	splatf19	dw	splatf20	dw	splatf21	dw	0000smallsplat:	dw	splatf0	dw	splatf1	dw	splatf2	dw	splatf3	dw	splatf4	dw	splatf5	dw	splatf6	dw	0000bosssplat:		;special splat for bosses	dw	splatf22,splatf23,splatf24,splatf17	dw	splatf18,splatf19,splatf20,splatf21,0000bignuke:	dw	nukef0,nukef1,nukef2,nukef3,nukef4,nukef5	dw	nukef6,nukef7,nukef8,nukef9,0000	smallnuke:	dw	nukef1,nukef2,nukef3,nukef4,nukef5	dw	nukef6,nukef7,nukef8,nukef9,0000bigflame:	dw	flamef0,flamef1,flamef2,flamef3,flamef4,0000	smallflame:	dw	flamef2,flamef3,flamef4,0000	snakeblast:	dw snakef29,snakef30,snakef31,snakef32,snakef33	dw snakef34,snakef35,snakef36,snakef37,snakef38,snakef39	dw snakef40,snakef41,snakef42,0000*******wasptask:				;flying wasp	lda #4	sta PICbank,x	lda #3				;set to tiny size	sta PICsize,x		lda #2	sta PICscroll,x	sta PICprior,x		;make appear in front of bob		lda #2	sta PIChealth,x		lda #4	sta PICcolor,x		jsl PICput	dw bugf6	jsl TSKsuspend				lda #2	jsr shootenemy		jsr floattask	;	lda PICdir,x			;check for solid stuff;	bne @rightwall	@leftwall:;	lda #-16;	bra @wall	@rightwall:;	lda #16	@wall:	lda PICcount2,x	jsr movetaskx	@draw:@nohmove:	inc PICed,x			;speed up then slow down	lda PICed,x	cmp #10	bcc @faster	cmp #15	bcc @slower		lda PICdir,x	eor #1	sta PICdir,x	stz PICed,x			;reverse direction	bra @faster	@slower:	lda #3	jsr hslower	bra @drawv	@faster:	lda #3	ldy #5	jsr hfaster	@keepslowing:@drawv:	lda PICtemp2,x	inc PICtemp2,x	tay	lda waspymove,y	cmp #128	bne @movey		stz PICtemp2,x	bra @drawv	@movey	jsl PICyadd	jsr setdir		lda TSKclock	and #1	bne @frame1		jsl PICput	dw bugf6	rtl	@frame1:	jsl PICput	dw bugf7		inc PICdirv,x	lda PICdirv,x	and #15		bne @nosound		;sound delay		lda #sfxwings	jsl	soundeffects@nosound:		rtlwaspymove:	dc.b	-2,-1,-1,0,-1,0,1,0,1,1,2,1,1,0,1,0	dc.b	-1,0,-1,-1	dc.b	128;------------------------------------------------------------------*flyswarmtask:			;swarm of flies@makefly:	lda #4	jsl TSKwait		lda #type_enemy	jsl TSKschedule	dw flytask2			;special swarmer fly	bcc @notask		jsl copytask2	inc PICtemp1,x		;max number of flies?	lda PICtemp1,x	cmp #6	bcc flyswarmtask		inc PIClogic,x	lda #175			;keep another swarm from triggering	jsl TSKwait		jsl TSKcancel			;end of swarm	@notask:		rtl	;-------------------------------------------------------flytask2:			;swarmer fly start here	inc PICtemp2,x	flytask:	jsl PICput	dw bugf22	lda #4	sta PICbank,x	sta PICprior,x	sta PICcolor,x		lda #1	sta PIChealth,x		jsr initdir		lda #2	sta PICscroll,x		jsl TSKsuspend				lda #3	jsr shootenemy@getymove		lda PICcount2,x	inc PICcount2,x	tay	lda flyymove,y	cmp #128	bne @movey		stz PICcount2,x	bra @getymove	@movey	jsl PICyadd	@no_float	lda #2	jsr movetaskx	@draw:;	lda #0;	tay;	jsl bgcoll_longer	;	lda chartype;	cmp #solid;	bne @nobounce	;	lda PICdir,x;	eor #1;	sta PICdir,x		;reverse direction	@nobounce:	jsr setdir		lda TSKclock	and #1	bne @frame2		jsl PICput	dw bugf21		inc PICcount2,x	lda PICcount2,x	and #7	bne @nosound		;sound delay		lda #sfxflies	jsl	soundeffects@nosound:	rtl	@frame2:	jsl PICput	dw bugf22	rtlflyymove:	dc.b	-5,-4,-3,-2,-1,-1,0,0,0	dc.b	1,1,2,3,4,5,5,4,3,2,1,1,0,0,0	dc.b	-1,-1,-2,-3,-4,-5	dc.b	128******hfaster:				;accelerate task speed	sta tmp+5				;max counter	sty tmp+6			;max velocity		inc PICtemp1,x		lda PICtemp1,x	cmp tmp+5			;#6	bcc @noaccel		lda #0	sta PICtemp1,x		lda PICcount2,x	cmp tmp+6			;#3		bcs @noaccel		inc PICcount2,x	@noaccel:	rts	hslower:	sta tmp+5			;max counter		inc PICtemp1,x		lda PICtemp1,x	cmp tmp+5		;#5	bcc @noslow		lda #0	sta PICtemp1,x		lda PICcount2,x	beq @noslow		dec PICcount2,x	@noslow:	rts	vfaster:				;accelerate task speed	sta tmp+5				;max counter	sty tmp+6			;max velocity		inc PICtemp2,x		lda PICtemp2,x	cmp tmp+5		;#6	bcc @noaccel		lda #0	sta PICtemp2,x		lda PICthingy,x	cmp tmp+6	;#3	bcs @noaccel		inc PICthingy,x	@noaccel:	rts	vslower:	sta tmp+5				;max counter		inc PICtemp2,x		lda PICtemp2,x	cmp tmp+5				;#5	bcc @noslow		lda #0	sta PICtemp2,x		lda PICthingy,x	beq @noslow		dec PICthingy,x	@noslow:	rts		*************************************************************************	WORKER BUG LOGIC***workertask:	lda #4	sta PICbank,x		lda #2	sta PICscroll,x		jsr initdir				;always face bob at startup		lda PIClogic,x			;setup walker or jumper?	bne @setjumper		lda #worker_walk		;walk	bra @donesetup	@setjumper:		lda #worker_prejump		;jump	@donesetup:	jsr initanim		lda #10	sta PICsize,x	lda #5	sta PIChealth,x		lda #3	sta PICcolor,x		jsl PICput	dw bugf29;------------------------	jsl TSKsuspend			lda #2	jsr shootenemy	lda PIClogic,x			;walker or jumper ?	beq @workerwalker		brl workerjumper	@workerwalker:		;check to see if worker should attack BOB			lda TSKclock		;only every once and a while	and #63	bne @notnear			lda PICstatus,x	cmp #worker_fire	beq @j31		;skipstill		;make worker stand still? not if firing!	@skipstill:	lda #worker_fire	jsr initanim	@j31:	bra @nomove			;in range stop stop	@notnear:		lda PICstatus,x			;check to see if worker is walking	cmp #worker_walk	beq @moveworker		cmp #worker_stand	bne @nomove		lda #worker_walk	jsr initanim			;set only once	@moveworker:		lda PICdir,x			;check for floors	bne @rightwall		lda #-24	bra @checkwall	@rightwall:	lda #24@checkwall	ldy #24	jsl bgcoll_longer		lda chartype	cmp #solid	bne @stopmove			lda PICdir,x			;check for walls	bne @rightwall2		lda #-24	bra @checkwall2	@rightwall2:	lda #24@checkwall2:	ldy #12	jsl bgcoll_longer		lda chartype	cmp #solid	bne @nothit1	@stopmove:	lda #worker_stand	jsr initanim			;set only once	bra @nomove		;stop moving if out of floor or walls	@nothit1@hmove:	inc PICcount2,x	lda PICcount2,x	and #7	bne @nosound		;sound delay		lda #sfxscuttle	jsl	soundeffects@nosound:	lda PICdir,x	bne @right		lda #-2	bra @move	@right	lda #2@move	sta PICmoveh,x				jsl PICxadd		@nomove:	lda PICstatus,x	cmp #worker_walk	beq @keepanim	cmp #worker_stand	beq @keepanim		lda PICflag,x			;reset to walk anim if another sequence ends	beq @keepanim		lda #0	jsr fire_venom		lda #worker_stand	jsr initanim	@keepanim:	jsr animborg		jsr setdir			;flip task left or right depending on PICdir	lda PICtemp1,x		;time to face bob?	beq @lookforbob		dec PICtemp1,x	bra @samedir		;wait to change dir	@lookforbob:	jsr initdir		lda #30			;set a small delay to avoid flip-flopping dir	sta PICtemp1,x	@samedir:	rtl;-----------------------------------------------------------------workerjumper:	jsr initdir		lda PICstatus,x	cmp #worker_jump	beq @jump2	cmp #worker_land	beq @jump4		;still in pre-jump so wait...		lda PICflag,x	bne @readytojump		;done anticipation so now in air!		jmp @donejump	@readytojump	lda #1	sta PICscroll,x	lda #worker_jump	jsr initanim		lda #sfxheadeat	jsl soundeffects		jmp @donejump	@jump2:				;mid air stuff	lda PICcount2,x		inc PICcount2,x		;read ymove from table		tay	lda jumptable1,y	cmp #128			;eof?	bne @jump3					;reset flight counter	stz PICcount2,x		lda #worker_land	jsr initanim	lda #2	sta PICscroll,x	jmp @donejump	@jump3:	cmp #127	bne @nojumpshot		;fire gun		lda #0	jsr fire_venom	bra @donejump	@nojumpshot:	jsl PICyadd	bra @donejump	@jump4:			;wait for landing to end, then jump again	lda PICflag,x	beq @donejump		;still waiting to finish		lda #worker_prejump	jsr initanim	jsr initdir		@donejump:	jsr animborg	jsr setdir	rtl*********************************************************************fire_venom:	sta PICtemp1,x			;v direction 		lda #type_enemy	jsl TSKschedule	dw venomtask	bcc @nt		jsl copytask2		lda #sfxworker	jsl	soundeffects@nt:	rts	;-------------------------	venomtask:		lda #type_badbullet	sta PICtype,x		lda #2	sta PICscroll,x		lda #6	sta PICcolor,x		lda #4	sta PICbank,x		lda	PICdir,x	bne	@right	lda	#-12	bne	@addxoff@right:	lda	#12@addxoff:	jsl	PICxadd		lda	#-12	jsl	PICyadd		stz PICsize,x;-----------------------------	jsl	TSKsuspend	lda #5	jsr movetaskx		lda PICtemp1,x	sta PICmovev,x	jsl PICyadd		lda PIChit,x			;hit bob?	beq @bulletok	@killbullet:	lda #drain1	jsl drainstrengthl		lda #3	jmp explode	@bulletok@notnear:	lda PICdir,x			;roll which way?	bne  @rollright	@rolleft:	dec PICcount,x	bra @drawframe	@rollright:	inc PICcount,x		;animate rolling anim	@drawframe:	jsr floattask		lda PICcount,x	lsr a	and #3	cmp #0	beq @roll1	cmp #1	beq @roll2	cmp #2	beq @roll3	@roll4:	jsl PICput	dw bugf5	jsl PICxflip	jsl PICyflip	rtl	@roll1:	jsl PICput	dw bugf4	jsl PICxunflip	jsl PICyunflip	rtl	@roll2:	jsl PICput	dw bugf5	jsl PICxunflip	jsl PICyunflip	rtl	@roll3:	jsl PICput	dw bugf4	jsl PICxflip	jsl PICyflip	rtl	**********************************************************************droppertask:				 ;ceiling droppers	lda #4	sta PICbank,x		lda #3	sta PICcolor,x		lda #2	sta PICscroll,x	sta PICprior,x		;make appear in front of bob		lda #dropper_left		;set anim type	jsr initanim		lda #1	sta PIChealth,x		jsl PICput	dw bugf13	stz PICsize,x;-------------------------------		jsl TSKsuspend		lda #3	jsr shootenemy			lda PICtemp1,x	bne @drop		lda PICyhi,x	bne @movedropper		;must be offscreen		lda PICylo,x			;is dropper above or below bob?	cmp bobypos	bcs @movedropper		;must be below so stay put!			;dropper can drop. should it?		lda accelcount		;bob speed - if at #MAXACCEL then running	cmp #MAXACCEL	bne @walkingbob		lda #70-20	jsr bobzone	bcs @drop	bra @movedropper	@walkingbob	lda #4	jsr bobzone	bcc @movedropper	@drop:	inc PICtemp1,x		lda PICtemp1,x	cmp #6	bcs @falling	cmp #5	bne @nosound		lda #sfxheaddrop	jsl	soundeffects@nosound:	jsl PICput	dw bugf17			;anticipate frame		bra @stopmove	@falling:	dec PICtemp1,x		;prevent PICtemp1 from wrapping.		jsl PICput	;falling frame	dw bugf18		lda #0	ldy #16	jsl bgcoll_longer		lda chartype	cmp #solid	bne @fall2	@splatdropper:				;kill dropper	lda #3	jmp explode	@fall2	lda #2	sta PICmovev,x		lda #5	jsl PICyadd			bra @stopmove@movedropper:@noshots:	jsr animborg@stopmove:	lda PICcollide,x	beq	@missed	@chewbob:	lda #dropper_chew	jsr initanim			lda #0	sta PICscroll,x		lda #$99	sta PICdirv,x		;sound counter		jsl TSKsuspend		lda status	cmp #dying	beq @gosplatola		lda bobypos	sec	sbc bobsizey	clc	adc boboffsety	tay	lda bobxpos	adc walkdir	adc walkdir	adc walkdir	adc walkdir	jsl PICxyset			;stick on Bob's head		jsr animborg		inc PICdirv,x	lda PICdirv,x	cmp #10	bcc @nosnd		;sound delay		stz PICdirv,x		lda #sfxheadeat	jsl	soundeffects@nosnd:	lda PICflag,x	beq @missed			;wait for chewing anim to stop	@gosplatola:	jmp @splatdropper	@missed:	rtl*********************************************************************shootenemy:			;test to see if Bob has shot this enemy		sta tmp			;type of death animation					;even = big					;odd = small		lda enemydie	beq @notbombed		;smart bomb activated?		lda #15	sta PICcolorhit,x	bra @bullet			;kill enemy	@notbombed:		lda PIChit,x			;if hit then blink red	beq @skip_color	@flashenemy:	lda #15	sta PICcolorhit,x		;save off current color	@skip_color:	lda PIChealth,x	bne	@ok	@kill:	lda #0	jsl addscore		lda PIChit,x	cmp #hitbypunch	beq @punchout	cmp #hitbyflame	beq @flamedeath	bra @bullet	@flamedeath:	lda tmp	and #1	ora #6	sta tmp			;make a flame death	@bullet		lda #3	sta PICscroll,x		pla			;kill jsr 	pla		lda tmp	jmp	explode** nope...exist you scum sucker*@ok:	stz PIChit,x				;clear each cycle		lda enemyblind		;stun the fuckers?	beq @notblind		pla	pla	rtl				;exit task	@notblind:	rts	@punchout:				;kill by punch	pla	pla		lda tmp	sta PICtemp1,x			;death type		stz PICcolorhit,x		;no flash		lda #3	sta PICscroll,x		lda walkdir				;which way to punch - bob's dir	sta PICdir,x	bpl @po2		stz PICdir,x		;adjust for ed's -1/+1 fucking directions. 	@po2:;----------	lda #sfxdeployrem	jsl soundeffects		jsl TSKsuspend		lda PICxhi,x	bne @punchblow			;if off edge kill enemy	lda PICxlo,x	cmp #24	bcc @punchblow	cmp #-24	bcs @punchblow	lda #0					;check for walls	tay	jsl bgcoll_longer	cmp #solid	beq @punchblow			;if enemy hits wall then blow!		lda #16	jsr movetaskx			;make enemy fly offscreen same as bob dir	rtl	@punchblow:	lda PICtemp1,x	jmp explode	;--------------------------------------------------------------	***********************************************************************crabspeed	equ	4sandcrabtask:	lda #5	sta PIChealth,x		lda #sandbank	sta PICbank,x		lda #2	sta PICscroll,x		jsr initdir		lda #crab_walk	jsr initanim	jsr animborg		lda #44				;not attack size	sta PICsize,x			;***********	jsl TSKsuspend									lda #3	sta PICcolor,x			lda #2	jsr shootenemy			;check to see if crab should attack BOB		lda PICstatus,x	cmp #crab_attack	beq @j31			lda status	cmp #dying	beq @notnear			;bob is dead. stop attack.		lda #40			;in x range of bob?	jsr bobzone	bcc @notnear		jsr borglos	bcc @notnear			;out of y range?		@skipstill:	lda #crab_attack	jsr initanim		lda #sfxsnap	jsl	soundeffects	lda #type_enemy	jsl TSKschedule	dw bugstinger	bcc @j31	jsl copytask2	lda #1	sta PIClogic,y		;0=scorpion, 1=crab@j31:	lda PICflag,x			;end attack	beq @nomove			;in range stop stop		lda #crab_stand	jsr initanim		rtl				@notnear:	lda PICylo,x	cmp #150	bcs @turnwork		;don't chase if below bob		lda PICstatus,x			;check to see if worker is walking	cmp #crab_walk	beq @moveworker		lda #crab_walk	jsr initanim			;set only once	@moveworker:		lda PICdir,x	bne @rightwall		lda #-24	bra @checkwall	@rightwall:	lda #24@checkwall	ldy #16	jsl bgcoll_longer		lda chartype	cmp #solid	beq @nothit1	@turnwork:					lda #crab_stand	jsr initanim			;set only once	bra @nomove		;stop moving if out of floor or walls	@nothit1@hmove:	lda PICdir,x	bne @rightwall2		lda #-24	bra @checkwall2	@rightwall2:	lda #24@checkwall2:	ldy #0	jsl bgcoll_longer		lda chartype	cmp #solid	beq @turnwork		lda #crabspeed	jsr movetaskx		inc PICcount2,x	lda PICcount2,x	and #7	bne @nomove		;sound delay		lda #sfxscuttle	jsl	soundeffects@nomove:	jsr animborg		jsr setdir			;flip task left or right depending on PICdir	lda PICtemp1,x		;time to face bob?	beq @lookforbob		dec PICtemp1,x	bra @samedir		;wait to change dir	@lookforbob:	jsr initdir		lda #20			;set a small delay to avoid flip-flopping dir	sta PICtemp1,x	@samedir:	rtl*********************************************************************scorpiontask:	lda #sandbank	sta PICbank,x		lda #2	sta PICscroll,x		jsr initdir				;always face bob at startup		lda #scorpion_stand	jsr initanim	jsr animborg		lda #40	sta PICsize,x		lda #5	sta PIChealth,x				lda #3	sta PICcolor,x		;-------------------		jsl TSKsuspend		lda #2	jsr shootenemy			;check to see if crab should attack BOB			lda status	cmp #dying	beq @notnear			;bob is dead. stop attack.		lda #48				;in x range of bob?	jsr bobzone	bcc @notnear		jsr borglos	bcc @notnear			;out of y range?		lda PICstatus,x	cmp #scorpion_attack	beq @j31			;make worker stand still? not if firing!	@skipstill:	lda #scorpion_attack	jsr initanim		lda #sfxwhip	jsl	soundeffects@j31:	lda PICanim,x			;in sting frame	cmp #4	bne @no_sting		lda PICcount,x	bne @no_sting		lda #type_enemy	jsl TSKschedule	dw bugstinger	bcc @no_sting		jsl copytask2	lda #0	sta PIClogic,y		;0=scorpion, 1=crab	@no_sting:	lda PICflag,x			;end attack	beq @nomove			;in range stop stop		lda #scorpion_stand	jsr initanim		rtl						@notnear:	@canmove:	lda PICstatus,x			;check to see if worker is walking	cmp #scorpion_walk	beq @moveworker		lda #scorpion_walk	jsr initanim			;set only once	@moveworker:		lda PICdir,x				;check for floors below	bne @rightwall		lda #-32	bra @checkwall	@rightwall:	lda #32@checkwall	ldy #24	jsl bgcoll_longer		lda chartype	cmp #solid	beq @nothit1			;if solid found, then there's a floor	@turnwork:					lda #scorpion_stand	jsr initanim			;set only once	bra @nomove		;stop moving if out of floor or walls	@nothit1	lda PICdir,x	bne @rightwall2		lda #-40	bra @checkwall2	@rightwall2:	lda #40@checkwall2:	ldy #8	jsl bgcoll_longer		lda chartype	cmp #solid	beq @turnwork	@hmove:	lda #2	jsr movetaskx			inc PICcount2,x	lda PICcount2,x	and #7	bne @nomove		;sound delay		lda #sfxscuttle	jsl	soundeffects	@nomove:	jsr setdir			;flip task left or right depending on PICdir	jsr animborg		lda PICtemp1,x		;time to face bob?	beq @lookforbob		dec PICtemp1,x	rtl			;wait to change dir	@lookforbob:	jsr initdir			;chase bob	lda #25			;set a small delay to avoid flip-flopping dir	sta PICtemp1,x	@samedir:	rtl;----------------------------------------------------------------bugstinger:			;task to hurt bob when crab or scorpion					;attack with extended arms										;also used by mutoid men		stz PICtype,x		lda #1	sta PICsize,x		lda PIClogic,x	beq @scorpion	cmp #2	beq @mutoidpunch	cmp #3	beq @mutoidkick	@crab:	jsl TSKsuspend		lda #32	bra @setxy@mutoidkick:	lda #26	jsl PICyadd	@mutoidpunch:			;mutoid man punch;	lda #mutoidbank;	sta PICbank,x;	jsl PICput;	dw manskullf0	lda #2	sta PICsize,x		lda #32	bra @setxy	@scorpion:	lda #40	@setxy:	sta temp		lda PICdir,x	bne @right	@left:	lda temp	jsl PICxsub	bra @done	@right:	lda temp	jsl PICxadd	@done:				;now sting is at right spot	lda #4	jsl PICysub	lda #type_enemy	sta PICtype,x		jsl TSKsuspend		lda PICcollide,x	beq @nosting		lda #5	jsl drainstrengthl		lda PIClogic,x	cmp #2	bcc @nosting		;not a mutoid	cmp #3	beq @kickup		lda PICdir,x	inc a	jsr knockbob		;punch effect	bra @nosting	@kickup:	lda #0	jsr knockbob	@nosting:		jsl TSKcancel	rtl	;-------------------------------------------------------------------------;		DRUID;-------------------------------------------------------------------------druidtask:	lda #abank	sta PICbank,x		lda #2	sta PICscroll,x		lda #2	sta PIChealth,x		lda #2	sta PICcolor,x		jsr initdir		lda #1	sta PICsize,x		lda #druid_walk	jsr initanim	jsr animborg		jsl TSKsuspend								;-----------------; main loop ;------------------	lda PIChealth,x	bne @notshot			;if drood shot then drop into pile of clothing	@killdruid:	stz PICtype,x		lda #druid_die	jsr initanim		jsl TSKsuspend		jsr animborg			lda PICflag,x	beq @fall		lda #4	jmp explode		;nukeout	@fall:	rtl@notshot:	lda enemydie		;bomb?	bne @killdruid		lda enemyblind	beq @notstun		rtl	@notstun:	jsr animborg		jsr blinkenemy		;make enemy flash if hit		lda PICcount2,x	cmp #12	bcs @finishmove	inc PICcount2,x			;make druid zoom out, like a borg		lda PICcount2,x	cmp #12	bne @stillmoving		lda #druid_clap	jsr initanim@stillmoving:			;make druid come out to play...	jsr setdir2		lda #4	jsr movetaskx		rtl	@finishmove:	@d2:	;blast w/ lightening	lda PICanim,x			;fire a bolt at mid point of animation	cmp #5	bne @nobolt			lda PICcount,x	cmp #1	bne @nobolt				;only fire one!		lda PICxhi,x	ora PICyhi,x	bne @nobolt		;must be visible to fire at bob!		lda PICylo,x	cmp #225	bcs @nobolt		;could still be offscreen		lda #type_enemy	jsl TSKschedule	dw druid_lightening	bcc @nl		jsl copytask2	@nl:@nobolt:	@done:	rtl	;-------------------------------------------------------------;	DRUID LIGHTENING;------------------------------------------------------------druid_lightening:	lda #sfxthunder	jsl soundeffects		jsl PICyflip		lda #type_badbullet	sta PICtype,x		lda #1	sta PICscroll,x		;never kill task offscreen!		lda #7	sta PICcolor,x	jsl PICyadd		lda #abank	sta PICbank,x				lda #druid_bolt	jsr initanim	;---------------------------------------		jsl TSKsuspend		lda TSKclock	and #1	bne @xf1	@xf:	jsl PICxflip	bra @xf2	@xf1:	jsl PICxunflip	@xf2:			lda PICdirv,x	bne @godown				;0=up, 1= down		lda #16	jsl PICysub	lda #-8	sta PICmovev,x		lda PICyhi,x	bpl @notoff		lda PICylo,x	bmi @notoff		;now bolt is offscreen	;send three back down		lda bobxpos	sta PICxlo,x		stz PICxhi,x		lda #1	sta PICdirv,x	jsl PICyunflip			bra @notoff	@godown:	lda #12	jsl PICyadd	lda #6	sta PICmovev,x		lda PICyhi,x	cmp #1	bne @notoff		jsl TSKcancel	@notoff:	jsr animborg		lda PIChit,x	beq @nohit		lda #drain1	jsl drainstrengthl	lda #4	jmp explode	@nohit:	rtl		;;-------------------------------------------------------------------------;		CRUSHING SKULL HEAD;-------------------------------------------------------------------------skulltask:	lda #2	sta sdmaflag			;start the dma transfer	stz sdmacount		lda #abank	sta PICbank,x		lda #8	sta PIChealth,x		lda #2	sta PICscroll,x	sta PICprior,x		;make appear in front of bob		lda #1	sta PICcolor,x		jsr initdir				;always face bob at startup		lda #5	sta PICsize,x		lda #skull_float	jsr initanim	jsr animborg		jsl TSKsuspend			;-----------------; main loop ;------------------	lda #4			;big nuke	jsr shootenemy					lda PICdirv,x	bne @offscreen		;already crushing head		lda PICyhi,x			;try to crush bob?	bmi @tryit	bne @offscreen		lda PICylo,x	cmp #128	bcs @offscreen		;below bobola		;check to crush bob	@tryit:	lda #40	jsr bobzone	bcc @offscreen			;bob not near skull		lda #1	sta PICdirv,x			;set drop flag		jsl PICput	dw skullf3				;angry drop frame	@offscreen:				;going down or up?	lda PICdirv,x	beq @float			;0=float	cmp #1	bne @backup	@crush_his_head:		;1=drop	inc PICcount2,x		lda PICcount2,x	cmp #5	bcc @gotodone2				;pause just before drop	cmp #5+10	bcs @stophead		lda #8					;move down	jsl PICyadd	lda #4	sta PICmovev,x		@gotodone2:	rtl	@stophead:	stz PICcount2,x	inc PICdirv,x			;set to up flag		lda #30	sta shakescreen			;shake the screen			;crush bob?	lda #24				;in x range of bob?	jsr bobzone	bcc @notflat		jsr borglos	bcc @notflat			;out of y range?	jsr crushbob	@notflat:	rtl@sit:					;skull waits on ground	jsl PICput	dw skullf1				;angry rise frame		rtl	@backup:				;2=rise	inc PICcount2,x	lda PICcount2,x	cmp #30	bcc @sit		cmp #30+39	bcc @upup		stz PICcount2,x	stz PICdirv,x			;set to up flag	@upup:	jsl PICput	dw skullf2				;angry rise frame		lda #2	jsl PICysub	lda #-1	sta PICmovev,x	rtl	@float:	inc PICtemp1,x			;count before turning	lda PICtemp1,x	cmp #45	bcc @w1		stz PICtemp1,x			;reset count and xflip		lda PICdir,x	eor #1	sta PICdir,x	@w1:	lda #2	jsr movetaskx	@done:	jsr animborg		jsr setdir	@done2:	rtl	;-------------------------------------------------------------------------;		SCREAMING HAND;-------------------------------------------------------------------------handtask:		;ADAM MADE ME TAKE THIS OUT. HE IS SUCH A MEANIE.	jsl TSKcancel	rtl	;-------------------------------------------------------------------------;		DROPPING GIANT SPHERE;-------------------------------------------------------------------------spheretask:	lda #abank	sta PICbank,x		jsl PICput				;trigger marker	dw spheretriggerf				lda #5	sta PICcolor,x		lda #2	sta PICsize,x		lda #2	sta PICscroll,x	sta PICprior,x		;make appear in front of bob		jsl TSKsuspend		lda PICcollide,x	bne @triggered		;bob step on trigger?		rtl	@triggered:	lda #sfxballdrop	jsl soundeffects		lda #1	sta PICscroll,x		lda #3	sta PICcolor,x		lda #16	sta PICsize,x		jsl PICput	dw ballf0			;sphere		lda #127	jsl PICysub	lda #127	jsl PICysub		lda #4	sta sdmaflag			;start the dma transfer	stz sdmacount	@start:	jsl TSKsuspend								;-----------------; main loop ;------------------	lda #16	jsl PICyadd		lda #8	sta PICmovev,x		inc PICcount,x	lda PICcount,x	cmp #14				;35		bcs @hit		rtl	@hit:	stz PICcollide,x		jsl TSKsuspend		jsr crushbob		;test to see if bob should splat...			lda #30	sta shakescreen		lda #sfxexplode2			;balldrop	jsl soundeffects	jsl TSKsuspend		lda #2	jsl PICxadd	inc PICmoveh,x		lda PICcount2,x	inc PICcount2,x	tay	lda spherebounce,y	cmp #16	bne @bouncey	dec PICcount2,x	@bouncey:		jsl PICyadd		rtl	spherebounce:	dc.b	-8,-6,-4,-3,-2,-1,0	dc.b	1,2,3,4,6,8,10,12,14,16;--------------------------------------------------------------crushbob:			;routine to crush bob under things....	lda PICcollide,x	beq @nosquish		lda status	cmp #walking	beq @squish	cmp #stopping	beq @squish	cmp #crouching	beq @squish	stz strength		;blow up only				bra @nosquish	@squish:	inc squished		;flatten bobola	stz strength				@nosquish:	rts*********************************************************************queenstrength	equ	85queentask:			;queen bug task	stz queenflag		lda #queenstrength	sta bossstrength		lda #queenbank	sta PICbank,x		lda #1	sta PICscroll,x		lda #3	sta PICcolor,x		lda #4	sta PICsize,x		lda #type_enemy			;schedule tail	jsl TSKschedule	dw queen_tailtask		jsl copytask2			jsl TSKsuspend		lda #type_enemy	jsl TSKschedule	dw queen_splattask		;drop a tentacle/splat	bcc @h1		jsl copytask2		lda PICcount,x	sta PICtemp1,y				inc PICcount,x	lda PICcount,x	cmp #4	beq @splat_set	@h1	rtl	@splat_set	lda #queenstrength	sta PIChealth,x		stz PICtype,x		lda #8				;adjust head now....	jsl PICxadd	lda #34	jsl PICysub	;	head moves arounmd, wiggles bits and fires at bob; tentacles grab down in a pattern (1,2,3,4,1,2,3,4?); tail - lose long bit, but drop out little green guys in packs!; ;  as queen gets hurt, head fire more?; only one attack at a time@queenhead:	lda #queen_fire			;head starts firing larvae	jsr initanim	jsr animborg		lda #30	jsl TSKwait		lda #sfxqueenscream	jsl	soundeffects	jsl TSKsuspend				;-----------------; main loop ;------------------	lda PIChealth,x;	beq @movehead		;head ver.1 is "dead" so drop off	lsr a	sta bossstrength		;display boss strength	@getheady:	lda PICcount2,x	inc PICcount2,x	tay	lda queenheadfloat,y	cmp #128	bne @heady	stz PICcount2,x	bra @getheady	@heady:		jsl PICxadd;	jsr blinkenemy		lda queenflag	cmp #4	bcs @movehead		;drop head when body is shot		jsr animborg			inc bosscount1		;change attack type?	lda bosscount1	cmp #120			;170	bcc @sameattack		stz bosscount1		;reset counter	inc bossflag1		;next attack	lda bossflag1	and #3				;only 4 types	sta bossflag1	@sameattack:	lda bossflag1	bra @nofire		;no shooting now?			bne @nofire				;not a head fire cycle		inc PICtemp2,x	lda PICtemp2,x	cmp #8	bcc @nofire		stz PICtemp2,x		;periodical fire rate		lda enemyblind	bne @nofire		lda #queen_fire			;head starts firing larvae	jsr initanim		lda #8	jsl PICyadd		lda #0			;fire left	jsr shootlarvae		lda #8	jsl PICysub	@nofire	rtl		@movehead:		;kill tail, splat body, detach head	inc bossflag2			;tell rest of body head is dead		lda #sfxqueenscream	jsl	soundeffects	lda #type_enemy	sta PICtype,x		stx bosstarget		jsl TSKsuspend		lda #5	jsl PICyadd	lda #3	sta PICmovev,x	lda PICylo,x	cmp #160	bcs @hitbottom			;has head dropped off yet?		jsr showqueen		rtl@hitbottom:		lda #160	sta PICylo,x		lda #30	sta shakescreen		lda #sfxexplode1	jsl soundeffects		stz bossflag1			;no other attacks now!		lda #30	sta PICshake,x		lda #queensprout			;head sprout up	jsr initanim		lda #8	jsl PICysub	lda #0	sta PICdir,x		lda #60	sta PICtemp2,x	;---------- final head scurry loop	jsl TSKsuspend		jsr showqueen			lda PICtemp2,x		;time to start scurry?	beq @moveit		cmp #1	beq @setscurry		dec PICtemp2,x		;pause before running about		cmp #20	bcs @nosprout		jsr animborg		;now cause queen head to rise up	@nosprout:	rtl	@setscurry:	stz PICtemp2,x	lda #queenscurry	jsr initanim		lda #sfxqueenscream	jsl	soundeffects@moveit;	jsr animborg		inc PICtemp1,x			;count before turning	lda PICtemp1,x	cmp #33	bcc @w1	beq @turnaround	cmp #40	bcc @done	cmp #73	bcc @runshoot			;shoot larvae;	cmp #74;	bcc @done		stz PICtemp1,x			;reset run count	stz bossbulletflag1		;reset bullet dir pointer	jmp @done	@runshoot:	lda PIChealth,x	cmp #80	bcs @done				;only fire when getting beat!		lda PICtemp1,x	and #7	bne @done		lda enemyblind	bne @done			lda #13	jsl PICysub	lda PICdir,x				;fire 	jsr shootlarvae	lda #13	jsl PICyadd		jmp @done@turnaround:	lda PICdir,x	eor #1	sta PICdir,x	jmp @done		@w1:				;move queen left/right	lda #6	jsr movetaskx		jsr animborg	jsr runfloat		;make queen float up/down	@done:	jsr setdir2		rtl	;--------------------------------------------showqueen:			;routine to disp. queen health	jsr blinkenemy		lda PIChealth,x	lsr a	sta bossstrength	bne @ok		pla	pla		stz bossstrength		lda #sfxqueenscream	jsl	soundeffects	lda #maxstrength	sta strength		lda #160	sta winflag	sta PICshake,x		lda #type_enemy	jsl TSKschedule	dw bossburst	jsl copytask	lda #60	jsl TSKwait		jsr score10000		lda #2	jmp explode@ok:	rts;-------------------------------------------runfloat:			;make queen head bob while running around	inc PICcount2,x	lda PICcount2,x	and #7	tay	lda queenrunfloat,y	jsl PICyadd	rts	;----------------------------------------queenheadfloat:	dc.b	0,0,0,0,0,0,1,0,0,0,0,1	dc.b	-1,0,0,0,0,-1,0,0,0,0,0,0,0	dc.b	1,0,0,0,-1,0,-1,0,0,0,0,0,0,0,0,0	dc.b	1,128	queenrunfloat:		;move body up/downb when running	dc.b	0,1,1,0,0,-1,-1,0;-----------------------------------------------queen_splattask:		lda #queenbank	sta PICbank,x		lda #86	jsl PICysub	lda #5	jsl PICxadd		lda PICtemp1,x	tay	lda orifice_interval,y	sta PICcount2,x				;set initial open/close delays	lda qsplat_xoff,y	sta PICcount,x	jsl PICxsub				;set splat x offset		jsl PICput	dw queenf6		lda #10	sta PIChealth,x	;	lda #queenhole;	jsr initanim		lda TSKcurrent	and #3	sta PICanim,x		lda #3	sta PICcolor,x		;------------------		jsl TSKsuspend		stz PICtype,x		lda PICcount2,x	bne @not_open			;open hole up?		lda #type_enemy	sta PICtype,x		lda PICflag,x	bne @closed		jsr animborg			;animate hole		jsr blinkenemy		lda PICanim,x	cmp #30					;once per openup	bne @nocrer		lda PICcount,x	bne @nocrer				;once per anim		lda enemyblind	bne @nocrer		stz PICtemp2,x		lda #type_enemy	jsl TSKschedule	dw crittertask		;drop a critter	bcc @nocrer		jsl copytask2	@nocrer:	lda PIChealth,x	beq @splatme		rtl	@closed:		;hole has closed	lda #255	sta PICcount2,x		;reset timer	rtl	@not_open:		;wait to open up	lda PIChealth,x	beq @splatme		dec PICcount2,x		lda PICcount2,x	bne @nop2		lda #queen_hole	jsr initanim		stz PIChit,x	stz PICtemp2,x	@nop2:	rtl		@splatme:	lda #sfxbugsplat1	jsl	soundeffects	;	lda #sfxqueenscream;	jsl	soundeffects	stz PICtype,x			;make harmless		lda #queensplat	jsr initanim				;make bit explode		lda #5	sta PICcolor,x		inc queenflag		jsl TSKsuspend		jsr animborg		inc PICcount2,x	lda PICcount2,x	adc TSKcurrent	and #63	bne @nodrip		lda #type_enemy	jsl TSKschedule	dw queen_driptask		;drop a splat	bcc @nodrip		jsl copytask2	@nodrip:	lda bossflag2	beq @nohead		;stop drips when queen runs around for speed		jsl TSKsuspend	@nohead:	rtl	qsplat_xoff:	dc.b	32,64,96,127orifice_interval:	dc.b	128,64,255,191	;-------------------------------------queen_driptask:			;drips of gunk from queen	stz PICtype,x		lda #4	sta PICsize,x		lda #8	jsl PICyadd		lda #2	sta PICscroll,x		;make drip nuke itself		lda #5	sta PICcolor,x		lda #queenbank	sta PICbank,x		lda #queen_drip	jsr initanim			jsl TSKsuspend		lda PICanim,x	cmp #7	bcc @nofall			;drip still forming?	@fall:	cmp #7	bne @nosound		lda #sfxdrip	jsl	soundeffects@nosound:	lda PICanim,x	sbc #4	jsl PICyadd	lda PICanim,x	sbc #4	lsr a	sta PICmovev,x	@nofall	jsr animborg		lda PICcollide,x		;bob hit by drip?	beq @safe		lda #3	jmp explode	@safe:	rtl;----------------------------------------------------------------queen_tailtask:			;tail that grabs bob	stz PICtype,x		lda #127	jsl PICxsub	lda #48	jsl PICxsub	lda #42+16	jsl PICysub		inc PICflag,x		;NO ANIMATION TIRGGERS 1ST TIME		lda #5	sta PICcolor,x	;	lda #80;	jsl TSKwait		lda #queenbank	sta PICbank,x		lda #80	sta PICtemp2,x	;--------------------------------	jsl TSKsuspend		;main loop		lda bossflag1	and #1				;tail attack allowed?	beq @nofire		lda bossflag2	bne @nofire			;stop when queen body is dead		dec PICtemp2,x	lda PICtemp2,x	bne @nofire		lda #32	sta PICtemp2,x		;rate of droppers...		lda enemyblind	bne @nofire		lda #type_enemy		;drop a little green spinner...	jsl TSKschedule	dw queenspinnertask	bcc @nofire		jsl copytask2		lda #queen_tail	jsr initanim	@nofire:	lda PICflag,x	bne @stopdrippy		jsr animborg	rtl	@stopdrippy:	stz PICadrlo,x	stz PICadrhi,x		rtl		;---------------------------------------------------------------shootlarvae:				;fire a larvae	sta PICdir,x			;A sets initial dir		lda #type_enemy	jsl TSKschedule	dw larvaetask	bcc @nt		jsl copytask2	@nt:	rts;----------------------------------------------------larvaetask:			;queen's head larvae spitters	lda #sfxdrip	jsl	soundeffects	lda bossbulletflag1	sta PICdirv,x	inc bossbulletflag1		;set diff.bullet speed		lda #1	sta PIChealth,x		lda #2	sta PICscroll,x		lda #queenbank	sta PICbank,x		stz PICtemp2,x	;----------------------	jsl	TSKsuspend	lda #3	jsr shootenemy@leftfire:				;little bullet larvae	lda TSKclock			;animate larvae squiggling	and #2	bne @flip@unflip	jsl PICput	dw queenf4	bra @quip	@flip	jsl PICput	dw queenf5	@quip	lda PICdirv,x	and #7	tay	lda larvaexmove,y		jsr movetaskx	@movey		lda PICtemp2,x			;drop larvae down too	inc PICtemp2,x	tay	lda larvaeymove,y	cmp #8	bne @movey2		dec PICtemp2,x	@movey2	jsl PICyadd	lda PICcollide,x	beq @bulletok	lda #drain1	jsl drainstrengthl@kill_larvae		lda #3	jmp explode	@bulletok	rtllarvaeymove:	dc.b	0,0,0,0,0,0,0,0,1,1,1,1,1,1,2,2,2,3,3,4,4,5,6,7,8	larvaexmove:	dc.b	5,6,7,8,9,10,10,10;----------------------------------------------------------------queenspinnertask:			;little green spinners that							;drop out of queen's tail	lda #10	jsl TSKwait		lda #sfxdrip-1	jsl	soundeffects	inc PIChealth,x		lda #queenbank	sta PICbank,x		stz PICtemp2,x		lda #bottomlarvae	jsr initanim	jsr animborg		lda #5	sta PICcolor,x		lda #1	sta PICdir,x		lda #3	sta PICscroll,x	;----------------main loop---------------------	jsl	TSKsuspend		lda #3	jsr shootenemy		jsr animborg		lda PICcount2,x	inc PICcount2,x	tay	lda spinnerbounce,y	cmp #128	bne @bouncey	dec PICcount2,x	bra @movex	@bouncey:		jsl PICyadd		lda PICcount2,x	cmp #15	bcc @noxmove	@movex:	lda #3			jsr movetaskx@noxmove:	lda PICcollide,x	beq @bulletok	lda #drain1	jsl drainstrengthl@kill_spinner		lda #3	jmp explode	@bulletok	rtlspinnerbounce:	dc.b	1,2,3,4,5,6,7,8,8,8,8,8,8,8,8,8,8,8,-8,-6,-4,-2,-1,0,1	dc.b	1,2,3,4,5,-5,-3,-1,0,1,2,3,4	dc.b	128;----------------------------------------------------------------crittertask:			;cockroach things that							;drop out of queen's body holes	lda #sfxdrip	jsl	soundeffects	lda #1	sta PIChealth,x		inc PICscroll,x	lda #queenbank	sta PICbank,x		stz PICtemp2,x		jsl PICput	dw queenf10		lda #5	sta PICcolor,x		inc PICprior,x		jsr initdir	jsr setdir		;----------------main loop---------------------	jsl	TSKsuspend		lda #3	jsr shootenemy		lda PICcount2,x			;drop to bottom	cmp #25	bcs @movex		inc PICcount2,x	lsr a	jsl PICyadd				;drop guy down	bra @noxmove	@movex:	lda #3	jsr movetaskx	jsl PICput	dw queenf11		lda TSKclock	and #2	bne @noxmove	jsl PICput	dw queenf12	;	lda #1;	jsl PICysub	@noxmove:		lda PICcollide,x	beq @bulletok	lda #drain1	jsl drainstrengthl@kill_spinner		lda #3	jmp explode	@bulletok	rtl;---------------------------------------------------------------;  offscreen check for any use - bcs = offscreen, bcc = onscreenoffscreen_safe:	lda PICxhi,x			;check x hi	beq @vcheck		;x is not onscreen so check low byte		bpl @offright	@offleft:	lda PICxlo,x	cmp #-maxoffscreenh	bcc @killtask		;too far to left so kill		bra @vcheck			;ok. now try vertical	@offright:	lda PICxlo,x	cmp #maxoffscreenh	bcs @killtask		;too far to right so kill			@vcheck			;try vertical	lda PICyhi,x	beq @done		;y is not onscreen so check low byte		bpl @offbottom	@offtop:	lda PICylo,x	cmp #-maxoffscreenv	bcc @killtask		;too far above so kill		bra @done		;ok. now try vertical	@offbottom:	lda PICylo,x	cmp #maxoffscreenv	bcs @killtask		;too far to right so kill	@done	clc	rts@killtask:			;task is offscreen so kill it	sec	rts		**********************************************************************	PUNCHING STATUE*********************************************************************statuetask:			;punching potatoehead dude	lda #8	sta sdmaflag			;stat dma	stz sdmacount		lda #abank	sta PICbank,x		lda #5	sta PIChealth,x		lda #2	sta PICscroll,x		jsr facebob				;always face bob at startup	lda tmp	sta PICdir,x		lda #statue_float	jsr initanim	jsr animborg		lda #10	sta PICsize,x		lda #1	sta PICcolor,x		jsr initdir	;------------------------------------	jsl TSKsuspend			lda #4	jsr shootenemy		jsr floattask	; is potato ready to attack yet, or still moving?@canmove:	lda PICcount2,x		;make him charge out to attack bob!	cmp #13	bcs @attack		inc PICcount2,x		;still charging....	lda #4	jsr movetaskx	bra @samedir		@attack:	lda #56				;in x range of bob?	jsr bobzone	bcc @notnear		jsr borglos	bcc @nomove			;out of y range?		lda PICstatus,x	cmp #statue_attack	beq @j31			;make worker stand still? not if firing!	@skipstill:	lda status	cmp #dying	beq @notnear			;bob is dead. stop attack.		lda #statue_attack	jsr initanim	@j31:	lda PICanim,x	cmp #2	bne @not_impact	@impact:		;punched bob?	lda #56			;in x range of bob?	jsr bobzone	bcc @nomove		jsr borglos	bcc @nomove			;out of y range?	lda status	cmp #windblown	beq @not_impact			;only once	lda	#5	sta	startblowing		lda	#windblown	sta	status		lda PICdir,x	inc a	sta blowdir		lda #drain1	jsl drainstrengthl@not_impact:	lda PICflag,x			;end attack	beq @nomove			;in range stop stop		lda #statue_float	jsr initanim		rtl						@notnear:	@nomove:	jsr facebob			;chase bob	lda tmp					sta PICdir,x	@samedir:	jsr setdir2		;flip task left or right depending on PICdir	jsr animborg		rtl;-------------------------------------------------------------------------***	FIRE IMP***imptask:	lda #10	sta sdmaflag			;imp dma	stz sdmacount		lda #abank	sta PICbank,x	lda #0				;set to tiny size	sta PICsize,x		lda #2	sta PICscroll,x	sta PICprior,x		;make appear in front of bob		lda #1	sta PIChealth,x		lda #6	sta PICcolor,x		lda #imp_fly	jsr initanim	jsr animborg	jsl TSKsuspend				lda #6	jsr shootenemy		jsr floattask	;	lda PICdir,x			;check for solid stuff;	bne @rightwall;	;@leftwall:;	lda #-16;	bra @wall;	;@rightwall:;	lda #16;	;@wall:;	ldy #0;	jsl bgcoll_longer;	;	lda chartype;	cmp #solid;	beq @nohmove		;time to swoop down?		lda PIClogic,x	bne @swooping		lda #16					;only check if not already swooping	jsr bobzone	bcc @noswoop	@swooping:	lda PIClogic,x	bne @nosound		lda #sfxfireimp	jsl soundeffects@nosound:	lda PIClogic,x	inc PIClogic,x	tay	lda impswoopmove,y	cmp #128	bne @movey		stz PIClogic,x	bra @noswoop	@movey	jsl PICyadd	@noswoop:	lda PICcount2,x	jsr movetaskx	@draw:@nohmove:	inc PICed,x			;speed up then slow down	lda PICed,x	cmp #20	bcc @faster	cmp #36	bcc @slower		lda PICdir,x	eor #1	sta PICdir,x	stz PICed,x			;reverse direction	bra @faster	@slower:	lda #4	jsr hslower	bra @drawv	@faster:	lda #4	ldy #4	jsr hfaster	@keepslowing:@drawv:	jsr setdir2		jsr animborg		rtlimpswoopmove:		dc.b	1,2,3,4,5,6,7,8,7,6,5,4,3,2,1,0	dc.b	-1,-2,-3,-4,-5,-6,-7,-8,-7,-6,-5,-4,-3,-2,-1,0	dc.b	128	*************************************************************************	LAVA MAN - THROWS LAVA BALLS************************************************************************lavamantask:	lda #abank	sta PICbank,x		lda #2	sta PIChealth,x		lda #2	sta PICscroll,x		lda #1	sta PICsize,x		lda #6	sta PICcolor,x	;------------------------------------		jsl TSKsuspend					lda #6	jsr shootenemy		lda PICstatus,x				;already rising/firing?	cmp #lavaman_emerge	beq @manout		lda #90			;wait for bob under lava	jsr bobzone	bcc @keepgoing	@crackit:	lda #lavaman_emerge	jsr initanim	lda #sfxlavaman		;emerge sound	jsl soundeffects	jsr facebob				;always face bob at startup	lda tmp	sta PICdir,x	jsr setdir		@manout		jsr animborg		lda PICanim,x	cmp #14				;this is the throwing frame #?	beq @fireball	cmp #19	beq @fireball	cmp #24	bne @nofire@fireball:				;fire a lava ball at bobola	lda PICcount,x	cmp #1	bne @nofire			;only once per frame		lda #type_enemy	jsl TSKschedule	dw lavaballtask	bcc @notasks			;no room?		inc PICtemp1,x		jsl copytask2		lda #sfxfirethrow	jsl soundeffects	bra @nofire		@notasks	stz PICcount,x			;hold arm frame until task is avaiable for ball	@nofire:	lda PICflag,x			;is lava man done for now?	beq @keepgoing		;yes then reset him		lda #0	sta PICstatus,x	sta PICadrLo,x	sta PICadrHi,x	@keepgoing:		rtl;-----------------------------------------------------------lavaballtask:		inc PICprior,x		lda PICtemp1,x	and #15	tay	lda lavamanbally,y	sta PICdirv,x		lda #2	sta PICscroll,x		lda #6	sta PICcolor,x		lda #abank	sta PICbank,x		lda	PICdir,x	beq	@initright@initleft:	lda	#-20	bne	@addxoff@initright:	lda	#20@addxoff:	jsl	PICxadd		lda	#-12	jsl	PICyadd		jsl	TSKsuspend;----------------------------	lda enemyblind	beq @nostun		rtl	@nostun:	lda #8	jsr movetaskx	lda PICdirv,x			;y direction	jsl PICyadd		lda PICcollide,x	beq @notnear		lda #drain1	jsl drainstrengthl@killbullet:	lda #7				;small fire explode	jmp explode	@notnear:	lda TSKclock	and #1	bne @roll2						;animate lava ball - 2 frames@roll1:	jsl PICput	dw lavaf0	rtl	@roll2:	jsl PICput	dw lavaf1	rtllavamanbally:		dc.b	0,1,0,-1,-2,1,2,-2,3,-4,4,2,-3,2,-3,-1;---------------------------------------------------------*********************************************************************lavabubbletask:	lda #abank	sta PICbank,x		lda #2	sta PICscroll,x		lda #1	sta PICsize,x		lda #6	sta PICcolor,x		lda #20	sta PICcount2,x			;start bubble sooner!!;------------------------------------	@mainball:	jsl TSKsuspend	lda #2	sta PICscroll,x						lda PICbank,x	cmp #abank	bne @gofuck	;this is a bug fix		lda enemyblind	beq @nostun		rtl	@gofuck:	jsl TSKcancel	rtl	@nostun:	lda PICstatus,x				;already rising/firing?	cmp #lava_bubble	beq @manout		inc PICcount2,x	lda PICcount2,x	cmp #45	bcc @nofire		stz PICcount2,x			lda #lava_bubble	jsr initanim@manout:		lda PICbank,x	cmp #abank	bne @fuckingbadtask	;this is a bug fix		jsr animborg		lda PICanim,x	cmp #4					bne @nofire		lda PICcount,x	cmp #1	bne @nofire			;only once per frame		lda #type_enemy	jsl TSKschedule	dw up_lavaballtask	bcc @notasks3			;no room?		jsl copytask		lda #0			sta PICdir,y			;set hdir too		lda #sfxfireballs	jsl soundeffects	@notasks1:		;now make trails that follow later....	lda PICbank,x	cmp #abank	bne @fuckingbadtask	;this is a bug fix		lda #1	jsl TSKwait		lda #type_enemy	jsl TSKschedule	dw lavatrailtask	bcc @notasks2			;no room?		jsl copytask		@notasks2:	lda PICbank,x	cmp #abank	bne @fuckingbadtask	;this is a bug fix		lda #2	jsl TSKwait		lda #type_enemy	jsl TSKschedule	dw lavatrailtask	bcc @notasks3			;no room?		jsl copytask		@notasks3:	lda PICbank,x	cmp #abank	bne @fuckingbadtask	;this is a bug fix		jmp @mainball@nofire:	lda PICflag,x			;idone for now?	beq @keepgoing		;yes then reset		lda #0	sta PICstatus,x	sta PICadrLo,x	sta PICadrHi,x	@keepgoing:		rtl@fuckingbadtask:	jsl TSKcancel	rtl	;-----------------------------------------------------------up_lavaballtask:		lda #2	sta PICscroll,x		lda #6	sta PICcolor,x		lda #abank	sta PICbank,x		jsl PICput	dw lavaf0	jsl	TSKsuspend;----------------------------	lda enemyblind	beq @nostun		rtl	@nostun:	lda PICtemp2,x	inc PICtemp2,x	tay	lda lavaballymove,y	cmp #128	beq @killball		jsl PICyadd	@no_float	lda PICdir,x	jsl PICxadd	@flyaway:	lda PICcollide,x	beq @notnear		lda #drain1	jsl drainstrengthl	@killbullet:	lda #7				;small fire explode	jmp explode	@notnear:	@notrail:	lda TSKclock	and #1	bne @roll2						;animate lava ball - 2 frames@roll1:	jsl PICput	dw lavaf0	rtl	@roll2:	jsl PICput	dw lavaf1	rtl	@killball:			;flame out ball	jsl TSKcancel	rtl	;--------------------------------------lavatrailtask:		;little bits left behind by lava balls		lda #2	sta PICscroll,x		lda #1	sta PICsize,x		lda #6	sta PICcolor,x		lda #abank	sta PICbank,x		lda #lavaball_trail	jsr initanim		jsl	TSKsuspend	lda enemyblind	beq @nostun		rtl	@nostun:	jsr animborg		lda PICtemp2,x	inc PICtemp2,x	tay	lda lavaballymove,y		;slower speed	cmp #128	beq @done		jsl PICyadd		jsl PICxunflip		lda PICanim,x	and #2	bne @same		jsl PICxflip	@same:	rtl		@done:	jsl TSKcancel	rtl		lavaballymove:		;y move for main ball	dc.b	-10,-10,-9,-9,-9	dc.b	-8,-8,-8,-8,-7,-7,-7,-6,-6,-5,-4,-3,-2,-1,-1,0,-1,0,0,0	dc.b	1,0,1,1,2,3,4,5,6,6,7,7,7,8,8,8,8	dc.b	9,9,9,10,10,5	dc.b	128;lavaballymove2:			;y move for trail - 1/2 velocity;	dc.b	-10,-10,-9,-9;	dc.b	-8,-8,-7,-7,-6,-6,-5,-4,-3,-2,-1,-1,0,-1,0;	dc.b	1,0,1,1,2,3,4,5,6,6,7,7,8,8;	dc.b	9,9,10,10,5;	dc.b	128	;---------------------------------------------------------flyingguntask:		lda #4	sta PICbank,x		lda #5	sta PIChealth,x		lda #2	sta PICscroll,x		lda #1	sta PICsize,x		lda #5	sta PICcolor,x		lda #flygun_shoot	jsr initanim;------------------------------------		jsl TSKsuspend				jsr animborg		jsr initdir				;always face bob	jsr setdir		lda #1	jsr shootenemy		jsr borglos	bcc @noshot		inc PICcount2,x	lda PICcount2,x	cmp #35	bcc @waitshot			;wait for counter		stz PICcount2,x		lda #8	jsl PICyadd		lda #8	ldy #0	ldx #9				;4	jsr fire_bullet			;fire	lda #8	jsl PICysub		lda #flygun_shoot	jsr initanim@waitshot:	lda PIClogic,x	inc PIClogic,x	tay	lda flygunymove,y	cmp #128	bne @movey		stz PIClogic,x	bra @waitshot	@movey	jsl PICyadd	rtl	@noshot:	lda #99	sta PICcount2,x	bra @waitshot			;will fire upon being in range	flygunymove:	dc.b	2,2,1,1,1,0,1,0,0,1,0,0,0	dc.b	-1,0,0,-1,0,-1,-1,-1,-2,-2,-2,-1,-1,-1,0	dc.b	-1,0,0,0-1,0,0,0	dc.b	1,0,0,1,0,1,1,1,2	dc.b	128;---------------------------------------------------------------initdir:			;init task dir to face bob	jsr facebob				;always face bob at startup	lda tmp	sta PICdir,x		rts;-----------------------------------------------------------------;---------------------------------------------------------hiddenguntask:		lda PIClogic,x	beq @noyflip		jsl PICyflip		;inverted gun on ceiling	@noyflip:	lda #4	sta PICbank,x		lda #3	sta PIChealth,x		lda #2	sta PICscroll,x		lda #42	sta PICsize,x		lda #5	sta PICcolor,x	lda #0	sta PICtype,x	;------------------------------------		jsl TSKsuspend				lda #0	jsr shootenemy		lda PICanim,x	beq @wait1	cmp #5	bcc @riseup			;still rising so no shots yet	cmp #7	beq @shoot			;shoot on this count	lda PICflag,x	beq @riseup			;must be going back down again		stz PICstatus,x			;reset gun 	stz PICanim,x	stz PICadrHi,x			;erase graphic	stz PICadrLo,x	stz PICtype,x		lda #30	jsr random	adc #10	sta PICcount2,x			;wait a bit before coming up again		rtl@wait1:	lda PICstatus,x	cmp #hiddengun_rise	beq @riseup					;gun already rising?	@waiting:	lda PICcount2,x	beq @lookforbob			;wait for counter		dec PICcount2,x	rtl	@lookforbob:;	jsr borglos				;wait for bob to get close then rise;	bcc @noshot		lda #90	jsr bobzone	bcc @noshot		lda #hiddengun_rise	jsr initanim		jsr initdir				;always face bob	jsr setdir	lda #type_enemy	sta PICtype,x		bra @riseup	@shoot:			lda #8	ldy #0	ldx #9	jsr fire_bullet			;fire@riseup:			;anmimate gun coming up	jsr animborg			;must be up/rising so animate;	lda #sfxpopupgun1;	jsl	soundeffects@noshot:	rtl						;will fire upon being in range	;---------------------------------------------------------------volcano	equ	1volcanotask:			;PIClogic = 1romancandletask:		;PIClogic = 0			lda #5	sta PIChealth,x		lda #2	sta PICscroll,x		lda #1	sta PICsize,x		lda #4	sta PICcolor,x		lda #abank	sta PICbank,x		lda PIClogic,x		;if volcano then no sprite needed	bne @v2		lda #4	sta PICbank,x		jsl PICput	dw borg1f27		;roman candle launcher		lda #30			;delay		bra @start	@v2:	lda #45			;delay	@start:	sta PICtether,x		jsl TSKsuspend	lda PIClogic,x	bne @v1			;can't shoot volcano		lda #1	jsr shootenemy	@v1:	lda enemyblind	beq @nostun		rtl	@nostun:	inc PICcount2,x	lda PICcount2,x	cmp PICtether,x			;delay max?	bcc @waitshot			;wait for counter		stz PICcount2,x		lda #-3				;launch a big bunch	jsr fire_romanball		lda #16	jsl PICysub		lda #-1				;launch middle 2 up higher	jsr fire_romanball	lda #1	jsr fire_romanball		lda #16	jsl PICyadd	lda #3	jsr fire_romanball		lda PIClogic,x	beq @borgvolcano		lda #sfxvolcano	bra @makesound	@borgvolcano:	lda #sfxborgfire4@makesound:	jsl soundeffects	@waitshot:	rtl;---------------------------------------------fire_romanball:			;make a lava ball that fires up	sta tmpx			;a holds h dir		lda #type_enemy	jsl TSKschedule	dw romanballtask	bcc @notasks			;no room?		jsl copytask2		lda tmpx			sta PICdir,y			;set hdir too	@notasks:	rts;---------------------------------------------------------romanballtask:		lda #1	sta PICscroll,x		lda #6	sta PICcolor,x		lda PIClogic,x	bne @lavaball		lda #4	bra @setbank	@lavaball:	lda #abank@setbank:	sta PICbank,x			jsl	TSKsuspend;----------------------------	lda enemyblind	beq @nostun		rtl	@nostun:	lda PICtemp2,x	inc PICtemp2,x	tay	lda romanymove,y	cmp #4	bne @moveball		;max velocity?		dec PICtemp2,x	lda #2	sta PICscroll,x	lda #2	sta PICmovev,x	lda #4@moveball:	jsl PICyadd	@no_float	lda PICdir,x	jsl PICxadd	@flyaway:	lda PICcollide,x	beq @notnear		lda #drain1	jsl drainstrengthl	@killbullet:	lda #7			;small fire explode	jmp explode	@notnear:	lda TSKclock	and #1	bne @roll2						;animate lava ball - 2 frames@roll1:	lda PIClogic,x	bne @volc1		jsl PICput	dw borg1f28		;roman candleball	rtl@volc1:				;volcano ball anim	jsl PICput	dw lavaf0	rtl	@roll2:	lda PIClogic,x	bne @volc2		jsl PICput		;roman candleball	dw borg1f29	rtl	@volc2:				;volcano ball anim	jsl PICput	dw lavaf1	rtl@killball:	jsl TSKcancel	rtl		romanymove:	dc.b	-8,-8,-8,-8,-8,-8,-8,-7,-7,-6,-6,-5,-4,-3,-2,-1,0,0	dc.b	0,1,0,1,1,2,2,2,3,3,3,4	;---------------------------------------------------------borgmissiletask:	jsr initdir		lda #borgframe	sta PICbank,x		lda #1	sta PIChealth,x		lda #2	sta PICscroll,x		lda #1	sta PICsize,x		lda #1	sta PICcolor,x	;-----------------	lda #sfxmissile1	jsl	soundeffects	jsl TSKsuspend			;move missile		lda TSKclock	and #1	bne @frame2		jsl PICput	dw	borg1f32	bra @movemissile	@frame2	jsl PICput	dw	borg1f33@movemissile	jsr setdir		lda #0	jsr shootenemy		lda #3	jsr movetaskx			lda PICcollide,x	beq @missileok		lda #drain1	jsl drainstrengthl		lda #1	jmp explode	@missileok@waitshot:	lda PIClogic,x	inc PIClogic,x	tay	lda missileymove,y	cmp #128	bne @movey		stz PIClogic,x	bra @waitshot	@movey	jsl PICyadd	rtl	missileymove:	dc.b	5,4,3,2,1,0,0	dc.b	-1,-2,-3,-4,-5,-4,-3,-2,-1,0,0	dc.b	1,2,3,4,128;---------------------------------------------------------------fastmissiletask:	;bob-style straight shooter, very fast!	lda #sfxmissile2	jsl	soundeffects	lda	#1	sta	PICcolor,x	sta PICscroll,x	sta PICsize,x	sta PIChealth,x		stz PICstatus,x	stz PICcount,x			lda #borgframe	sta PICbank,x		jsl	PICput	dw	borg1f32	jsr initdir	jsr setdir	;-------------------------------		jsl TSKsuspend	lda #0	jsr shootenemy	lda	TSKclock	and #1	bne	@otherframe		jsl	PICput	dw	borg1f32	bra	@goon	@otherframe	jsl	PICput	dw	borg1f33	@goon:	inc	PICcount,x			;distance counter		lda	PICcount,x			;speed counter	and	#1	bne	@getspeed		lda	PICstatus,x			;at max speed?	cmp	#12	bcs	@fastenough		inc	PICstatus,x	inc	PICstatus,x	@getspeed:@fastenough:	lda	PICdir,x	bne	@right	@left:	lda	PICstatus,x	jsl	PICxsub	bra @flyaway	@right:	lda	PICstatus,x	jsl	PICxadd	@flyaway:	lda PICcollide,x	bne @boomit			;hit bob?		rtl	@boomit:	lda #drain1			;hurt bob	jsl drainstrengthl		lda #0					;big blast!	jmp	explode;-------------------------------------------------------walkingtanktask:		;walking borg mini tank	lda #4	sta PICbank,x		lda #1	sta PIChealth,x		lda #2	sta PICscroll,x		lda #1	sta PICsize,x		lda #4	sta PICcolor,x		jsr initdir				;always face bob	jsr setdir		lda #borg_minitank	jsr initanim	;------------------------------------		jsl TSKsuspend		lda #1	jsr shootenemy		jsr animborg	jsr setdir	inc PICcount2,x	lda PICcount2,x	cmp #15	bcc @waitshot			;wait for counter		stz PICcount2,x		lda #4	ldy #-4	ldx #0	jsr fire_bullet			;fire@waitshot:@noshot:	lda #2	jsr movetaskx		inc PICtemp1,x	lda PICtemp1,x	and #31	bne @keepwalking		lda PICdir,x	eor #1	sta PICdir,x	@keepwalking	rtl							;---------------------------------------------------------------hoverzaptask:		;hovering, zapping gun 	lda #12	sta sdmaflag			;zapper dma	stz sdmacount		lda #14	sta PICbank,x		lda #6	sta PIChealth,x		lda #2	sta PICscroll,x		lda #1	sta PICsize,x		lda #2	sta PICcolor,x	sta PICprior,x		jsr initdir				;always face bob	jsr setdir		jsl PICput	dw hoverf0				;the zapper itself	;------------------------------------		jsl TSKsuspend		lda #0	jsr shootenemy	@getymove		lda PICcount2,x	inc PICcount2,x	tay	lda zapperymove,y	cmp #126	beq @keepzapping		;pause while firing	cmp #127	beq @shootdown	cmp #128	bne @movey		stz PICcount2,x	bra @getymove	@shootdown:	lda #type_enemy	jsl TSKschedule	dw vzappertask	bcc @no_float		jsl copytask2	bra @keepzapping	@movey	jsl PICyadd	bra @no_float	@no_float	lda #2	jsr movetaskx		inc PICtemp1,x	lda PICtemp1,x	cmp #80	bcc @keepzapping		lda PICdir,x	eor #1	sta PICdir,x		stz PICtemp1,x		;reset x counter	@keepzapping	rtl								zapperymove:	dc.b	-6,-6,-5,-4,-3,-2,-1,-1,0,0,0,0	dc.b	126,127	dc.b	126,126,126,126,126,126,126,126	dc.b	0,0,0	dc.b	1,1,2,3,4,5,6,6,6,6,5,4,3,2,1,1,0,0,0	dc.b	-1,-1,-2,-3,-4,-5,-6,-6	dc.b	128;------------------------vzappertask:			;beam that emerges from zapper	lda #type_badbullet	sta PICtype,x		lda #14	sta PICbank,x		lda #1	sta PICscroll,x		lda #38	sta PICsize,x		lda #6	sta PICcolor,x	;------		lda #zapperbeam	jsr initanim		lda #sfxgasjet	jsl	soundeffects	jsl TSKsuspend	jsr animborg	jsr animborg		lda PICflag,x			;is anim over?	bne @endtask		rtl	@endtask	jsl TSkcancel	rtl		;---------------------------------------------------------------;--------------------------------------------------------------- fourwaytask:		;4 way turret	lda #24	sta sdmaflag			;zapper dma	stz sdmacount		lda #14	sta PICbank,x		lda #10	sta PIChealth,x		lda #2	sta PICscroll,x		lda #3	sta PICsize,x		lda #4	sta PICcolor,x		jsl PICput	dw fourwayf0				;the turret itself	;------------------------------------		jsl TSKsuspend			lda #0	jsr shootenemy		inc PICcount,x	lda PICcount,x	cmp #10	bcc @no_task		stz PICcount,x		inc PICcount2,x		lda #type_enemy	jsl TSKschedule	dw fourwayflametask	bcc @no_task		jsl copytask2		lda PICcount2,x		;current flame type	and #3	sta PIClogic,y@no_task	rtl							;------------------------fourwayflametask:			;beam that emerges from zapper	lda #type_badbullet	sta PICtype,x		lda PIClogic,x	tay	lda fourwaysize,y	sta PICsize,x		lda PIClogic,x	pha	asl a	asl a	tay	lda fourwaydata,y	sta PICdir,x	lda fourwaydata+1,y	sta PICdirv,x	lda fourwaydata+2,y	sta tmpx	lda fourwaydata+3,y	jsl PICyadd	lda tmpx	jsl PICxadd		ply	lda fourwayframe,y	jsr initanim		jsr setdir	jsr setdirv			lda #14	sta PICbank,x		lda #1	sta PICscroll,x		lda #6	sta PICcolor,x		lda #sfxgasjet	jsl	soundeffects;----------------	jsl TSKsuspend	jsr animborg	jsr animborg		lda PICflag,x			;is anim over?	bne @endtask		rtl	@endtask	jsl TSkcancel	rtl	fourwaydata:		;hdir, vdir, anim type	dc.b	1,1,16,0	dc.b	1,1,0,16	dc.b	0,1,-16,0	dc.b	1,0,0,-16	fourwayframe:	dc.b	fourwayside	dc.b 	fourwayvert	dc.b	fourwayside	dc.b 	fourwayvert	fourwaysize:	dc.b	39,38,39,38;---------------------------------------------------------------stormtask:		stz PICtemp1,x	stz PICtype,x	jsl TSKsuspend		;no picscroll- this task generates storms	inc PICcount2,x	lda PICcount2,x	cmp #8	bcc @notasks			;time for new drop?			stz PICcount2,x		inc PICtemp1,x	lda PICtemp1,x	cmp #50	bcs @endstorm			;end after N drops		lda #type_enemy	jsl TSKschedule	dw raintask	bcc @notasks			;no room?		jsl copytask2		lda rndseed	adc TSKclock	sta rndseed	jsl PICxadd		stz PICxhi,x		lda rndseed	and #7	sec	sbc #3	sta PICdir,x	@notasks:	rtl	@endstorm:	jsl TSKcancel	rtl;---------------------------------------------------------------raintask:					;rain droplet task	@funballrain:	lda #2	sta PICscroll,x		lda #-8	sta PICylo,x		stz PICxhi,x		lda #-1	sta PICyhi,x		stz PICsize,x	stz PICtemp2,x;-----------------------------		lda #1	sta PIChealth,x		stz PICcount2,x		jsl TSKsuspend		lda #0			;check for tree on initial spot	ldy #8	jsl bgcoll_longer		lda chartype	cmp #solid	bne @startfall		inc PICcount2,x		;try to fall for a 1/2 second	lda PICcount2,x	cmp #30	bcc @tryagain		jsl TSKcancel		;don't start in solid masses@tryagain:	rtl	@startfall:	lda #jungbullet	jsr initanim		lda #ubank	sta PICbank,x		jsr animborg	;-------------------	jsl	TSKsuspend	lda #17	jsr shootenemy		lda PICdirv,x	beq @downrain@uprain:			;go up	lda #8	jsl PICysub	lda #-4	sta PICmovev,x		lda #0			;check for trees to bounce off of	ldy #-8	jsl bgcoll_longer		lda chartype	cmp #solid	bne @nomove1			stz PICdirv,x		inc PICtemp2,x		;bounce count		lda #sfxfunballbounce	jsl soundeffects	@nomove1:	bra @nomove	@downrain:			;go down	lda #8	jsl PICyadd	lda #4	sta PICmovev,x	lda #0			;check for trees to bounce off of	ldy #8	jsl bgcoll_longer		lda chartype	cmp #solid	bne @nomove			inc PICdirv,x	inc PICtemp2,x		;bounce count@nomove:	lda	PICdir,x		;move x too	jsl	PICxadd		lda PICtemp2,x		cmp #4	bcs @burst		;pop after four bounces		jsr animborg	rtl	@burst:	lda #17	jmp explode		************************************************************************		BORG BOSS WITH SNAKE HEAD***bossheadguntask:			;little guns that fire too	lda #4	jsl TSKwait		lda #type_enemy	jsl TSKschedule	dw bossheadgun2task	jsl copytask		lda #96	jsl PICyadd		lda #50	sta PICcount2,x	bossheadgun2task:		jsl TSKcancel	rtl		lda #24	jsl PICyadd		lda #32	jsl PICxadd		lda #0				;16x16	sta PICsize,x			lda #14	sta PICbank,x		lda #1	sta PICscroll,x		lda #10	sta PIChealth,x		lda #4	sta PICcolor,x		stz PICprior,x	;-------------	jsl TSKsuspend		lda #0	jsr shootenemy		inc PICcount2,x	lda PICcount2,x	cmp #60			;fire rate in 1/2 cycles	bcc @waitshot	beq @fireshot	cmp #65	bcc @recoil		;hold recoil for 5		stz PICcount2,x@recoil:	rtl	@fireshot;	lda #8				;	ldy #0;	ldx #2			;laser bolt shape;	jsr fire_bullet		jsl PICput	dw snakef12			;shoot left recoil	rtl	@waitshot:	jsl PICput	dw snakef11			;shoot left frame		rtl	;--------------------------------------------------------	headsize			equ	9+1		;number of pieces in bosssnakeheadtask:borgbossheadtask:	stz firstworm	stz bossflag1		lda #3			;permanent removal	sta PICscroll,x		lda #2	sta PICtemp1,x		lda #1	sta PIChealth,x		ldy #0	@makeworm:					;build the worm up	phy		lda #type_enemy	jsl TSKschedule	dw headpart		jsl copytask2	ply	iny	cpy #headsize		;worm pieces, please. Thank you very much.	bcc @makeworm	jsr restoretask		jsl TSKcancel		rtl	***********************************************************************headpart:		;this is the logic control		lda #3	sta PICcolor,x	lda #8	jsl PICxadd		stz queenflag			;<>0 then boss is dead	stz eyecount			;<>0 then boss is firing/stopping		lda #60					;initial delay before moving	sta PICed,x		lda firstworm	sta PICtemp2,x		;head counter		inc firstworm		;inc counter		sta PICfloat,x		lda #1	sta PICscroll,x		inc PICprior,x		;make appear in front of bob		lda #80	sta PIChealth,x		lda #1	sta PICdirv,x	lda #13+3	;10				;set vdir counter to	sta PICcount2,x		;start move 50% through	lda #14	sta PICbank,x		lda #snakeneck	jsr initanim	jsr animborg		lda PICtemp2,x	sta PICanim,x		stz PICtype,x		;make non-enemy		lda PICtemp2,x		;is this head?	bne @go			;no	lda #13			;21	sta PICsize,x		stx bosstarget		lda #snakeeyesopen		;head shape	jsr initanim		lda #type_enemy	sta PICtype,x	@go:	lda #0		;snakeheadxpos+8	sta PIClogic,x				;makes startxpos = 0		;--------------------------------			jsl TSKsuspend		jsr floattask		lda PICtemp2,x		;is this the head or just a neck part?	beq @head	brl @nothead;-------------------------@head:	;special head logic		lda PIChealth,x		;head shot yet	lsr a	sta bossstrength	;show health		lda PIChealth,x		;head shot yet	bne @safehead		inc queenflag	lda #60	sta PICshake,x	sta PICcolorhit,x		lda #sfxsnakeboss1	jsl soundeffects	stz bosstarget		lda #30	jsl TSKwait		inc queenflag		jsr score5000		lda #maxstrength	sta strength		lda #180	sta	winflag			;3 seconds then end level		lda #sfxsnakeboss1	jsl soundeffects		lda #30	sta shakescreen		lda #25	jmp explode	@safehead:		jsr blinkenemy	lda PICflag,x		;must be firing	beq @nofire			;so continue anim only		stz eyecount		;reset fire flag		lda PICxlo,x		;head in correct screen area to fire?	cmp #-100	bcc @nofire	lda PICylo,x	cmp #150	bcs @nofire	cmp #40	bcc @nofire		inc bosscount1		lda bosscount1	and #7+16	bne @nofire			inc eyecount		;fire something, you idiot!		inc bossflag1	lda bossflag1	and #1	beq @fireturret	@launchmissile:	lda #snakehead	jsr initanim	bra @nofire	@fireturret:	lda #snakeheadgun	jsr initanim@nofire:		lda PICstatus,x	cmp #snakehead	beq @trymissile		;shooting missile or bullet?	@trybullet:	lda PICanim,x			;fire bullet at right time	cmp #14	bne @nobullet		lda PICcount,x	bne @nobullet		;fire only one		lda #44	jsl PICysub		lda #10	ldy #-2	ldx #1		;snake head bullet	jsr fire_bullet	lda #8	jsl PICxsub	lda #10	ldy #2	ldx #1		;snake head bullet	jsr fire_bullet	lda #8	jsl PICxadd	lda #44	jsl PICyadd	bra @nobullet	@trymissile:	lda PICanim,x			;fire bullet at right time	cmp #5	bne @nobullet		lda PICcount,x	cmp #1	bne @nobullet		;fire only one		jsr @firemissile	@nobullet:;---------------------------	@nothead:				;rest of motion for all parts		jsr animborg	lda queenflag	bne @done			;no move if about to die		lda PICed,x		;delay to keep anything from moving	beq @canmove		dec PICed,x	rtl	@canmove	lda PICtemp2,x	tay	lda headvmove,x	sta temp+5		lda eyecount	bne @done			;no move during anim	;	lda #sfxborghead;	jsl	soundeffects	inc PICcount2,x		;update direction chnage counter	lda PICcount2,x	cmp #5	bcc @slowdown;	cmp #15;	beq @lookforbob	cmp #23					;21	bcc @samedir	cmp #28					;26	beq @reversedir	@slowdown	lda temp+5	lsr a	sta temp+5		bra @samedir			;no move this cycle	@reversedir:	stz PICcount2,x		lda PICdirv,x		;change head dir	eor #1	sta PICdirv,x		lda temp+5	lsr a	lsr a	sta temp+5;	bra @samedir;	;@lookforbob:;	lda bobypos;	cmp #128;	bcs @goupper;	;	lda #1;	sta PICdirv,x;	bra @samedir;	;@goupper;	stz PICdirv,x@samedir	lda PICdirv,x	bne @down	@up	lda temp+5	jsl PICysub	bra @done	@down	lda temp+5	jsl PICyadd	@done	lda queenflag	beq	@notneck		;blow up neck parts if head dies;	cmp #2;	beq @finalboom	;	rtl	@finalboom:	lda #60	sta PICcolorhit,x	sta PICshake,x		lda PICtemp2,x	asl a	asl a	asl a	adc #30	jsl TSKwait		;progressive blowup		lda #20	sta shakescreen		lda #25	jmp explode			@notneck:		;make sure parts are positioned properly at XPOS	lda queenflag	beq @bodylives		rtl				;skip all movement if about to die!	@bodylives:	lda eyecount	beq @moremove		rtl	@moremove:		lda bossflag1	cmp #90			;time before head retracts	bcs @retract		lda PICtemp2,x	tay	lda PIClogic,x	cmp #45	bcc @waiting			;if true then wait a bit		cmp snakeheadxpos,y	bcs @xset		lda #8						;2	jsl PICxsub	lda #-4						;-1	sta PICmoveh,x		lda PICtemp2,x	bne @nobump			;check to see if this is head		lda #1	jsr knockbob		;bounce to left;	lda #sfxsnakeboss2;	jsl soundeffects	@nobump:	@waiting:	inc PIClogic,x	stz PICcollide,x	rtl	@xset:	inc bossflag1				;inc counter to send head back		stz PICcollide,x		rtl	@retract:		;head retracts	stz PICcollide,x	lda PIClogic,x	cmp #35	beq @backhome		;stop at wall		dec PIClogic,x		cmp #46	bcc @xset		;pause		lda #8				;2	jsl PICxadd	lda #4				;1	sta PICmoveh,x		rtl	@backhome	lda PICtemp2,x	bne @xset  ;if not head then no logic control allowed		stz bossflag1	;	lda #snakehead;	jsr initanim;	lda #7;	ldy #0;	ldx #1				;sperm;	jsr fire_bullet;	lda #sfxsnakeboss1;	jsl soundeffects		rtl	;----------------@firemissile:	lda #type_enemy	jsl TSKschedule	dw snakeheadmissile	bcc @notaskm		jsl copytask	@notaskm:	rts	headvmove:	dc.b	0,8,8,8,8,8,7,6,5,4,3,2,1,0,0,0	snakeheadxpos:	dc.b	64,61,59,57,55,53,51,49,47,45,43,45,45,45;--------------------------------------------------------------snakeheadmissile:		;missile for snake head boss		lda #1	sta PIChealth,x		lda #8	sta PICsize,x		lda #3	sta PICcolor,x		lda #14	sta PICbank,x		stz PICdir,x		lda #sfxmissile2	jsl soundeffects		lda #30	jsl PICyadd	lda #24	jsl PICxsub		jsl TSKsuspend	;----------------	lda TSKclock	and #1	bne @frame2	@frame1:	jsl PICput	dw snakef27	bra @move	@frame2:	jsl PICput	dw snakef28@move:	lda #25	jsr shootenemy		lda PICtemp2,x	jsr movetaskx	lda PICtemp2,x	cmp #18	bcs @fastenough		inc PICtemp2,x	inc PICtemp2,x@fastenough:	jsr floattask	@nomove:	lda PICxlo,x	cmp #32	bcc @boom			;explode at left of screen		lda PICxhi,x	bne @boom		lda PICcollide,x	beq @safe		lda #5	jsl drainstrengthl	@boom:	lda #25	jmp explode	@safe:	rtl;----------------------------------------------------------pussmantask:		;was old puss man boss taskdeathbosstask:			;death boss task	stz leftgunflag		;tells head when gun shot off	stz rightgunflag		lda #60	jsl TSKwait		lda #deathbank	sta PICbank,x		lda #65	sta PIChealth,x		lda #29			sta PICsize,x			lda #3	sta PICcolor,x		lda #deathheadlaugh	jsr initanim		lda #128	sta PICxlo,x		lda #128	sta PICylo,x		stz PICxhi,x		lda #-1	sta PICyhi,x		lda	#type_enemy	jsl	TSKschedule			dw	deathleftgun				jsl copytask2	lda	#type_enemy	jsl	TSKschedule			dw	deathrightgun				jsl copytask2	lda	#type_enemy	jsl	TSKschedule			dw	deathbodytask				jsl copytask2	ldy #-64		;xpos	lda #15						;shield	jsl makepowerup2	stx bosstarget		stz powerupflag;--------------------	jsl TSKsuspend		lda minutes	cmp #2	bne @wrongtime		lda seconds	cmp #30	bne @wrongtime		lda powerupflag	bne @wrongtime		ldy #64		;xpos	lda #3	jsl makepowerup2	inc powerupflag	@wrongtime:	jsr animborg		lda PIChealth,x	sta bossstrength		lda PIChealth,x	beq @dying		jmp @alive	@dying:	lda #sfxqueenscream	jsl soundeffects		inc bossflag2		;tell body head is now alone		lda bossflag2	cmp #1	bne @finaldeath		;1st or second death?		lda #100	sta PICcolorhit,x	sta PICshake,x		lda #91			;1st	sta PIChealth,x	sta PICshake,x	lda #deathheadlaugh	jsr initanim	lda #30	sta PICcolorhit,x		stz bossflag1		;tell logic to reset skull position	stz bosscount1	stz PICcount2,x		lda #15	ldy	#64	jsl makepowerup2	;give a shield	lda #6	ldy	#-64	jsl makepowerup2	;give plasma	lda #1	ldy	#128	jsl makepowerup2	;give health	bra @alive	@finaldeath:	jsl PICput	dw deathf4		;open jaw		lda #60	sta PICshake,x	sta PICcolorhit,x		stz PICtemp2,x	stz PICtype,x		lda #30			;drop to ground	jsl TSKwait		inc PICtemp2,x	lda PICtemp2,x	lsr a	jsl PICyadd		lda PICylo,x	cmp #150	bcs @thud		;hit bottom		rtl	@thud:	lda #30	sta shakescreen	lda #sfxexplode2	jsl soundeffects		jsl PICput	dw deathf3		;open jaw		lda #70	sta winflag		lda #maxstrength	sta strength	lda #15	jsl TSKwait		jsr score25000	jsr score10000		lda #14	jmp explode	@alive:	jsr blinkenemy		; set up start pos.	lda bossflag1	bne @bossready			;is boss ready to fight?		lda PICyhi,x			;move boss to start pos.	beq @onscreen1	@moveon:	lda #3	jsl PICyadd	jmp @firing	@onscreen1:	lda PICylo,x	cmp #56	bcc @moveon			;keep going down		cmp #60	bcc @ready1		lda #3	jsl PICysub			;move up ?(if after 1st death only)	jmp @firing	@ready1:	jsr centretaskx	jsr centretaskx	jsr centretaskx	bcs @alldone		jmp @firing			;still centering xpos....	@alldone:	stz PICcount2,x		inc bossflag1@bossready:		jsr floattask ;make hover; main xmove routine	lda #7			;set dbr to be safe	pha	plb	@getagain:	lda bossflag2			;which table of attack?	beq @gotabody		lda #4	bra @getpattern	@gotabody:	lda leftgunflag	clc	adc rightgunflag	cmp #0	beq @getpattern		;got all the stuff	cmp #2	beq @noguns			;all guns gone		lda leftgunflag	beq @noright	@noleft:		;missing left gun	lda #1	bra @getpattern@noright:		;missing right gun	lda #2	bra @getpattern	@noguns:	lda #3		;body only	@getpattern:	asl a	tay	lda deathsequencetable,y	sta temp	lda deathsequencetable+1,y	sta temp+1		lda bosscount1		;attack counter	tay	lda (temp),y	cmp #128	bne @getmove		;find current move sequence		stz bosscount1		;reset move table pointer	bra @getagain	@getmove:	asl a	tay	lda deathmoveaddr,y	sta temp	lda deathmoveaddr+1,y	sta temp+1		lda PICcount2,x	inc PICcount2,x	asl a	tay	lda (temp),y	cmp #128	beq @endmove	cmp #127	beq @fire1		;left gun	cmp #126	beq @fire2		;right gun	cmp #125	beq @fire3		;fart	cmp #124	beq @fire4		;vomit		phy	jsl PICxadd	ply	iny	lda (temp),y	jsl PICyadd	bra @donemove	@endmove:	stz PICcount2,x			;reset move counter		inc bosscount1		jmp @getagain	@fire1:			;trigger left gun	lda #1	sta bosscount2		;tell gun 1 to fire	lda #deathheadlaugh	jsr initanim	lda #60	sta PICshake,x		bra @donemove	@fire2:			;trigger right gun	lda #2	sta bosscount2		;tell gun 1 to fire	lda #deathheadlaugh	jsr initanim	lda #60	sta PICshake,x	bra @donemove@fire3:			;drop bloodfart	lda #deathheadlaugh	jsr initanim	lda enemyblind	bne @nofart		lda #type_enemy	jsl TSKschedule	dw bloodfarttask	bcc @nofart	jsl copytask@nofart:	lda #sfxpussdrop	jsl soundeffects		bra @donemove	@fire4:		;vomit	lda #deathheadlaugh		;deathheadvomit	jsr initanim	lda #type_enemy	jsl TSKschedule	dw vomittask	jsl copytask		lda #sfxdrip		;pussmanbelch	jsl soundeffects@donemove:@firing:	lda PICflag,x	beq @nofloat		;only float if not moving mouth	@nofloat:	jsr setbosspos		jsr initdir	jsr setdir		rtl	;--------------------------------------------------dright	equ	0dcircle equ	1dleft	equ	2ddown	equ	3dup		equ	4dsiner	equ	5	;v sine rightdsinel	equ	6	;v sine leftdfart	equ	7	;bloodfart attackdvomit	equ	8	;vomit attackdshootl	equ	9	;shoot left gundshootr	equ	10	;shoot left rightdcirclefart	equ	11	;circle & fartdupleft	equ	12		;move to upper left from centredpause	equ	13		;short pauseddownright	equ	14		;move to centre from upper leftdrighthalf	equ	15		;1/2 right movedeathsequencetable:	dc.w	deathmovesequence		;1st	dc.w	deathmovesequence2		;no left gun	dc.w	deathmovesequence3		;no right gun	dc.w	deathmovesequence4		;no guns	dc.w	deathmovesequence5		;no body	deathmovesequence:	dc.b	dup	dc.b	dcircle	dc.b	dcirclefart	dc.b	dleft,dleft	dc.b	dshootr	dc.b	dright,dright,dright,dright	dc.b	dshootl	dc.b	dleft	dc.b	dcirclefart	dc.b	dleft,dleft	dc.b	dcirclefart	dc.b	dright	dc.b	ddown		;more stuff....	dc.b	dcircle	dc.b	dshootl	dc.b	dcircle	dc.b	dshootr	dc.b	dcircle		dc.b	dleft,dleft,dup,dup	dc.b	dsiner,dsiner,dsinel,dsinel,dsiner,dsiner,ddown	dc.b	dsinel,dsinel,ddown	dc.b	dsiner		dc.b	128	deathmovesequence2:		;left gun is blown off. new pattern	dc.b	dupleft,dshootr	dc.b	dpause,dpause,dpause	dc.b	dshootr,dpause,dshootr	dc.b	dpause,dpause,dpause	dc.b	dsiner,dsiner,dpause	dc.b	dsinel,dsinel,dpause	dc.b	dsiner,dsiner,dpause	dc.b	dsinel,dsinel,dpause	dc.b	ddownright,dsiner,dsinel,dcircle	dc.b	128	deathmovesequence3:				;right gun blown off, left fire	dc.b	dright,dright,dcircle,dshootl,dpause	dc.b	dup,dshootl,dpause,ddown	dc.b	dleft,dleft,dcircle,dshootl,dpause,dpause	dc.b	128	deathmovesequence4:		;fart attack	dc.b	dup,dsinel,dup,dsiner,dsiner	dc.b	dsinel,dsinel	dc.b	dsiner		;,drighthalf,dsiner;	dc.b	dsinel,dsinel;	dc.b	drighthalf,dsiner,dsiner;	dc.b	dsinel,dleft	dc.b	ddown,dcirclefart,ddown,dsinel,dsiner	dc.b	ddown,dright,dleft,dup	dc.b	128	deathmovesequence5:		;final vomit attack	dc.b	dvomit,dleft,dvomit,dleft,dvomit	dc.b	drighthalf,dvomit,dright,drighthalf,dvomit,dright,dvomit,dright	dc.b	drighthalf,dvomit,dleft,dvomit,dleft,dleft	dc.b	dvomit,drighthalf	dc.b	128deathmoveaddr:			;table of table offsets	dc.w	deathmove1	dc.w	deathmove2	dc.w	deathmove3	dc.w	deathmove4	dc.w	deathmove5	dc.w	deathmove6	dc.w	deathmove7	dc.w	deathmove8	dc.w	deathmove9	dc.w	deathmove10	dc.w	deathmove11	dc.w	deathmove12	dc.w	deathmove13	dc.w	deathmove14	dc.w	deathmove15	dc.w	deathmove16	deathmove1:		;x move to right	dc.b	4,0,4,0,4,0,4,0	dc.b	4,0,4,0,4,0,4,0	dc.b	4,0,4,0,4,0,4,0	dc.b	4,0,4,0	dc.b	128,128	deathmove2:		;move in circle	dc.b	4,0,4,0,4,1,4,2,4,3	dc.b	4,4,4,4,4,4,3,4,2,4,1,4	dc.b	0,4,0,4,-1,4,-2,4,-3,4	dc.b	-4,4,-4,4,-4,4,-4,3,-4,2,-4,1	dc.b	-4,0,-4,0,-4,0	dc.b	-4,-1,-4,-2,-4,-3	dc.b	-4,-4,-4,-4,-4,-4	dc.b	-3,-4,-2,-4,-1,-4	dc.b	0,-4,0,-4	dc.b	1,-4,2,-4,3,-4	dc.b	4,-4,4,-4,4,-4	dc.b	4,-3,4,-2,4,-1	dc.b	4,0		dc.b	128,128	deathmove3:		;x move to left	dc.b	-4,0,-4,0,-4,0,-4,0	dc.b	-4,0,-4,0,-4,0,-4,0	dc.b	-4,0,-4,0,-4,0,-4,0	dc.b	-4,0,-4,0	dc.b	128,128	deathmove4:		;ymove down	dc.b	0,1,0,2,0,3,0,4,0,4,0,4,0,4	dc.b	0,4,0,4,0,4,0,4	dc.b	0,4,0,4,0,3,0,2,0,1	dc.b	128,128	deathmove5:		;ymove up	dc.b	0,-1,0,-2,0,-3,0,-4,0,-4,0,-4,0,-4	dc.b	0,-4,0,-4,0,-4,0,-4	dc.b	0,-4,0,-4,0,-3,0,-2,0,-1	dc.b	128,128deathmove6:		;vert. sine & right	dc.b	4,-6,4,-5,4,-4,4,-3,4,-2,4,-1,4,0	dc.b	125,125	dc.b	4,1,4,2,4,3,4,4,4,5,4,6,4,6,4,5,4,4	dc.b	125,125	dc.b	4,3,4,2,4,1,4,0	dc.b	125,125	dc.b	4,-1,4,-2,4,-3,4,-4,4,-5,4,-6,128,128	deathmove7:		;vert. sine & left	dc.b	-4,-6,-4,-5,-4,-4,-4,-3,-4,-2,-4,-1,-4,0	dc.b	125,125	dc.b	-4,1,-4,2,-4,3,-4,4,-4,5,-4,6,-4,6,-4,5,-4,4	dc.b	125,125	dc.b	-4,3,-4,2,-4,1,-4,0	dc.b	125,125	dc.b	-4,-1,-4,-2,-4,-3,-4,-4,-4,-5,-4,-6,128,128	deathmove8:		;blood fart attack	dc.b	1,0,2,0,3,0,2,0,1,0	dc.b	0,0,125,125	dc.b	-1,0,-2,0,-3,0,-2,0,-1,0	dc.b	128	deathmove9:		;vomit	dc.b	0,0,0,0,0,0,0,0	dc.b	124,0	dc.b	0,0,0,0,0,0,0,0	dc.b	128,128deathmove10:		;shoot left gun	dc.b	0,0,0,0,0,0,0,0	dc.b	127,127	dc.b	0,0,0,0,0,0,0,0	dc.b	0,0,0,0,0,0,0,0	dc.b	0,0,0,0,0,0,0,0	dc.b	128,128deathmove11:		;shoot right gun	dc.b	0,0,0,0,0,0,0,0	dc.b	126,126	dc.b	0,0,0,0,0,0,0,0	dc.b	0,0,0,0,0,0,0,0	dc.b	0,0,0,0,0,0,0,0	dc.b	128,128deathmove12:		;move in circle and fart too	dc.b	125,125,4,0,4,0,4,1,4,2,4,3	dc.b	4,4,4,4,4,4,3,4,2,4,1,4	dc.b 	125,125	dc.b	0,4,0,4,-1,4,-2,4,-3,4	dc.b	-4,4,-4,4,-4,4,-4,3,-4,2,-4,1	dc.b	-4,0,-4,0,-4,0	dc.b 	125,125	dc.b	-4,-1,-4,-2,-4,-3	dc.b	-4,-4,-4,-4,-4,-4	dc.b	-3,-4,-2,-4,-1,-4	dc.b 	125,125	dc.b	0,-4,0,-4	dc.b	1,-4,2,-4,3,-4	dc.b	4,-4,4,-4,4,-4	dc.b	4,-3,4,-2,4,-1	dc.b	4,0		dc.b 	125,125	dc.b	128,128deathmove13:			;diag. to upper left		dc.b	-1,-1,-2,-2,-3,-3,-4,-4,-5,-5,-6,-6	dc.b	-7,-7,-7,-7,-7,-7	dc.b	-6,-6,-5,-5,-4,-4,-3,-3,-2,-2,-1,-1	dc.b	128,128	deathmove14:			;pause	dc.b	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0	dc.b	128	deathmove15:			;back to centre from upper left	dc.b	1,1,2,2,3,3,4,4,5,5,6,6	dc.b	7,7,7,7,7,7	dc.b	6,6,5,5,4,4,3,3,2,2,1,1	dc.b	128,128deathmove16:			;1/2 move to right for vomit spacing	dc.b	4,0,4,0,4,0,4,0	dc.b	4,0,4,0,4,0	dc.b	128,128;---------------------------------------------------deathbodytask:		;main body of death boss	lda #11	sta PICbank,x		stz PICtype,x			lda #deathbody	jsr initanim		jsl TSKsuspend		lda bossflag2		;drop body offscreen when head's dead	beq @alive		inc PICtemp1,x	lda PICtemp1,x	lsr a	jsl PICyadd		lda PICyhi,x	beq @anim	lda PICylo,x	cmp #128	bcc @anim		lda #30	sta shakescreen	lda #sfxexplode1	jsl soundeffects		jsl TSKcancel		;end of bod!	rtl	@alive:	lda #0	ldy #64	jsr getbosspos		lda #3	sta PICcolor,x	@anim:	jsr animborg		rtl;------------------------------------------------------------------	deathleftgun:		;left side gun on boss	lda #deathbank	sta PICbank,x		lda #deathgun1	jsr initanim	jsr animborg		lda #20	sta PIChealth,x		lda #1	sta PICsize,x		jsl TSKsuspend		lda #-32	ldy #16	jsr getbosspos	lda #type_enemy	sta PICtype,x		lda PIChealth,x	bne @safegun		inc leftgunflag		;tell head left gun is gone	stz bossflag1		;tell logic to reset skull position	stz bosscount1		lda #3	ldy #80	jsl makepowerup2		;give tripleshot	@safegun:	lda #14	jsr shootenemy	lda #deathgun1		;show muzzle flash?	sta PICstatus,x		lda PICtemp2,x		;no	beq @animate		inc PICstatus,x		;show muzzle flash	dec PICtemp2,x		;lower count	@animate:	jsr animborg		lda bossflag2	beq @bodyalive		;blow up guns with body death?		lda #sfxexplode2	jsl soundeffects	lda #2	sta PICstatus,x		;boom	jsr makebits	jsl TSKcancel	rtl	@bodyalive:		lda bosscount2	cmp #1			;should this gun fire?	bne @nofire		lda PICanim,x	;every 2nd frame shoot	and #1	beq @holdfire		lda PICcount,x	cmp #1	bne @holdfire		;1 shot per frame	lda PICanim,x	lsr a	tay	lda deathgundirh,y	sta PICdir,x	lda deathgunspeed,y	sta PIClogic,x		lda #type_enemy	jsl TSKschedule	dw deathleftbullet	bcc @noroom		jsl copytask2	@noroom:	lda #4	sta PICtemp2,x		;muzzle flash counter		inc PICtemp1,x		;shot count at max?	lda PICtemp1,x	cmp #10	bcc @holdfire		stz bosscount2	@holdfire:	rtl	@nofire:	stz PICtemp1,x		rtldeathgundirh:	dc.b	1,1,0,0,0,1deathgunspeed:	dc.b	8,4,4,8,4,4	;------------------------------------	deathleftbullet:		;high speed bullet routine		lda #sfxeggopen	jsl soundeffects	lda #10	jsl PICyadd		lda #deathbank	sta PICbank,x	lda #type_badbullet	sta PICtype,x		jsl PICput	dw deathf37		lda #3	sta PICcolor,x	jsl TSKsuspend		lda PICxhi,x	ora PICyhi,x	beq @onscreen		jsl TSKcancel	rtl	@onscreen:;	lda TSKclock;	and #1;	bne @frame2	@frame1:;	jsl PICput;	dw deathf51;	bra @donef	@frame2:;	jsl PICput;	dw deathf52@donef:		lda PIClogic,x	jsr movetaskx		lda #8	jsl PICyadd		lda PIChit,x			;hit bob?	beq @nothit		lda #3	jsl justdrainstrengthl		lda #23	jmp explode	@nothit:	inc PICprior,x		rtl;-------------------------------------------------	deathrightgun:		;right side gun on boss	lda #deathbank	sta PICbank,x		lda #deathgun2	jsr initanim		lda #6	sta PICanim,x	jsr animborg		lda #20	sta PIChealth,x		lda #1	sta PICsize,x	jsl TSKsuspend		lda #41	ldy #8	jsr getbosspos		lda #type_enemy	sta PICtype,x		lda PIChealth,x	bne @safegun		inc rightgunflag		;tell head right gun is gone	stz bossflag1		;tell logic to reset skull position	stz bosscount1	stz PICcount2,x		lda #5	ldy #-80	jsl makepowerup2	;give missiles@safegun:	lda #14	jsr shootenemy	jsr animborg			lda bossflag2	beq @bodyalive		;blow up guns with body death?		lda #sfxexplode2	jsl soundeffects	lda #2	sta PICstatus,x		;boom	jsr makebits	jsl TSKcancel	rtl	@bodyalive:		lda bosscount2	cmp #2			;should this gun fire?	bne @nofire		lda PICanim,x	;every 2nd frame shoot	and #1	bne @holdfire		lda PICcount,x	cmp #1	bne @holdfire		;1 shot per frame	lda PICanim,x	lsr a	tay	lda rdeathgundirh,y	sta PICdir,x	lda rdeathgunspeed,y	sta PIClogic,x		lda #type_enemy	jsl TSKschedule	dw deathmissile	bcc @noroom		jsl copytask2		lda PICanim,x	sta PICanim,y	@noroom:		inc PICtemp1,x		;shot count at max?	lda PICtemp1,x	cmp #8	bcc @holdfire		stz bosscount2	@holdfire:	rtl	@nofire:	stz PICtemp1,x		rtlrdeathgundirh:	dc.b	1,1,0,0,0,1	dc.b	1,1rdeathgunspeed:	dc.b	3,2,2,3,2,2	dc.b	3,2deathmissiley:		;y speed	dc.b	3,4,4,3,4,4	dc.b	3,4deathmstartx:	dc.b	4,2,-2,-4,-2,2,4,2;-------------------------------------------------------	deathmissile:		;high speed missile routine		lda #2	sta PICscroll,x		lda #6	jsl PICyadd		lda #sfxworker	jsl soundeffects		lda #deathbank	sta PICbank,x	lda #3	sta PICcolor,x	inc PIChealth,x		lda #99	sta PICcount,x		;set graphics	lda #death_missile	sta PICstatus,x		;PICanim already set by gun task!	jsr animborg		;draw current frame		lda PICanim,x	lsr a	tay	lda deathmissiley,y	sta PICdirv,x	lda deathmstartx,y	jsl PICxadd	;-------------------		jsl TSKsuspend	lda #23	jsr shootenemy		lda PIClogic,x	jsr movetaskx		lda PICdirv,x	jsl PICyadd		lda PICcollide,x			;hit bob?	beq @nothit		lda #5	jsl drainstrengthl		lda #23	jmp explode	@nothit:	inc PICprior,x		lda PICylo,x	cmp #165	bcc @stable		lda #10	sta shakescreen		lda #23	jmp explode		;hit bottom	@stable:	rtl;--------------------------------------------------bloodfarttask:		;slow moving death blood ball	lda #74	jsl PICyadd		lda #deathbank	sta PICbank,x		lda #3	sta PICcolor,x			jsl PICput	dw deathf50		inc PICprior,x		lda #3	sta PICscroll,x		lda #2	sta PIChealth,x	;-----------------------------	jsl TSKsuspend	lda #23			;22	jsr shootenemy		inc PICtemp2,x		lda PICtemp2,x	lsr a	jsl PICyadd		jsr floattaskx		;make h wobble		lda PICcollide,x	beq @nohit		lda #drain1	jsl drainstrengthl		lda #23					;23	jmp explode		@nohit:		lda PICylo,x	cmp #195	bcc @safemine		jsl TSKcancel		;avoids slowdowns	@safemine:	rtl;--------------------------------------------------vomittask:		;slow moving death blood ball		lda #80	sta PICylo,x		lda #deathbank	sta PICbank,x		lda #1		sta PICsize,x	sta PICprior,x		lda #3	sta PICcolor,x			lda #sfxpussmanbelch	jsl soundeffects		lda #deathvomit	jsr initanim;  -----------------------------	jsl TSKsuspend	jsr animborg		lda PICanim,x			;pop time?	cmp #10+4	bne @dribble	lda PICcount,x	bne @dribble		lda #sfxbugsplat1	jsl soundeffects		lda #44	jsl PICyadd	lda #10	jsl PICxadd	@dribble:	lda PICanim,x	cmp #13+4	bcc @no_danger		;will it hit bob yet?		lda #43	sta PICsize,x		;vomit size	@no_danger:	lda PICflag,x	beq @not_over		;wait till end		jsl TSKcancel		;end o' vomit	@not_over:	rtl;-------------------------------------------------embryospeed	equ	4bottomembryo	equ	160	;bottom of screen for bounce ,etc.embryotask:		jsr initdir		inc PICprior,x			;start in front of pussman		lda #30	jsl PICyadd		lda #1	sta PICdirv,x		lda #fatheadbank			;pussbank	sta PICbank,x		lda #8	jsl TSKwait			;wait before showing up		lda #embryo_ball	jsr initanim	jsr animborg		lda #1	sta PIChealth,x		lda #3	sta PICcolor,x		lda #2	jsl TSKwait			;hold on tongue	;--------------------	lda PIChealth,x		;shot when in bubble?	bne @in_bubble	@godrop:	jmp @dropdown	@in_bubble:		lda enemyblind	beq @moveit		rtl					;stunned	@moveit:	lda PIClogic,x		;hit ceiling yet?	bne @godrop		lda #embryospeed	jsr movetaskx			;move xpos		@movey	lda PICdirv,x	bne @down	@up	lda #embryospeed	jsl PICysub	bra @bounce	@down	lda #embryospeed	jsl PICyadd	@bounce:	lda PICxlo,x	cmp #16	bcs @b1		lda #1	sta PICdir,x	lda #embryo_ball	jsr initanim@b1	lda PICxlo,x	cmp #256-16	bcc @b2		lda #0	sta PICdir,x	lda #embryo_ball	jsr initanim	@b2	lda PICylo,x	cmp #16	bcs @b3		lda #1	sta PICdirv,x	inc PIClogic,x	lda #embryo_ball	jsr initanim	@b3	lda PICylo,x	cmp #bottomembryo	bcc @b4		lda #0	sta PICdirv,x	lda #embryo_ball	jsr initanim	@b4	@bobcheck	;	lda PICcollide,x;	beq @bulletok		;	lda #drain1;	jsl drainstrengthl;	lda #14;	jmp explode	@bulletok	jsr setdir		rtl;=---------------------	@dropdown:		;embryo has been shot so burst bubble & drop	lda #22	sta PICstatus,x	jsr makebits	lda #embryo_squirm	jsr initanim	jsr animborg	lda #1	sta PIChealth,x		lda #2	sta PICscroll,x	;-------------------------	jsl TSKsuspend		lda #14	jsr shootenemy		inc PICtemp2,x	lda PICtemp2,x	jsl PICyadd		lda PICylo,x	cmp #bottomembryo+8		;hit bottom?	bcs @onground		bra @bobcheck	@onground:				;land at bottom of screen	jsr initdir	;	lda #10;	sta shakescreen		lda #bottomembryo+8	sta PICylo,x		lda #sfxbugsplat1	jsl soundeffects		jsl TSKsuspend		;start xmove		lda #14	jsr shootenemy		lda #6	jsr movetaskx	jsr animborg			bra @bobcheck	;-------------------------------------------------------	dropperballtask:				 ;happy fun ball droppers					;also known as rotten fruit						lda #ubank	sta PICbank,x		jsl PICput	dw jungf9			lda #1	sta PICcolor,x		lda #2	sta PICscroll,x		lda #3	sta PIChealth,x		stz PICsize,x		jsl TSKsuspend	;----------------------			lda #20	jsr shootenemy		lda PICtemp1,x	bne @drop	lda PICyhi,x	bne @movedropper		;must be offscreen		lda PICylo,x			;is dropper above or below bob?	cmp bobypos	bcs @movedropper		;must be below so stay put!	lda accelcount		;bob speed - if at #MAXACCEL then running	cmp #MAXACCEL	bne @walkingbob		lda #55	jsr bobzone	bcs @initdrop	bra @movedropper		@walkingbob	lda #5	jsr bobzone	bcc @movedropper@initdrop:	lda #sfxfruitdrop	jsl soundeffects		lda #30	sta PICshake,x@drop:			;drop the ball on bob	inc PICtemp1,x		lda PICtemp1,x		cmp #8	bcs @falling		lda TSKclock	eor PICxlo,x	and #7	sbc #4	sta PICmoveh,x		bra @stopmove	@falling:	dec PICtemp1,x		;prevent PICtemp1 from wrapping.		lda #0	ldy #8	jsl bgcoll_longer		lda chartype	cmp #solid	bne @fall2	@splatdropper:				;kill ball	lda #20	jmp explode	@fall2	lda PICtemp1,x	lsr a	sta PICmovev,x		lda PICtemp1,x	jsl PICyadd	@movedropper:@stopmove:	lda PICcollide,x	beq @missed		lda #drain1	jsl drainstrengthl	bra @splatdropper	@missed:	rtl*********************************************************************fheadspeed	equ	2mouthbosstask:fatheadtask:		;ancient spitter boss - version #3	stz babyflag		;tongue flag		stx bosstarget		lda #fatheadbank	sta PICbank,x		lda #type_enemy		;schedule right side of body	jsl TSKschedule	dw fatheadrighttask		lda #type_enemy		;schedule left side of body	jsl TSKschedule	dw fatheadlefttask	lda #4	sta PICcolor,x		lda #90	sta PIChealth,x		lda #37	sta PICsize,x		lda #128	ldy #39	jsl PICxyset		lda #-1	sta PICxhi,x		inc PICdir,x		lda #mouth_lwalk_m	jsr initanim		lda #3	sta PICcount2,x		;starting speed		stz bossflag1		;onscreen flag	;---------------------------------------------------			jsl TSKsuspend		jsr blinkenemy		lda PIChealth,x			lsr a	sta bossstrength		;display boss strength		lda PIChealth,x		;killed thing yet?	bne @livespitter		jmp @phase2@livespitter:	lda PIChealth,x	cmp #50	bcc @samespeed	cmp #30	bcc @freakout		lda #5	sta PICcount2,x	bra @samespeed	@freakout:	lda #8	sta PICcount2,x@samespeed:	lda PICstatus,x		;is mouth spitting or tongue?	cmp #mouth_open_m	beq @ssp1	cmp #mouth_spiteye_m		bne @moveboss		;no	@ssp1:	lda PICflag,x	bne @setmove		jmp @nomove	@setmove:	lda PICdir,x		;set left or right walk dir	asl a	clc	adc PICdir,x	clc	adc #mouth_lwalk_m		;walk again	jsr initanim	@moveboss:			;back and forth...	lda bossflag1		;move boss out to centre	bne @onscreen		stz PICtemp1,x		lda PICxhi,x	bne @justmovehim	lda PICxlo,x	bpl @justmovehim		inc bossflag1		;now at middle!	@onscreen:	inc PICtemp2,x	lda PICtemp2,x	and #64	beq	@notrack		;random turn arounds	; if near bob, drop tongue!	lda PICxlo,x	adc #10	cmp bobxpos	bcc @outrange		;too far		sbc #20	cmp bobxpos	bcs @outrange		; in range		lda #99	sta PICtemp1,x		;trigger the tongue!	stz PICtemp2,x	bra @draw			;also skip move cycle if attacking!	@outrange:;	bra @keepmoving;	;@reverse:;	lda PICdir,x			;change dir;	eor #1;	sta PICdir,x;	bra @notrack		;no chance of track here...	@keepmoving:	lda PICtemp2,x	and #31	bne @notrack		jsr initdir		;find bob!!!	bra @draw	@notrack:	lda PICxlo,x		;bounce off wallls	cmp #-40	bcc @okright		stz PICdir,x	@okright:	lda PICxlo,x	cmp #40	bcs @okleft		lda #1	sta PICdir,x	@okleft:@justmovehim:	lda PICcount2,x	jsr movetaskx			@draw:	@drop_eye:		inc PICtemp1,x		;drop eye counter;	lda PIChealth,x;	cmp #65;	bcc @embryo	lda babyflag	bne @embryo			;hey! you blew his tongue off!	@tongue:		;drip down tongue	lda PICtemp1,x	cmp #18	bcc @noroom		stz PICtemp1,x		lda	#type_enemy	jsl	TSKschedule			dw	tonguetask			;tongue drops from mouth	bcc	@noroom		jsl copytask		lda #sfxtounge	jsl soundeffects		lda #mouth_open_m	jsr initanim		;spitting animation	bra @noroom	@embryo:	lda PICtemp1,x	cmp #50	bcc @noroom		stz PICtemp1,x		lda #mouth_spiteye_m	jsr initanim		;spitting animation		lda #sfxtounge	jsl soundeffects	lda enemyblind	bne @noroom		lda	#type_enemy	jsl	TSKschedule			dw	embryotask			;eye spits from mouth	bcc	@noroom		jsl copytask	@noroom:@nomove:		jsr animeye		jsr setbosspos		rtl;-------------------- 2nd attack - jumping around@phase2:			;1st, "kill" 1st phase attacker		inc bosscount2		;tell tongue to die		lda #mouth_die_m	jsr initanim		stz PICtemp1,x@fall:				jsl TSKsuspend		;drop to 1st death		jsr animeye		inc PICtemp1,x		;accelerate to ground	lda PICtemp1,x	pha	jsl PICyadd	pla 	lsr a	sta PICmovev,x		jsr setbosspos		;save off ypos		lda PICylo,x	cmp #152	bcc @fall;---------------------		lda #30	sta shakescreen		;kaboom - hit bottom		lda #sfxexplode2	jsl soundeffects		lda #mouth_die2_m	;hurt frame	jsr initanim	jsr animeye		stz PICtype,x		;pause at bottom		lda #90	jsl TSKwait		lda #60				;starts to  wake up	sta PICshake,x		lda #3	ldy #32	jsl makepowerup2	lda #5	ldy #-32	jsl makepowerup2			lda #30	jsl TSKwait	lda #90	sta PIChealth,x		lda #mouth_wake_m		;wakes up	jsr initanim		lda #type_enemy	sta PICtype,x		jsl TSKsuspend		jsr animeye		lda PICflag,x	bne @upagain		;ready for 2nd attacks?		rtl	@upagain:	stz PICtemp1,x		;now jump around screen		lda #mouth_jump_m	jsr initanim		jsl TSKsuspend		lda PICstatus,x		;in midst of landing?	cmp #mouth_land_m	beq @waitlanding		lda PICanim,x	cmp #5	bcs @jumpering		jmp @keeplanding	@jumpering:	lda PICtemp1,x			;now can jump - in proper frame	tay	lda ancbossjump,y	cmp #128	beq @landing	cmp #127	beq @fireeyes		jsl PICyadd		inc PICtemp1,x		lda #2	jsr movetaskx		lda PICxlo,x		;bounce off wallls	cmp #-40	bcs @reverse2	cmp #40	bcs @keepmoving2			@reverse2:	lda PICdir,x			;change dir	eor #1	sta PICdir,x	@keepmoving2:	bra @keeplanding	@fireeyes:	lda #16	jsl PICysub	lda #12	jsl PICxsub		lda #0	jsr fatheadbullet		lda #24	jsl PICxadd		lda #1	jsr fatheadbullet		inc PICtemp1,x		lda #12	jsl PICxsub	lda #16	jsl PICyadd		bra @keeplanding	@landing:	lda #mouth_land_m	jsr initanim		lda #20	sta shakescreen		lda #sfxexplode1	jsl soundeffects		bra @keeplanding	@waitlanding:	lda PICflag,x	beq @keeplanding	lda #mouth_jump_m	jsr initanim	stz PICtemp1,x		lda #sfxbows	jsl soundeffects	@keeplanding:	jsr setbosspos	jsr animeye			jsr blinkenemy		lda PIChealth,x			lsr a	sta bossstrength		;display boss strength		lda PIChealth,x		;killed thing yet?	beq @finaldeath		rtl	@finaldeath:	stz PICtemp1,x		;now fall off to death...		lda #mouth_die2_m	;hurt frame	jsr initanim	jsr animeye		jsl TSKsuspend		lda PICtemp1,x			;now can jump - in proper frame	tay	lda ancbossdietable,y	cmp #6	beq @maxdie			inc PICtemp1,x	@maxdie:	jsl PICyadd	lda #1	jsr movetaskx	lda PICyhi,x	bmi @offtop		lda PICylo,x	cmp #190	bcs @kaboom	@offtop:	inc PICcount2,x	lda PICcount2,x	and #7	bne @nosplats		lda #22	sta bossexplodetype	lda #type_enemy	jsl TSKschedule	dw blasttask	bcc @nosplats		jsl copytask	@nosplats:	jsr animeye		jsr setbosspos	rtl	@kaboom:	jsr setbosspos	inc bossflag2			;tell legs to blow off	lda #100	sta winflag	lda #maxstrength	sta strength		lda #30	sta shakescreen		lda #sfxbugsplat2	jsl soundeffects		jsr score15000		lda #14		;boom sound with death!!!!!	jmp explode		;-----------------------------------ancbossjump:		;table of jump y values	dc.b	-10,-10	dc.b	-10,-10,-10,-10,-10,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1	dc.b	0,0,127,0,0,0	dc.b	0,0,1,2,3,4,5,6,7,8,9,10,10,10,10,10,10,10,10	dc.b	128		;eof		ancbossdietable:		;table of death y values	dc.b	-6,-6,-6,-6,-6,-5,-5,-5,-4,-4,-4,-3,-3,-3,-2,-2,-2	dc.b	-1,-1,-1,-1	dc.b	0,0,0,0,0,0,0,0	dc.b	1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6	;------------------------------------	animeye:		;special eye spitter animation routine	lda PICstatus,x	sta bossstatus	lda PICanim,x	sta bossanim	lda PICcount,x	sta bosscount	lda PICflag,x	sta bossPICflag		jsr animborg	rts;---------------------------------------------------------------fatheadrighttask:	;right side of fathead task	lda #fatheadbank	sta PICbank,x		jsl PICxflip		jsl TSKsuspend		lda #0	tay	jsr getbosspos		lda bossstatus	clc	adc #2	sta PICstatus,x		lda bossanim	sta PICanim,x		lda bosscount	sta PICcount,x		lda bossPICflag	sta PICflag,x		jsr animborg		lda bossflag2		;kill parts with head	beq @alive		lda #22	jmp explode	@alive:	rtl		;----------------------------------------------------------------fatheadlefttask:	;left side of fathead task	lda #fatheadbank	sta PICbank,x	;---------------------------		jsl TSKsuspend		lda #0	tay	jsr getbosspos		lda bossstatus	clc	adc #1	sta PICstatus,x		lda bossanim	sta PICanim,x		lda bosscount	sta PICcount,x		lda bossPICflag	sta PICflag,x		jsr animborg		lda bossflag2		;kill parts with head	beq @alive		lda #22	jmp explode	@alive:	rtl;-------------------------------------------------------------	fatheadbullet:		;special ancient boss bullets	sta tmp		lda PICdir,x	pha		lda tmp	sta PICdir,x	;	ldx #15;	lda #3;	ldy #12;	jsr fire_bullet		ldx #15	lda #1	ldy #8	jsr fire_bullet	pla	sta PICdir,x	rts	;----------------------------------------------------------------tonguetask:		;tongue part from mouth boss		stz PICtype,x			lda #5	sta PIChealth,x		lda #fatheadbank	sta PICbank,x		lda #0	ldy #48+16	jsr getbosspos		lda #9	jsl TSKwait		lda bosscount2	bne @notongue		;eliminate tongue if/when boss falls		inc bosscount3		;drop a spitball?	lda bosscount3	cmp #2	bcc @nospitball		;should boss drop spit?		stz bosscount3		lda #type_enemy	jsl TSKschedule	dw spitball			;drop some spit, mofo!	bcc @nospitball		jsl copytask	@nospitball:	jsl PICput	dw mouthf5		lda #type_enemy	sta PICtype,x;--------------------	jsl TSKsuspend		lda bosscount2	bne @bossdead		;eliminate tongue if/when boss falls	lda #42	sta PICsize,x		;long tongue		inc PICcount,x	lda PICcount,x	cmp #8	bcc @safe	@notongue:	jsl TSKcancel	rtl	@safe:		lda PICcollide,x	beq @nocollide		lda #1	jsl justdrainstrengthl	@nocollide:	lda PIChealth,x		;tongue ben shot off?	bne @alive		inc babyflag		;tongue blown off!!!!	@bossdead:	lda #22	jmp explode	@alive:	jsr blinkenemy		rtl;--------------------------------------------------------------spitball:		;spitball from motuh boss		lda #fatheadbank	sta PICbank,x		lda #mouth_spitball	jsr initanim			lda #1	sta PICsize,x			;16x32		inc PICprior,x		lda #30	jsl PICyadd		lda #5	sta PICcolor,x		stz PICtemp2,x		jsl TSKsuspend		jsr animborg	jsr animborg		lda PICflag,x		;wait till fully formed to fall...	beq @nofalling		lda #4	jsl PICyadd		lda PICylo,x	cmp #164	bcs @splat			;hit bottom	@nofalling:	rtl@splat:	lda #178	sta PICylo,x		lda #mouth_spitball2			jsr initanim		lda #11	sta PICsize,x		jsl TSKsuspend		jsr animborg		lda PICflag,x	bne @done		rtl	@done:	jsl TSKcancel	rtl	;--------------------------------------------------------------planetspeed	equ	6planettask:			;piclogic holds planet type		lda #28	sta sdmaflag			;stat dma	stz sdmacount		lda #29			;test size???	sta PICsize,x		lda #3	sta PICscroll,x		lda TSKclock			;random xflip	and #1	sta PICdir,x	jsr setdir	jsr initdir				;always attack bob			lda #3	sta PIChealth,x					lda PIClogic,x	tay	lda planetshape,y	jsr initanim			;random planet shape	lda PIClogic,x	clc	adc #1	sta PICcolor,x		lda #abank	sta PICbank,x		jsr animborg		lda #sfxscreamhand	jsl soundeffects	;-----------------		jsl	TSKsuspend	jsr animborg		lda #4	jsr shootenemy		ldy	PICdir,x	bne	@rightfire@leftfire:		lda #planetspeed	jsl	PICxsub	lda #-planetspeed/2	sta PICmoveh,x	bra @movey	@rightfire:		lda #planetspeed	jsl	PICxadd	lda #planetspeed/2	sta PICmoveh,x	@movey:	;	lda PIChit,x;	beq @bulletok		;	lda #drain1;	jsl drainstrengthl	;	lda #6;	jmp explode	@bulletok	rtl		planetshape:	dc.b	planet1	dc.b	planet2	dc.b	planet3	*************************************************************************		jumping fish in ultra force**fishtask:	lda PIClogic,x			;piclogic holds start direction	sta PICdir,x	stz PIClogic,x		lda #ufbank	sta PICbank,x	lda #1				;set to tiny size	sta PICsize,x		lda #2	sta PICscroll,x		lda #3	sta PIChealth,x		lda #4	sta PICcolor,x		jsl PICput	dw bodyf29		;1/2 fish in stuff	;-----------------	jsl TSKsuspend				lda #16	jsr shootenemy		;time to leap out of water?		lda PIClogic,x	beq @nojump	@jumping:	jsr animborg		lda PIClogic,x	inc PIClogic,x	tay	lda fishymove,y	cmp #128	bne @movey		stz PIClogic,x	lda PICdir,x	eor #1	sta PICdir,x			;reverse dir for next jump		lda #16	jsl PICyadd		jsl PICput	dw bodyf29		;1/2 fish in stuff		bra @nojump	@movey	jsl PICyadd		lda PICdir,x			;also move x according to dir	beq @left	@right:	lda #3	jsl PICxadd	bra @draw	@left:	lda #3	jsl PICxsub@draw:				;always exits here	jsr setdir2;	jsr animborg	rtl@nojump:			;make fish swim back and forth	lda PICtemp1,x	inc PICtemp1,x	tay	lda fishxmove,y	cmp #128	bne @movex		stz PICtemp1,x	inc PICtemp2,x	lda PICtemp2,x	cmp #2	bcc @draw		stz PICtemp2,x	inc PIClogic,x		;make fish jump out of water		lda #fish		;fish swimming anim	jsr initanim	lda #sfxfishjump	jsl soundeffects		bra @draw	@movex	jsl PICxadd	bra @draw			fishymove:			;jump		dc.b	0,-16,-12,-12,-11,-10,-9,-8,-7,-6,-4,-2,-1	dc.b	0,0,0,0,0,0,0	dc.b	1,2,4,6,7,8,9,10,11,12,12	dc.b	128	fishxmove:			;swimming back and forth	dc.b	8,6,4,2,1,0	dc.b	-1,-2,-4,-6,-8,-6,-4,-2,-1	dc.b	0,1,2,4,6		dc.b	128*********************************************************************random:	inc random1		sta tmp	phy		and #15	tay	lda randomnum,y	eor tmp	adc TSKclock	eor random1	@reduce	cmp tmp	bcc @ok		lsr a	bra @reduce	@ok:	ply	rtsrandomnum	dc.b	1,200,55,87,240,15,39,8,46,92,197,166,109,210	dc.b	23,139;-------------------------------------------------------------bossburst:	lda #2				;splats	sta bossexplodetype		bra booobolia	bossexplode:		;drop a bunch of explosions	lda #0	sta bossexplodetype	bra boooboliabossexplode2:		;drop a bunch of preset-type explosionsbooobolia:	stz PICcount2,x	@loop	lda PICcount2,x	inc PICcount2,x	cmp #15	bcs @end		tay	phy	lda blastxoff,y	jsl PICxadd		ply	lda blastyoff,y	jsl PICyadd		lda #type_enemy	jsl TSKschedule	dw blasttask	bcc @none		jsl copytask2	@none	lda #6	jsl TSKwait	jmp @loop	@end	jsl TSKcancel	rtl	blastxoff:	dc.b 32,-64,16,16,32,-16,-16,-32,16,32,16,16,-48,-16,32,16,16	blastyoff:	dc.b 8,4,-12,-24,48,-16,-16,-16,16,24,-24,32,-64,16,16,-24	blasttask:	lda #20	sta shakescreen		lda bossexplodetype	jmp explode		;--------------------------------------------------------------minetask:			;floating mine task	lda #1	sta PIChealth,x		lda #2	sta PICscroll,x		lda #1	sta PICsize,x		jsl PICput	dw	borg1f34			;borg mine frame	lda #4	ldy #1	sta PICbank,x	tya	sta PICcolor,x		lda #8	sta PICcount,x	;-----------------	jsl TSKsuspend				;	lda #sfxairmine;	jsl	soundeffects	lda #0	jsr shootenemy		lda PICcollide,x	beq @mineok			lda #drain1	jsl drainstrengthl	;	lda #type_enemy;	jsl TSKschedule;	dw initmaptask		lda #0			;borg explode	jmp explode@mineok	lda PICtemp1,x	inc PICtemp1,x	tay	lda missileymove,y	cmp #128	bne @movey		stz PICtemp1,x	bra @mineok	@movey	jsl PICyadd@xfloat:	lda PICcount,x	inc PICcount,x	tay	lda missileymove,y	cmp #128	bne @movex		stz PICcount,x	bra @xfloat	@movex	jsl PICxadd		rtl	;--------------------------------------------------------------pussminetask:				lda #3	sta PIChealth,x		lda #2	sta PICscroll,x		lda #24	sta PICsize,x		lda #pussmineburst	jsr initanim	jsr animborg		lda #ufbank	sta PICbank,x		lda #2	sta PICcolor,x	;-----------------	jsl TSKsuspend					lda PIChealth,x	beq @burstit		lda enemydie	beq @mineok	@burstit:; bust mine	lda #4	ldy #-4	ldx #13	jsr fire_bullet	inc PICdir,x	lda #4	ldy #-4	ldx #13	jsr fire_bullet	lda #4	ldy #4	ldx #13	jsr fire_bullet	stz PICdir,x	lda #4	ldy #4	ldx #13	jsr fire_bullet		lda #21	jmp explode	@mineok:		jsr blinkenemy		lda enemyblind	beq @nostun		rtl	@nostun:	lda PICcollide,x	beq @notouch			lda #drain1			;bob must have collided with mine	jsl drainstrengthl		jmp @burstit	@notouch:	jsr animborg	jsr floattask	lda PICtemp1,x	inc PICtemp1,x	tay	lda pussmineymove,y	cmp #128	bne @movey		stz PICtemp1,x	bra @mineok	@movey	jsl PICyadd@xfloat:	lda PICtemp2,x	inc PICtemp2,x	tay	lda pussminexmove,y	cmp #128	bne @movex		stz PICtemp2,x	bra @xfloat	@movex	jsl PICxadd	rtl	pussmineymove:	dc.b	5,6,5,4,3,2,1,1,0,0,0	dc.b	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0	dc.b	-1,-1,-2,-3,-4,-5,-6,-5,-4,-3,-2,-1,-1	dc.b	0,0,0	dc.b	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0	dc.b	1,1,2,3,4,128	pussminexmove:	dc.b	5,4,3,2,1,1,0,0	dc.b	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0	dc.b	-1,-1,-2,-3,-4,-5,-4,-3,-2,-1,-1	dc.b	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0	dc.b	0,0,1,1,2,3,4,128;--------------------------------------------------------------gasjettask:			;gas jets in borg level pipes	lda PIClogic,x	asl a	asl a	asl a	tay	lda gasjetdata,y	sta PICdir,x	lda gasjetdata+1,y	sta PICdirv,x	lda gasjetdata+2,y	sta PICsize,x		;set size too	lda gasjetdata+3,y	sta PICstatus,x	lda gasjetdata+4,y	pha	lda gasjetdata+5,y	jsl PICyadd			;y off	pla	jsl PICxadd			;xoff		jsr setdir	jsr setdirv		lda PIClogic,x	cmp #4	bcc @setgas			;0-3 = gas, 4-5 = nerve pulse		lda #ufbank			ldy #7	bra @setpicbank	;nerve	@setgas:	lda #19				;gas	ldy #6@setpicbank	sta PICbank,x	tya	sta PICcolor,x		lda #2	sta PICscroll,x	;----------------	lda TSKclock	sta PICtemp2,x	@mainjet:	jsl TSKsuspend				lda enemyblind	beq @on		stz PICadrlo,x	stz PICadrhi,x	rtl	@on:	inc PICtemp2,x	lda PICtemp2,x	and #7	beq @gas		rtl	@gas:	lda PICstatus,x	jsr initanim		lda #type_enemy	sta PICtype,x		lda PIClogic,x	cmp #4	bcc @gassfx			;0-3 = gas, 4-5 = nerve pulse@nervesfx:	lda #sfxnervepulse	bra @sfx	@gassfx:	lda #sfxgasjet	@sfx:	jsl	soundeffects	jsl TSKsuspend	lda enemyblind	bne @mainjet	jsr animborg	jsr animborg		lda PICflag,x			;is anim over?	bne @endtask		rtl	@endtask		stz PICtype,x		;turn off collisions	stz PICadrlo,x	stz PICadrhi,x		lda #25	jsl TSKwait		jmp @gas	gasjetdata:		;hdir, vdir, PICsize, anim	dc.b	1,1,34,gasjetside,32,0,0,0	dc.b	1,1,35,gasjetvert,0,32,0,0	dc.b	0,1,34,gasjetside,-32,0,0,0	dc.b	1,0,35,gasjetvert,0,-32,0,0		dc.b	0,0,34,nervezapside,0,0,0,0	dc.b	0,0,35,nervezapvert,0,0,0,0;---------------------------------------------------------------bowtask:		;shooting bows on ancient level	lda #3	sta PIChealth,x		lda #2	sta PICscroll,x		lda #3	sta PICsize,x		lda #4	sta PICcolor,x		lda #19	sta PICbank,x	jsl PICput	dw bowf0		;bow with arrow loaded	jsr initdir	jsr setdir;------------------------------------------	jsl TSKsuspend	lda #4	jsr shootenemy		jsr initdir	jsr setdir		inc PICcount2,x	lda PICcount2,x	cmp #10	bcc @justshot	cmp #38	bcc @waitshot			;wait for counter		stz PICcount2,x		lda PICxhi,x	ora PICyhi,x	bne @waitshot		;must be offscreen		lda #type_enemy	jsl TSKschedule	dw arrowtask	bcc @notasks			;no room?		jsl copytask2		lda #sfxbows	jsl soundeffects@notasks:@waitshot:	jsl PICput	dw bowf0		;bow with arrow loaded	rtl@justshot:			;bow without arrow	jsl PICput	dw bowf1		;bow with arrow loaded	rtl;---------------------------------------------------------arrowtask:				;arrow fired by bow	lda #4	sta PICtemp1,x	;;	lda #type_badbullet;	sta PICtype,x		lda #1	sta PICscroll,x	sta PIChealth,x		lda #4	sta PICcolor,x		lda #19	sta PICbank,x		jsl	TSKsuspend;----------------------------	lda #4	jsr shootenemy		lda PICtemp2,x	inc PICtemp2,x	tay	lda arrowymove,y	cmp #8	bne @movearrow		;max velocity?		dec PICtemp2,x	lda #2	sta PICscroll,x	lda #4	sta PICmovev,x	lda #8@movearrow:	jsl PICyadd	@no_float	lda PICtemp1,x	jsr movetaskx	@flyaway:	lda PICcollide,x		;hit,x	beq @notnear		lda #drain1	jsl drainstrengthl		lda #4			;nukeout	jmp explode	@notnear:	lda PICtemp2,x			;anim counter too!	cmp #6	bcc @f1	cmp #12	bcc @f2	cmp #18	bcc @f3	@f1:				;45 up/down	jsl PICput	dw bowf2	rtl		@f3:	jsl PICyflip	;/22 down	@f2:				;22 up	jsl PICput	dw bowf3	rtl		arrowymove:	dc.b	-8,-8,-8,-7,-7,-6,-6,-5,-4,-3,-2,-1,0,0	dc.b	0,1,0,1,1,2,3,4,5,6,6,7,7,8	*********************************************************************goldballtask:		;ancient level gold ball tasks					;logic 0 = normal gravity effect										;logic 1 = reverse gravity						lda #2	sta PICscroll,x	;------------------------------------		stz PICtype,x		;make sure generator doesn't hurt bobola		jsl TSKsuspend					lda enemyblind	bne @notasks		;stunned		inc PICcount2,x	lda PICcount2,x	cmp #50	bcc @nofire		stz PICcount2,x			lda #type_enemy	jsl TSKschedule	dw goldballtask2	bcc @notasks			;no room?		jsl copytask2	@notasks:@nofire:	rtl	;-----------------------------------------------------------goldballtask2:		lda PIClogic,x	beq @notinverted		lda #goldballdownmove-goldballupmove	sta PICtemp2,x	@notinverted		stz PICcolor,x		lda #1	sta PICscroll,x		lda #19		;abank	sta PICbank,x		jsl PICput	dw bowf6			;gold ball frame	lda #1	sta PICsize,x		lda #1	sta PIChealth,x		lda #sfxgoldball	jsl soundeffects		jsl	TSKsuspend;----------------------------	lda #4	jsr shootenemy		lda PICtemp2,x	inc PICtemp2,x	tay	lda goldballupmove,y	cmp #128	beq @killball		jsl PICyadd		lda PICcollide,x	beq @notnear		lda #drain1	jsl drainstrengthl		lda #4				;nuke explode	jmp explode	@notnear:	lda #2	jsr movetaskx		rtl		;---------@killball:	stz PICtemp2,x		lda PICdir,x	eor #1	sta PICdir,x	bne goldballtask2			;go back to left	;must have finished loop so kill it	lda #sfxgoldball	jsl soundeffects	jsl TSKcancel	@yoyo	rtl	goldballupmove:	dc.b	-8,-8,-8,-7,-7,-6,-6,-5,-4,-3,-2,-1,-1,0,-1,0,0,0	dc.b	1,0,1,1,2,3,4,5,6,6,7,7,8,8,8	dc.b	128goldballdownmove:	dc.b	8,8,8,7,7,6,6,5,4,3,2,1,1,0,1,0,0,0	dc.b	-1,0,-1,-1,-2,-3,-4,-5,-6,-6,-7,-7,-8,-8,-8	dc.b	128;---------------------------------------------------------;---------------------------------------------------------shadowmantask:			 ;OOOOOOOOOHHHHH... IT'S SHADOW MAN!					;OK... THIS IS SCARY STUFF, BOYS AND GIRLS!	lda #abank	sta PICbank,x		lda #6	sta PICcolor,x		lda #1	sta PICscroll,x		lda #1	sta PIChealth,x		stz PICtype,x		jsl TSKsuspend	;-------------------------------------	lda enemyblind	bne @freeze	lda #90			;wait for bob to come along...	jsr bobzone	bcs @makeappear	@freeze:	rtl	@makeappear:		;now shadowman emerges! ;wait till last possible moment to start DMA transfer	lda #30	sta sdmaflag			;start dma	stz sdmacount		lda #4	jsl TSKwait		jsr initdir	jsr setdir		lda #shadow_emerge	jsr initanim	jsr animborg		lda #sfxshadowman	jsl soundeffects	lda #1	sta PICsize,x	lda #type_enemy	sta PICtype,x	jsl TSKsuspend;--------------	lda #4	jsr shootenemy	jsr animborg		lda PICflag,x	bne @shadow_fly		;he's baaaaaaack!		rtl	@shadow_fly:	lda #shadow_fly	jsr initanim		lda #3	sta PICsize,x		jsl TSKsuspend;--------------	lda #4	jsr shootenemy		jsr animborg		jsr initdir	jsr setdir		lda PICtemp1,x	inc PICtemp1,x	tay	lda shadowymove,y	cmp #128	beq @vanish		jsl PICyadd	lda PICtemp2,x	inc PICtemp2,x	tay	lda shadowxmove,y	jsl PICxadd		rtl	@vanish:		;now shadowman fucks off! 	lda #shadow_vanish	jsr initanim	lda #sfxshadowman	jsl soundeffects		jsl TSKsuspend	lda #4	jsr shootenemy	jsr animborg		lda PICflag,x	bne @shadow_end		;he's gooooone!		rtl@shadow_end:	jsl TSKcancel	rtl	shadowymove:	dc.b	0,0,0,0,0,0,0,0,0,0			dc.b	0,0,0,0,0,0,0,0	dc.b	9,8,7,6,4,2,1,0	dc.b	0,-1,-2,-4,-6,-7,-8,-9,-9,-8,-7	dc.b	-6,-4,-2,-1,0	dc.b	1,2,4,6,7,8,9	dc.b	0,0,0,0,0,0,0,0	dc.b	128shadowxmove:	dc.b	0,0,0,0,0,0,0,0,0,0	dc.b	2,4,6,8,8,6,4,2	dc.b	0,-2,-4,-6,-7,-7,-7,-7,-7,-7,-7,-7	dc.b	-6,-4,-2,0	dc.b	2,4,6,7,7,7,7,7,7,7,7	dc.b	6,4,2,0	dc.b	-2,-4,-6,-8,-8,-6,-4,-2;---------------------------------------------------makebits:				;make splats		jsr gensplat			;1st 		lda PICstatus,x		;big or small?	and #1	bne gensplat		jsr gensplat		;3 for big one!gensplat:	lda #type_enemy	jsl TSKschedule	dw straysplat	bcc @nosplat2		jsl copytask2	@nosplat2:	rts;---------------------------------------------------------	straysplat:		;generate a random stray splat	cpx #10			;to many tasks?	bcc @allowed		txa	and #1	bne @allowed			;1 in 2 die!		jsl TSKcancel	rtl	@allowed:	inc PICprior,x		stz PICtype,x		;make splat ball harmless	stz PICcount2,x		lda PICstatus,x	tay	lda explodecolor,y	sta	PICcolor,x		;brief change of enemy to explode colors		lda #2	sta PICscroll,x	sta PICprior,x		;make appear in front of bob		inc splatcounter	;keep changing splat dir's		lda splatcounter	and #7	tay	lda startsplatcount,y		;0-7	sta PICcount2,x	lda startsplatdir,y				sta PICdir,x		lda PICstatus,x	cmp #22	beq @bosssplat	cmp #14			;is this the special boss shrapnel?	bne @normalshrap	@bosssplat:	lda #19			; bank 	sta PICbank,x	lda #bossshrapnel	bra @initshrap	@normalshrap:	lda #7		;this bank - frames below	sta PICbank,x	lda #shrapnel@initshrap:	jsr initanim	;-------------------------------		jsl TSKsuspend	jsr animborg	lda PICcount2,x	inc PICcount2,x	tay	lda bitymove,y	cmp #16	bne @movebit		;max velocity?		dec PICcount2,x		lda #8	sta PICmovev,x	lda #16@movebit:	jsl PICyadd	lda PICdir,x	jsl PICxadd	;	lda #64;	sta PICmoveh,x;	lda #-16;	sta PICmovev,x		rtl	shrapnelf0:			;shrapnel pieces	dc.b	1 	dc.b $00,$D0,$E0shrapnelf1:	dc.b	1 	dc.b $00,$D0,$E2shrapnelf2:	dc.b	1 	dc.b $00,$D0,$E4shrapnelf3:	dc.b	1 	dc.b $00,$D0,$E6 startsplatcount:	dc.b	4,3,2,1,0,1,2,3	startsplatdir:	dc.b	-4,-3,-2,-1,0,1,2,3	bitymove:	dc.b -10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0	dc.b 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16;---------------------------------------------------------------donutswarmsize		equ	5		;number of donuts to makedonuttask:			;flying ultra force donut thing	lda walkdir	bne @rightside	@leftside:	lda #-32	sta PICxlo,x	lda #-1	sta PICxhi,x	bra @setside	@rightside:	lda #32	sta PICxlo,x	lda #1	sta PICxhi,x	@setside:	lda #90	sta PICylo,x	lda #0	sta PICyhi,x	@makedonut:	jsl TSKsuspend		lda #type_enemy	jsl TSKschedule	dw subdonuttask	bcc @notask		jsl copytask2	lda PICvomit,x	sta PICvomit,y		inc PICvomit,x	inc PICvomit,x		lda #4				;move next one over	jsl PICxadd	lda #2	jsl PICyadd		inc PICtemp1,x		;max number of nuts?	lda PICtemp1,x	cmp #donutswarmsize	bcc @makedonut		lda #175			;keep another swarm from triggering	jsl TSKwait		jsl TSKcancel			;end of swarm	@notask:		rtl	;-------------------------------------------------------subdonuttask:	lda donutswarm	sta PICthingy,x		lda #ubank	sta PICbank,x		lda #2	sta PIChealth,x	sta PICsize,x			lda #1	sta PICscroll,x		lda #4	sta PICcolor,x		lda #donut	jsr initanim	jsr animborg		lda #8	sta PICcount,x		stz PICtemp1,x		lda PIClogic,x		;start at different point in loop	asl a	asl a	asl a	sta PICed,x		stz PIClogic,x		lda #30	sta PICshake,x		jsl TSKsuspend	;-------------------------	lda #1	sta PICscroll,x		lda #20	jsr shootenemy		jsr animborg				inc PICcount2,x		lda PICcount2,x	cmp PICvomit,x	bcs @appear	@offscreen:	rtl@appear:	lda #sfxtreeturret	jsl soundeffects	;-----------------		jsl TSKsuspend					lda #20	jsr shootenemy		jsr animborg					jsr floattask		lda PICed,x			;wait to start moving...	beq @movenut		dec PICed,x	rtl	@movenut:	inc PICtemp1,x			;time to change flight path?	lda PICtemp1,x	and #3	bne @samedir		lda PICthingy,x		;swarm move table offset (0,16,32...)	and #3			;4 diff. path types...	asl a	asl a	asl a	asl a	sta tmp			;this is offset		inc PICtemp2,x		;loop every 16 moves	lda PICtemp2,x	and #15	pha	cmp #15	bne @firstmove		lda #sfxtreeturret	;donutattack		;sfxtreeturret is better	jsl soundeffects	lda #3	sta PICscroll,x		;make donut go away now if offscreen	@firstmove:	pla	clc	adc tmp		;swarm offset	asl a	tay	lda donutdir,y	sta PICdir,x		;new xdir	lda donutdir+1,y	sta PICdirv,x		;new ydir	@samedir:	lda PICdirv,x		;move based on h & v dir	jsl PICyadd	lda PICdir,x	jsl PICxadd		rtlsd	equ	4		;donutspeeddonutdir:	; down on angle then loop		dc.b	-sd,sd			;x,y velocity	dc.b	-sd,sd			;x,y velocity	dc.b	-sd,sd/2		;x,y velocity	dc.b	-sd,sd/4	 	;x,y velocity	dc.b	-sd,0			;x,y velocity	dc.b	-sd,0			;x,y velocity	dc.b	-sd,0			;x,y velocity	dc.b	-sd,0			;x,y velocity	dc.b	-sd,0			;x,y velocity	dc.b	-sd*2,-sd*2	dc.b	0,-sd*2	dc.b	sd*2,-sd*2	dc.b	sd*2,0	dc.b	sd*2,sd*2	dc.b	0,sd*2	dc.b	-sd*2,sd*2		; sine wave		dc.b	0,sd*2			;x,y velocity	dc.b	0,sd*2			;x,y velocity	dc.b	0,sd*2	dc.b	0,sd	dc.b	-sd,sd/2	dc.b	-sd,0	dc.b	-sd,-sd/2	dc.b	0,-sd	dc.b	0,-sd*2	dc.b	0,-sd*2	dc.b	0,-sd*2	dc.b	0,-sd	dc.b	-sd,-sd/2	dc.b	-sd,0	dc.b	-sd,sd/2	dc.b	0,sd		;top to bottom sideways sine wave		dc.b	-sd,sd/2	dc.b	-sd*2,0	dc.b	-sd*3,0	dc.b	-sd*3,0	dc.b	-sd*3,0	dc.b	-sd*2,0	dc.b	-sd,sd/2	dc.b	0,sd	dc.b	sd,sd/2	dc.b	sd*2,0	dc.b	sd*3,0	dc.b	sd*3,0	dc.b	sd*3,0	dc.b	sd*2,0	dc.b	sd,sd/2	dc.b	0,sd		;	curve		dc.b	-sd,sd	dc.b	-sd,0	dc.b	-sd*2,0	dc.b	-sd,0	dc.b	-sd,-sd	dc.b	0,-sd	dc.b	0,-sd*2	dc.b	0,-sd	dc.b	sd,-sd	dc.b	sd,0	dc.b	sd*2,0	dc.b	sd,0	dc.b	sd,sd	dc.b	0,sd	dc.b	0,sd*2	dc.b	0,sd				;--------------------------------------------------------------venustask:			;venus fly trap	lda #ubank	sta PICbank,x		lda #8	sta PIChealth,x		lda #2	sta PICscroll,x		lda #36	sta PICsize,x		lda #4	sta PICcolor,x		jsl PICput			;just sit there...	dw venusf11	;-----------------	jsl TSKsuspend					lda #20	jsr shootenemy		jsr initdir	jsr setdir2		lda PICstatus,x		;in attack mode?	beq @try_to_attack		;no		jsr animborg		lda PICflag,x	beq @stilleating		;done yet?		stz PICstatus,x		;reset attack flag	@stilleating:	lda PICanim,x	cmp #5	bne @nosound		lda #sfxvenuschomp		;venus eat sound	jsl soundeffects	@nosound:	rtl@try_to_attack:		;look for bob	lda #32	jsr bobzone	bcc @noattack		; in range?		lda PICyhi,x	bne @noattack		lda PICylo,x	cmp bobypos	bcc @noattack		lda #venusattack	;set attack in motion	jsr initanim		rtl	@noattack:	inc PICtemp1,x	lda PICtemp1,x	and #7+16+32	bne @nofire		lda #venus_shoot	jsr initanim		lda #4	ldy #0	ldx #12	jsr fire_bullet		rtl	@nofire:	jsl PICput	dw venusf11		rtl		;--------------------------------------------------------------shroomtaskfinal:	inc PIClogic,x			;tell shroom to die this time	shroomtask:			;exploding mushroom	lda #2	sta PICscroll,x		lda PICxhi,x	beq @start		rtl	@start:	lda #ubank	sta PICbank,x		lda #5	sta PIChealth,x		lda #1	sta PICcolor,x		lda #shroom	jsr initanim		lda TSKclock	and #3	sta PICanim,x	jsr animborg	;-----------------	jsl TSKsuspend					lda #17	jsr shootenemy			jsr animborg		lda PICcollide,x	beq @shroomok		lda #5				;hit shroom, so pop it.	jsl drainstrengthl	bra shroomexplodetask	@shroomok:	lda PICanim,x	cmp #18	bcc @samesize		lda #3	sta PICsize,x			;max size now...	@samesize:	lda PICflag,x			;shroom fully expanded?	beq @notgrown		; now blow up shroom ;;	lda PIClogic,x;;	bne @notgrown			;this is phase2. just let it sit there.		stz PICdir,x	jsr makespore		;left spore	lda #1	sta PICdir,x	jsr makespore		;right spore			lda #type_enemy		;blow up but leave trigger behind!	jsl TSKschedule	dw shroomexplodetask	bcc @noroom	jsl copytask	@noroom:	jsl TSKcancel	rtl	@notgrown:	rtl	makespore:	lda #type_enemy	jsl TSKschedule	dw shroomspore	bcc @nosplat2		jsl copytask2	@nosplat2:	rts	;---------------------------shroomexplodetask:		;special - don't kill seed shroom!	lda #17	jmp explode	;--------------------------------------------------------------shroomspore:		;spore that flies out of shroom			; create move xpos	inc shroomcount	lda shroomcount	and #7	tay	lda shroomdir,y	sta PICthingy,x		;x speed		stz PICtemp2,x		lda #1	sta PICscroll,x		lda #6	sta PICcolor,x		lda #ubank	sta PICbank,x		jsl PICput	dw mushf0			;spore frame	;----------------------------	jsl	TSKsuspend	lda PICtemp2,x	inc PICtemp2,x	tay	lda sporeymove,y	bmi @moveball		;not at max velocity		cmp #8	bne @atmax			dec PICtemp2,x		;at max	lda #2	sta PICscroll,x	lda #8	@atmax:	sta PICtether,x		lda #0	ldy #16	jsl bgcoll_longer			;look below for floor		lda chartype	cmp #solid	bne @movespore				;make a new shroom?		lda PIClogic,x		;if this is a 2nd generation spore, end it	bne @endspore		jmp shroomtaskfinal			;make a phase2 shroom	@movespore:	lda PICtether,x@moveball:	jsl PICyadd	@no_float	lda PICdir,x			;stop at walls?	bne @rightw		lda #-4	bra @wallc	@rightw:	lda #4	@wallc:	ldy #16	jsl bgcoll_longer			;look sideways for walls		lda chartype	cmp #solid	bne @movespore2		;stop on side?		lda PICdir,x	eor #1	sta PICdir,x	@movespore2:	lda PICthingy,x	jsr movetaskx	@flyaway:	lda PICcollide,x		;spore touch bob?	beq @notnear		lda #drain1	jsl drainstrengthl	@endspore:	lda #17		;small splat 	jmp explode	@notnear:	rtl		sporeymove:	dc.b	-8,-7,-7,-6,-5,-4,-3,-2,-1,0	dc.b	1,2,3,4,5,6,7,7,8	shroomdir:	dc.b	-4,3,1,-2,-1,2,-3,4;---------------------------------------------------------treeturrettask:		;shooting eyes in trees	lda #5	sta PIChealth,x		lda #2	sta PICscroll,x		lda #0	sta PICsize,x		lda #3	sta PICcolor,x		lda #ubank	sta PICbank,x		inc PICflag,x		lda PIClogic,x	sta PICdir,x	bne @righteye2	@lefteye2:	lda #lefttreeturret	bra @shoot2	@righteye2:	lda #righttreeturret	@shoot2:	jsr initanim	jsr animborg	;------------------------------------------	jsl TSKsuspend	lda #17	jsr shootenemy		lda PICflag,x	beq @waitshot			;wait for eye to open		lda PICdir,x	bne @righteye	@lefteye:	lda #lefttreeturret	bra @shoot	@righteye:	lda #righttreeturret	@shoot:	jsr initanim		lda PICxhi,x	ora PICyhi,x	bne @waitshot		;must be offscreen		inc PICtemp1,x		;hspeed changes each shot	lda PICtemp1,x	and #7	sta PICtemp1,x		lda #type_enemy	jsl TSKschedule	dw treebullettask	bcc @notasks			;no room?		jsl copytask2	@notasks:@waitshot:	jsr animborg		rtl;---------------------------------------------------------treebullettask:				;ball fired by tree eye	lda #type_badbullet	sta PICtype,x		lda #sfxeyepop				;treebubblefire		;drip	jsl soundeffects		inc PICtemp1,x		;make speed 1-4, not 0-3		lda #2	sta PICscroll,x		lda #3	sta PICcolor,x		lda #ubank	sta PICbank,x		lda #jungbullet	jsr initanim		jsl	TSKsuspend;----------------------------	jsr animborg		lda PICtemp2,x	inc PICtemp2,x	tay	lda treebulymove,y	cmp #8	bne @movearrow		;max velocity?		dec PICtemp2,x	lda #4	sta PICmovev,x		lda #8@movearrow:	jsl PICyadd	@no_float	lda PICtemp1,x	jsr movetaskx		lda PIChit,x	beq @notnear		lda #drain1	jsl drainstrengthl		ldx TSKcurrent	lda #7	sta TSKbank,x	stz PICtype,x	lda #2			;17				jmp explode	@notnear:	rtl		treebulymove:	dc.b	0,0,0,0,0,1,2,3,4,6,8		*********************************************************************;--------------------------------------------------------------setbosspos:		;copy boss position into universal variables	lda PICxlo,x	sta bossx	lda PICxhi,x	sta bossx+1	lda PICylo,x	sta bossy	lda PICyhi,x	sta bossy+1	lda PICdir,x	sta bossdir	lda PICdirv,x	sta bossdirv	lda PICcolor,x	sta bosscolor	lda PICcolorhit,x	sta bosscolorhit	rts;-------------------------------------------------------getbosspos:		;get bos x,y according to main task	sta tmpx	sty tmpy	;	stz PICtype,x			;not shootable part	lda bossdir	sta PICdir,x			lda bosscolorhit	sta PICcolorhit,x	bra gboss3		getbosspos2:		;skip past pictype reset...	sta tmpx	sty tmpy	gboss3:				;skip skipped parts (huh?)	lda bossx	sta PICxlo,x	lda bossx+1	sta PICxhi,x		lda bossy	sta PICylo,x	lda bossy+1	sta PICyhi,x		lda bosscolor	sta PICcolor,x		lda tmpx				;set offsets	jsl PICxadd	lda tmpy	jsl PICyadd		lda #1	sta PICscroll,x		rts;------------------------------------------------------------*********************************************************************lavadeath		equ	12		;delay between boomslavabosstask:		;lava boss	lda #type_enemy	jsl TSKschedule	dw fake_priortask	lda #type_enemy	jsl TSKschedule	dw fake_priortask	lda #type_enemy	jsl TSKschedule	dw fake_priortask	lda #type_enemy	jsl TSKschedule	dw fake_priortask	lda #type_enemy	jsl TSKschedule	dw fake_priortask	lda #type_enemy	jsl TSKschedule	dw fake_priortask	lda #type_enemy	jsl TSKschedule	dw fake_priortask	lda #type_enemy	jsl TSKschedule	dw fake_priortask	jsl TSKsuspend		lda #type_enemy	jsl TSKschedule	dw real_lavabosstask	fake_priortask:	lda #10	jsl TSKwait	jsl TSKcancel	rtl	real_lavabosstask:	inc PICprior,x		stz PICxhi,x		lda #19	sta PICbank,x		lda #200	ldy #220	jsl PICxySet		lda #4	sta PICcolor,x		lda #96	sta PIChealth,x		lda #16	sta PICsize,x		lda #type_enemy	jsl TSKschedule	dw lavabossbody	jsl copytask		lda #lavaboss_burn	jsr initanim		stz bossflag1	;---------------------------------------------------			jsl TSKsuspend		lda PIChealth,x			lsr a	sta bossstrength		;display boss strength		jsr blinkenemy		lda PIChealth,x		;killed thing yet?	bne @liveboss	;kill lava boss	jsr setbosspos		inc bossflag1		;set dead flag		lda #2	sta PICcolor,x		lda #lavadeath	jsl TSKwait		lda #-10	ldy #-39	jsr setlavablast	jsl PICput	dw lavabossf8		lda #lavadeath	jsl TSKwait		lda #16	ldy #-28	jsr setlavablast	jsl PICput	dw lavabossf9	lda #lavadeath	jsl TSKwait		lda #180	sta winflag	lda #maxstrength	sta strength		jsr score20000		jsl TSKcancel	rtl@liveboss:@jump:					;make jump out of lava		lda PICflag,x			;reset anim if just fired a bullet	beq @keepjumping		lda #lavaboss_burn	jsr initanim	@keepjumping:	lda PICstatus,x	cmp #lavaboss_shoot	beq @donejump			;hold vpos while shooting		lda PICcount2,x		inc PICcount2,x		;read ymove from table		tay	lda lavabossjump,y	cmp #128			;eof?	bne @jump3					;reset flight counter	stz PICcount2,x		lda PICxlo,x	and #16	bne @setjump		lda #lavabossjumplow-lavabossjump	sta PICcount2,x		;make low jump	@setjump:	stz PICxhi,x	lda bobxpos	sta PICxlo,x		inc bosscount1		;"random" lavaboss range	lda bosscount1	and #15	tay	lda lavabossloc,y	;get offset	jsl PICxadd			;now, should be near bob		jsr initdir		jmp @donejump	@jump3:	cmp #127	bne @nojumpshot		;fire lava ball		lda #lavaboss_shoot	jsr initanim		lda #sfxfireballs	jsl soundeffects		bra @donejump	@nojumpshot:	cmp #126	bne @nosound		;make rising sound		lda #sfxlavaboss	jsl soundeffects	bra @donejump@nosound:	jsl PICyadd	@donejump:	jsr floattask	jsr setbosspos		jsr setdir2	jsr animborg		lda PICstatus,x		;fire a stream of fireballs	cmp #lavaboss_shoot	bne @notfire		lda PICanim,x	cmp #2	bcc @notfire	cmp #5	bcs @notfire		lda PICcount,x	cmp #1	bne @notfire		lda #12	jsl PICyadd		lda PICdir,x	tay	lda lavashootoffset,y	jsl PICxadd		inc PICthingy,x			;get next lava ball dir	lda PICthingy,x	and #3	tay	lda lbossvd,y	sta PICtemp1,x		lda #type_enemy	jsl TSKschedule	dw lavaballtask	jsl copytask2			lda #12	jsl PICysub		lda PICdir,x	tay	lda lavashootoffset+2,y	jsl PICxadd	@notfire:	rtl;------------------------------	lavashootoffset:	dc.b	-48,52			;initial offset	dc.b	48,-52			;return to centrelbossvd:		;dir of lava balls	dc.b	4,0,6,0;-----------------------------------------------lavabossloc:		;ranges near bob	dc.b	16,-7,23,-32,30,19,-40,0,12	dc.b	-9,-19,4,35,10,-21,-37;-------------------------------------------setlavablast:		;make a piece explode	sta temp	sty temp+1		lda #type_enemy	jsl TSKschedule	dw lavablasttask		jsl copytask	lda temp	sta PICtemp1,y	lda temp+1	sta PICtemp2,y		lda #30	sta shakescreen		;kaboom		rts;------------------------------------------------	lavablasttask:	lda PICtemp1,x	jsl PICxadd	lda PICtemp2,x	jsl PICyadd		lda #0	jmp explode;------------------------------------------------lavabossjump:	dc.b	126	;	dc.b	-12,-10,-2,-2,-2,-1,-1,-1,0,0,0,0,0;	dc.b	0,0,0,0,0,0,0,0,0,0	dc.b	-12+8,-10,-2,-2,-2,-1,-1,-1,0,0,0,0,0	dc.b	-12,-12,-12	dc.b	-12,-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,-1,-1,0,0,0	dc.b	0,0,0,0,0,0,0,0,127,0,0,0,0,0	dc.b	1,1,1,2,3,4,5,6,7,8,9,10,11,12	dc.b	12,12,12,12	dc.b	19-8	dc.b	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0	dc.b	128	lavabossjumplow:	dc.b	126	;	dc.b	-12,-10,-2,-2,-2,-1,-1,-1,0,0,0,0,0;	dc.b	0,0,0,0,0,0,0,0,0,0	dc.b	-12,-10,-2,-2,-2,-1,-1,-1,0,0,0,0,0	dc.b	-12,-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,-1,0,0,0	dc.b	0,0,0,0,0,127,0,0,0	dc.b	1,1,2,3,4,5,6,7,8,9,10,11,12	dc.b	12	dc.b	19	dc.b	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0	dc.b	128lavablast:	dc.b -10,-39	dc.b	16,-28	dc.b	-18,-17	dc.b	7,-2	dc.b	-4,19	dc.b	0,40		dc.b	0,0	**********************************************************lavabossbody:		;lava boss lower body task	inc PICprior,x		lda #19	sta PICbank,x		;---------------------------------------------------			jsl TSKsuspend		lda PICdir,x	bne @flipoff		lda #-5					;set offsets	bra @draw	@flipoff:	lda #5	@draw:	ldy #60	jsr getbosspos		jsl PICput	dw lavabossf0	jsr setdir2		lda bossflag1	bne @deadlava		rtl	@deadlava:	lda #2	sta PICcolor,x	lda #lavadeath*3	jsl TSKwait		lda #-18	ldy #-17	jsr setlavablast	jsl PICput	dw lavabossf10		lda #lavadeath	jsl TSKwait		lda #7	ldy #-2	jsr setlavablast	jsl PICput	dw lavabossf11	lda #lavadeath	jsl TSKwait		lda #-4	ldy #19	jsr setlavablast	jsl PICput	dw lavabossf12		lda #lavadeath	jsl TSKwait	lda #0	jmp explode;--------------------------------------------------------------	cellmantask:bubblemantask:		;walking man o' bubbles	lda #ubank	sta PICbank,x		lda #5	sta PIChealth,x		lda #2	sta PICscroll,x		lda #24 	sta PICsize,x		lda #2	sta PICcolor,x		lda #15	sta PICtemp2,x		lda #1	sta PICdir,x		lda #bubbleman_walk	jsr initanim	jsr animborg		lda #type_enemy	sta PICtype,x		jsr setdir2;------------------------------------		jsl TSKsuspend		lda #18	jsr shootenemy		inc PICtemp2,x		lda PICtemp2,x	and #15+32		bne @waitshot			;wait for counter			lda #6	sta PICtemp1,x		lda #type_enemy	jsl TSKschedule	dw treebullettask	bcc @notasks			;no room?		jsl copytask		lda PICtemp1,x	sta PICtemp1,y	;	ldy #0;	lda #8;	ldx #12;	jsr fire_bullet	@notasks:@waitshot:@noshot:	inc PICcount2,x	lda PICcount2,x	cmp #34	bcc @walk	cmp #44	bcs @startwalking		cmp #39	beq @flipman		cmp #34	bne @keepwalking		;avoid setting more than once		lda #bubbleman_stand	jsr initanim		bra @keepwalking	@flipman:	lda PICdir,x			;xflip time	eor #1	sta PICdir,x		bra @keepwalking	@startwalking:				;reset walking	lda #bubbleman_walk	jsr initanim	stz PICcount2,x	@walk:						;normal walk	lda #2	jsr movetaskx@keepwalking	jsr animborg		jsr setdir2		rtl							;---------------------------------------------------------------eeltask:				;lamprey eel task		lda PICyhi,x		;is eel starting offscreen?	bne @offscreen		;must be onscreen so check for bob proximity		lda PICylo,x	cmp bobypos	bcc @downer	@upper:	lda #1	bra @moremore			;go up	@downer:	lda #-1	bra @moremore			;go down	@offscreen:	lda PICyhi,x	bmi @setdown@setup:	lda #0	bra @moremore@setdown:	lda #1@moremore:	sta PICdir,x		lda #1			;color	sta PICcolor,x	lda #eel	jsr initanim		lda #ufbank	sta PICbank,x		lda #3	sta PIChealth,x		lda #2	sta PICscroll,x		lda #3	sta PICsize,x	;	lda #sfxmissile1;	jsl	soundeffects;--------------------------------------	jsl TSKsuspend			;move cell		lda #16	jsr shootenemy		jsr animborg		inc PICcount2,x	lda PICcount2,x	cmp #60	bcc @samedir		stz PICcount2,x		lda PICdir,x	eor #1	sta PICdir,x	@samedir:@eelmove:@xfloat:	lda PICtemp2,x	inc PICtemp2,x	tay	lda eelxmove,y	cmp #128	bne @movex		stz PICtemp2,x	bra @xfloat	@movex	jsl PICxadd	lda PICdir,x	bne @down	@up:	jsl PICyunflip		lda #-1	sta PICmovev,x	lda #-3	bra @move_eel	@down:	jsl PICyflip		lda #1	sta PICmovev,x	lda #3	@move_eel:	jsl PICyadd		jsl PICxunflip			;make fish flip		inc PICtemp1,x	lda PICtemp1,x	cmp #30	bcc @noshots		stz PICtemp1,x		lda PICdir,x				;fire shot up or down?	beq @uppy	@downy:	ldy #6	bra @firey@uppy:	ldy #-6@firey:	lda #0	ldx #17	jsr fire_bullet	@noshots:	lda TSKclock	and #2	bne @nosquiggle		jsl PICxflip	@nosquiggle:	rtleelxmove:	dc.b	9,8,7,6,5,4,3,2,1,1,0,0,0	dc.b	-1,-1,-2,-3,-4,-5,-6,-7,-8,-9,-8,-7,-6,-5,-4,-3,-2,-1	dc.b	-1,0,0,0,1,1,2,3,4,5,6,7,8,128;---------------------------------------------------------------jellytask:			;jelly cell task	jsr initdir		lda #5			;color	sta PICcolor,x		lda #jellycell	jsr initanim	jsr animborg		lda #ufbank	sta PICbank,x		lda #1	sta PIChealth,x		lda #2	sta PICscroll,x		lda #3	sta PICsize,x	;	lda #sfxmissile1;	jsl	soundeffects;--------------------------------------	jsl TSKsuspend			;move cell		lda #16	jsr shootenemy		jsr animborg	@jellymove:			;move jelly horizontally	jsr setdir@jelly_vmove		jsr floattask		lda #6	jsr movetaskx		inc PICtemp1,x	lda PICtemp1,x	cmp #16	bcc @nojellyshots		stz PICtemp1,x			lda PICdir,x				;fire shot behind fish	pha	eor #1	sta PICdir,x		lda #6			;bullet fires opposite dir to jfish	ldy #0	ldx #13	jsr fire_bullet	pla	sta PICdir,x	@nojellyshots:	rtl	;----------------@eelmove:@xfloat:	lda PICtemp2,x	inc PICtemp2,x	tay	lda pussminexmove,y	cmp #128	bne @movex		stz PICtemp2,x	bra @xfloat	@movex	jsl PICxadd	lda PICdir,x	bne @down	@up:	jsl PICyunflip		lda #-1	sta PICmovev,x	lda #-3	bra @move_eel	@down:	jsl PICyflip		lda #1	sta PICmovev,x	lda #3	@move_eel:	jsl PICyadd		jsl PICxunflip			;make fish flip		inc PICtemp1,x	lda PICtemp1,x	cmp #30	bcc @noshots		stz PICtemp1,x		lda PICdir,x				;fire shot up or down?	beq @uppy	@downy:	ldy #6	bra @firey@uppy:	ldy #-6@firey:	lda #0	ldx #13	jsr fire_bullet	@noshots:	lda TSKclock	and #2	bne @nosquiggle		jsl PICxflip	@nosquiggle:	rtl	;----------------------;---------------------------------------------------------------pussdroppertask:	;celing pussball dropper	;drop interval timer is PIClogic		lda PIClogic,x	adc #8	sta PICtemp2,x		;make 6 drops after count		lda #7	sta PIChealth,x		lda #2	sta PICscroll,x		lda #1	sta PICsize,x	lda #ufbank	sta PICbank,x		lda #4	sta PICcolor,x		lda #pussdropper	jsr initanim	jsr animborg	;-----------------	jsl TSKsuspend				lda #16	jsr shootenemy		jsr animborg		inc PICcount2,x	lda PICcount2,x	cmp PIClogic,x		;drop interval timer is PIClogic	bcc @nopuss		;not time yet	cmp PICtemp2,x	bcc @dropmore		;drop a stream of 6		stz PICcount2,x	@dropmore:	lda PICcount2,x	cmp PIClogic,x	bne @nosound		lda #sfxpussdrop	jsl soundeffects@nosound:	lda PICcount2,x	and #1	bne @notasks		;make every 2nd cycle		lda #type_enemy	jsl TSKschedule	dw pussballtask			bcc @notasks		jsl copytask		@notasks:@nopuss:	rtl	;---------------------------------------------pussballtask:		;balls that drops from wee pussdropper	lda #8	jsl PICxadd	lda #20	jsl PICyadd		lda #1	sta PIChealth,x		lda #2	sta PICscroll,x		lda #0	sta PICsize,x	lda #ufbank	sta PICbank,x		lda #4	sta PICcolor,x		stz PICcount2,x		lda #pussdrop	jsr initanim	jsr animborg	;-----------------	jsl TSKsuspend				lda #15				jsr shootenemy		jsr animborg		inc PICcount2,x	lda PICcount2,x	pha	jsl PICyadd	pla	lsr a	sta PICmovev,x		lda #0	ldy #16	jsl bgcoll_longer		lda chartype	cmp #solid	bne @fall2	@splatdropper:				;kill dropper	lda #15				;spalt w/o bits (for speed concerns)			jmp explode	@fall2	@notready:	lda PICcollide,x	beq @nothit		lda #drain1	jsl drainstrengthl	bra @splatdropper	@nothit:	rtl;-------------------------------------------------------------menacetask:		;ladder menace chases bob	lda #10	sta PIChealth,x		lda #2	sta PICscroll,x		lda #3	sta PICsize,x	lda #ufbank	sta PICbank,x		lda #1	sta PICcolor,x		jsl PICput	dw bodyf0;-----------------	jsl TSKsuspend				lda #16	jsr shootenemy		lda PICyhi,x	bmi	@down	bne @up		;must be on same screen as bob	@bobscreen:	lda #20	jsr bobzone	bcc @stop		;must be on same x zone as bob		lda PICylo,x		;above or below bob?	adc #16	cmp bobypos	bcc @down	sbc #24	cmp bobypos	bcs @up		bra @stop	@down:	lda #0			;make sure it's on a ladder	ldy #16	jsl bgcoll_longer		lda chartype	cmp #ladderright			beq @down2	cmp #ladderleft		bne @stop		@down2:	lda #2	bra @move	@up:	lda #0			;;make sure it's on a ladder	ldy #-16	jsl bgcoll_longer		lda chartype	cmp #ladderright			beq @up2	cmp #ladderleft		bne @stop	@up2:	lda #-2	@move:	jsl PICyadd		lda TSKclock		;animate when chasing	and #2	bne @frame2	@frame1:	lda #sfxmenace	jsl soundeffects	jsl PICput	dw bodyf0	rtl		@stop:@frame2:		jsl PICput	dw bodyf1	rtl;---------------------------------------------------------------clustertask:			;cell cluster fuck	lda #5	sta PIChealth,x	sta PICtemp1,x		;previous health		lda #2	sta PICscroll,x		lda #3	sta PICcolor,x			lda #cluster5	jsr initanim	jsr animborg		lda #3	sta PICsize,x	lda #ufbank	sta PICbank,x	;-----------------		jsl TSKsuspend				lda PIChealth,x			;cluster been hit ?	cmp PICtemp1,x	beq @sameshape		sta PICtemp1,x				;new current health	tay	phy	lda clustertable-1,y		;get anim 0-4	jsr initanim	ply	lda clustersize-1,y	sta PICsize,x		lda PICstatus,x			;save picstatus	pha		lda #16	sta PICstatus,x			;explosion type - uforce	jsr makebits		pla	sta PICstatus,x			;restore PICstatus		lda #10	sta PICcolorhit,x		lda #sfxcluster			;hit sound	jsl soundeffects	@sameshape:	lda #16	jsr shootenemy		jsr initdir	jsr animborg	@sety:			;make cluster float	lda PICtemp2,x	inc PICtemp2,x	tay	lda clusterymove,y	cmp #128	bne @movey		stz PICtemp2,x	bra @sety	@movey	cmp #127	bne @noshot		;fire at bob		lda #6	ldy #0	ldx #13	jsr fire_bullet	bra @noymove@noshot:	jsl PICyadd@noymove:	rtl	clustertable:		;end to beginning order	dc.b	cluster1,cluster2,cluster3,cluster4	clustersize:	dc.b	0,55,54,3		clusterymove:	dc.b	127			;low	dc.b	-1,-2,-4,-6,-8,-6,-4,-2,-1,0	dc.b	-1,-2,-4,-6,-8,-6,-4,-2,-1,0	dc.b	127			;high shot	dc.b	1,2,4,6,8,6,4,2,1,0	dc.b	127			;medium	dc.b	-1,-2,-4,-6,-8,-6,-4,-2,-1,0	dc.b	127			;high shot	dc.b	1,2,4,6,8,6,4,2,1,0	dc.b	1,2,4,6,8,6,4,2,1,0	dc.b	127			;low	dc.b	-1,-2,-4,-6,-8,-6,-4,-2,-1,0	dc.b	1,2,4,6,8,6,4,2,1,0	;faked ya!!!!! low again	dc.b	128;--------------------------------------------------------------screenliftertask:		;boss who lifts screen up	stz queenflag	stz babyflag		stz PICtype,x	stz bosscount3		lda	#%00100000	sta	PICbehind1,x		lda #53	sta PICsize,x		lda	#4					;parallax start	sta	doorbossxpos	lda	#-20-10	sta	doorbossypos		lda	lockscreen	bne	@screenready	rtl		@screenready:	lda #type_enemy	jsl TSKschedule	dw babylifter			;send out little fucker		jsl TSKsuspend		lda bossflag1			;ready for daddy?	bne @big_guy		rtl	@big_guy:		lda #30	jsl TSKwait		stx bosstarget		stz bossflag1		lda #1	sta doorspeed		lda #sfxdoor3			;lift door sound	jsl soundeffects	inc lifterflag	lda	#-1	sta	doorknob			;screen rises		jsr liftersub		lda	doorbossxpos	sta	Hpos2		lda	#128	sta	PICxlo,x	lda	#32+62	sta	PICylo,x		stz	PICxhi,x	stz	PICyhi,x		lda	#1	sta	PICcolor,x		lda #100	sta PIChealth,x			lda #lifter_look	jsr initanim	lda #type_enemy		;lower left body	jsl TSKschedule	dw leftlifthand	jsl copytask	lda #type_enemy		;lower right body	jsl TSKschedule	dw rightlifthand	jsl copytask	lda #1	sta bosscount2			;laser counter	;-=----------------------------------	jsl TSKsuspend		jsr animborg		lda bossready		;skip this if boss already up	bne @notupyet		lda	backdoor	cmp	#DOORTOP	beq	@riseup	bcc @riseup		inc doorspeed		lda	#-20	bra	@nomore@riseup:	lda	doorbossypos		;move body up	cmp	#12+10	beq	@readytogo		;nomore	inc	a	sta	doorbossypos	lda #1	jsl PICysub@nomore:	bra @notupyet	@readytogo:	inc bossready		lda babyflag	bne @inidelay		;no time to pause if pissed off		lda #130	sta bosscount1		;freeze boss for lasers	@inidelay:	lda #type_enemy	sta PICtype,x		lda babyflag	beq @notupyet			;no scream or shake if baby alive		lda #60	sta PICshake,x		lda #sfxsnakeboss2		;door1	jsl soundeffects		;laugh sound	@notupyet:	lda PIChealth,x		;1st or 2nd phase of head?	bne @livehead		jmp @bouncinghead	@livehead:	jsr blinkenemy		lda PIChealth,x	lsr a	lsr a	cmp #48	bcc @disp	lda #48@disp:	sta bossstrength			;move him around screen		lda bosscount1	beq @slide_away						dec bosscount1		;stop.	;------------- fire laser time???	lda bossready	bne @slide_away		jmp @noslide		;wait till fully raised	@slide_away:	lda bossflag1	bne @slide		;already active-don't keep resetting lasers!		lda bossflag2	cmp #2	bcs @fireagain		;if arms gone, keep firing lasers		inc bosscount2		;ready to fire lasers?		lda bosscount2		;sort of random.... every 77 pauses	cmp #45	bcc @slide		stz bosscount2	@fireagain:	lda queenflag	;after first attack, never stop again!	bne	@neverstop	;	lda babyflag;	bne @neverstop		;no time to pause if pissed off		lda #125	sta bosscount1		;freeze boss for lasers	@neverstop:;	lda #60;	sta PICshake,x		lda #sfxdoor1	jsl soundeffects		lda #96	sta bossflag1		;laser fire count down timer	lda #1	sta queenflag		bra @noslide	;-------------	@slide:;slide left or right? 		inc PICtemp2,x	lda PICtemp2,x	and #15	tay	lda lifterwalk,y	jsl PICyadd			;make lifter float a bit, like walking		lda PICdir,x	bne @slideright	@slideleft:	lda #1	clc	adc babyflag	jsl PICxsub		lda PICxlo,x	cmp #64+16	bcs @midslide		lda #1	sta PICdir,x;	lda #8;	sta bosscount1	bra @noslide	@slideright:	lda #1	clc	adc babyflag	jsl PICxadd		lda PICxlo,x	cmp #-64-16	bcc @midslide		stz PICdir,x	;	lda #8;	sta bosscount1@midslide:		;stop in middle?;	lda PICxlo,x;	cmp #128;	bne @noslide	;	lda #20;	sta bosscount1		;always pause in middle		@noslide:		jsr setbosspos	lda PICxlo,x			;base value 128	eor #$ff							;door boss base value is 4							;therefore -124 from xpos?	sec	sbc #128	sta hpos2				;screen xpos value		lda #44	sec	sbc PICylo,x	sta vpos2	; time to fire laser?	lda bossflag1		;should laser fire?	beq @nolasers		dec bossflag1		;counter for laser fire time	lda bossflag1	cmp #1	bne @firstlaser		lda #1	sta queenflag		;tell boss to start moving now!@firstlaser:		lda enemyblind	bne @samelaser	lda PIClogic,x		;limit # of pieces in beam...	and #15	cmp #4	bcs @samelaser		;only 5 pieces per laser beam		cmp #0	bne @nosoundl		lda #sfxsnakeboss3	jsl soundeffects	@nosoundl:	lda #type_enemy	jsl TSKschedule	dw laserboss		;shoot laser	bcc @samelaser		;task available?		jsl copytask2	@samelaser:	inc PIClogic,x		;inc laser dir pointer@nolasers:	rtl		;-----------------------------------@bouncinghead:			;2nd phase head attack	inc bosscount3		;tell arms to blow up		lda	#%00010000	sta	PICbehind1,x			lda #100	sta PICcolorhit,x	sta PICshake,x		lda #sfxsnakeboss2		;door1	jsl soundeffects		;laugh sound	lda	#1	sta	doorknob		ldy #128	lda #3	jsl makepowerup2		inc PICprior,x		jsl	TSKsuspend		;drop door on head		lda	backdoor	cmp	#DOORBOTTOM	beq	@over2	rtl@over2:	stz	nomainscroll			lda #sfxexplode1	jsl soundeffects		lda #30	sta shakescreen	@doneflash:	lda #25	sta PIChealth,x			stz PICcount2,x		;bounce table 	lda #lifter_look	jsr initanim	jsr initdir	lda PICdir,x	eor #1	sta PICdir,x		;make him go other way;-------------------------	jsl TSKsuspend		lda PIChealth,x	asl a	sta bossstrength	bne @getheady		jmp @over	@getheady:	lda PICcount2,x	cmp #17	bne @not_impact		;hitting floor?		lda #20	sta shakescreen		lda #sfxdoor4	jsl soundeffects	jsr crushbob			;hit bob?	@not_impact:		lda PICcount2,x	inc PICcount2,x	tay	lda lifterheadbounce,y	cmp #128	bne @bounce_it		stz PICcount2,x	bra @getheady	@bounce_it:	jsl PICyadd			lda PICxlo,x	cmp #32	bcs @goodbounce		inc PICdir,x@goodbounce:	cmp #-32	bcc @goodbounce2		stz PICdir,x@goodbounce2:	lda #3	jsr movetaskx			jsr animborg		lda PICstatus,x	cmp #lifterhead	bne @noshots	lda PICanim,x	cmp #12	bne @noshots		lda enemyblind	bne @noshots		lda PICcount,x	cmp #1	bne @noshots			;only once		lda #sfxborgfire4	jsl soundeffects	lda PICdir,x	pha		stz PICdir,x		lda #3	ldy #3	ldx #14	jsr fire_bullet		;left lifter fireballs	lda #0	ldy #6	ldx #14	jsr fire_bullet		;down lifter fireballs		inc PICdir,x		lda #3	ldy #3	ldx #14	jsr fire_bullet		;right lifter fireballs		pla	sta PICdir,x	@noshots:	lda PICstatus,x	cmp #lifter_look	beq @trytofire		;must be firing		lda PICflag,x	beq @firing		lda #lifter_look		;reset to animating head	jsr initanim	@trytofire:		inc PICdirv,x	lda PICdirv,x	cmp #110	bcc @firing	stz PICdirv,x		lda #lifterhead	jsr initanim	@firing:	stz PICcollide,x		;clear collide flag		jsr blinkenemy		rtl@over:				;end of level. lower door on bossola@over1:			stz PICprior,x		lda #0	ldy bobxpos	jsl makepowerup2		lda #60	sta PICshake,x	sta PICcolorhit,x		stz PICtemp2,x	stz PICtype,x		lda #30			;drop to ground	jsl TSKwait		inc PICtemp2,x	lda PICtemp2,x	lsr a	jsl PICyadd		lda PICylo,x	cmp #150	bcs @thud		;hit bottom		rtl	@thud:	stz PIChit,x	lda #30	sta shakescreen		lda #sfxexplode2	jsl soundeffects		jsl TSKsuspend		jsr crushbob		;waste bob?		lda #220	sta winflag	lda #maxstrength	sta strength	lda #type_enemy	jsl TSKschedule	dw bossexplode2	jsl copytask	lda #24	sta bossexplodetype		lda #255	sta PICshake,x	sta PICcolorhit,x	lda #90	jsl TSKwait		jsr score25000		lda #24	jmp explode		;-------------------------------	lifterheadbounce:	dc.b  1,1,2,2,3,4,5,6,7,8,9,10,10,10,10,10,10,10	dc.b  -10,-10,-10,-10,-10,-10,-10	dc.b	-9,-8,-7,-6,-5,-4,-3,-2,-2,-1,-1,0,0,0,0	dc.b	0,0	dc.b	128	lifterwalk:		;make lifter "float" like it's walking	dc.b	1,1,2,2,1,1,0,0,-1,-1,-2,-2,-1,-1,0,0;------------------------------------------------------------babylifter:		;little baby lifter	lda #90	jsl TSKwait		lda #lifterbank	sta PICbank,x		lda #6	sta PICsize,x		lda #25	sta PIChealth,x	lda #1	sta PICcolor,x		lda #babylifterrecoil			jsr initanim		lda #16	ldy #155	jsl PICxyset	lda #1	sta PICxhi,x		jsr setdir	jsl TSKsuspend		lda enemyblind	bne @noshot		lda #6	jsr movetaskx		inc PICcount2,x	lda PICcount2,x	cmp #18	bcs @shootbob		jmp @noshot	@shootbob:	jsl TSKsuspend		lda enemyblind	bne @noshot		lda PIChealth,x	cmp #2	bcc @retreat		;if low health, run away!		jsr initdir	jsr setdir		inc PICtemp1,x	lda PICtemp1,x	cmp #32	bcc @noshot		stz PICtemp1,x		lda #babylifterrecoil	jsr initanim		lda #8	ldy #0	ldx #14				;lifter bullet	jsr fire_bullet		lda #sfxborgfire3	jsl soundeffects@noshot:	jsr animborg 		jsr blinkenemy		lda PIChealth,x	beq @killbaby		lda enemydie	bne @killbaby	@fight:	rtl	@retreat:	lda #babylifterrecoil	jsr initanim		lda PICdir,x	eor #1	sta PICdir,x	jsr setdir		jsl TSKsuspend		lda enemyblind	bne @noshot		lda #5	jsr movetaskx		lda PICxhi,x	bne @offscreen		jmp @noshot		;finish move cycle	@offscreen:			;trigger big guy			stz PICadrlo,x	stz PICadrhi,x		lda #35	jsl TSKwait	inc bossflag1		jsl TSKcancel	rtl	@killbaby:			;oh! you evil, nasty man!		lda #2	ldy #-100	jsl makepowerup2		;give bullets if you kill baby		inc babyflag		;tell big boss to get meaner!	inc bossflag1	lda #sfxsnakeboss1	jsl soundeffects		lda #24	jmp explode		;the baby was killed	;------------------------------------------------------------	punchtime	equ	0		;punch delayarmlength	equ	64rightlifthand:				;right punching hand	lda #20	sta PICcount,x		lda #1	sta PICdir,x		lda babyflag	bne @harder		lda #40	sta PICcount,x	@harder:leftlifthand:				;left punching hand	lda #40	sta PICtemp2,x		lda babyflag	bne @harder		lda #80	sta PICtemp2,x	@harder:	stz PIClogic,x		jsr liftersub		lda #40					;20	sta PIChealth,x		jsl PICput	dw lifterf12		lda #46	sta PICsize,x		lda	#%00100000	sta	PICbehind1,x	@reset:	jsl TSKsuspend		lda PICdir,x	bne @righthand	@lefthand:	lda #-54			;initial starting pos.	sta PICdirv,x		;x offset 	ldy #armlength	jsr getbosspos2	jsr setdir	bra @donehand	@righthand:	lda #56	sta PICdirv,x	ldy #armlength	jsr getbosspos2	@donehand:	lda PIChealth,x	bne @safehand		inc bossflag2			;death counter		lda PICdir,x			;give powerup	bne @rightey	@leftey:	lda #3		;triple	ldy #80	bra @giveit@rightey:	lda #15	ldy #-80@giveit:	jsl makepowerup2	@safehand:	lda bosscount3		;blow hands if head killed	beq @handslive		lda #24	jmp explode	@handslive:	lda #24	jsr shootenemy		lda bossready	beq @nextfist			;wait till boss is ready		lda PICcount,x			;time to punch?	cmp PICtemp2,x	bcs @punch		inc PICcount,x			;no	bra @nextfist		;no attack during laser	@punch:						;yes	lda	#%00010000	sta	PICbehind1,x	;;	sta PICprior,x		lda PIClogic,x			;get frame	lsr a	asl a	asl a	tay	lda fistframe,y	sta PICadrLo,x	lda fistframe+1,y	sta PICadrHi,x	lda fistframe+2,y		;set correct size	sta PICsize,x		lda PICdirv,x	ldy #armlength	jsr getbosspos2		lda PIClogic,x			;shake screen?	cmp #1				;punchtime+2	bne @noshake		lda #20	sta shakescreen	lda #sfxdoor4			;punch sound	jsl soundeffects		jsr crushbob			;crush bob under fist?	@noshake:	inc PIClogic,x			;end of punch cycle?	lda PIClogic,x	lsr a	cmp #8	bcc @nextfist		stz PIClogic,x			;reset cycle	stz PICcount,x		lda PICtemp2,x		;this affects time bewtween punches	cmp #4	bcc @nextfist			;min. speed		sbc #1	sec	sbc babyflag	sta PICtemp2,x	@nextfist:	stz PICcollide,x	stz PIChit,x	rtl;----------------------------------------------------------------fistframe:		;frames and offsets for door lifter hands	dc.w	lifterf18	dc.b	52,0	dc.w	lifterf18	dc.b	52,0	dc.w	lifterf17	dc.b	51,0	dc.w	lifterf16	dc.b	50,0	dc.w	lifterf15	dc.b	49,0	dc.w	lifterf14	dc.b	48,0	dc.w	lifterf13	dc.b	47,0	dc.w	lifterf12	dc.b	46,0	;----------------------------------------------------------------	liftersub:			;set up lifter stuff	lda #lifterbank	sta PICbank,x;	lda	#%11001111				;put behind screen 1;	sta	PICbehind1,x	rts;--------------------------------------------------	laserboss:	;laser from screen lifter boss		lda #type_badbullet	sta PICtype,x		lda #lifterbank	sta PICbank,x		lda #7	sta PICcolor,x		inc PICprior,x		lda #0	sta PICsize,x	;	lda #20;	jsl PICysub		stz PICcount,x		lda PIClogic,x	lsr a	lsr a	lsr a	lsr a	and #15	asl a	tay		lda laserframe,y	sta PICtemp1,x	lda laserframe+1,y	sta PICtemp2,x		lda #20	jsl PICysub				;centre in middle of head laser spot		jsl TSKsuspend		lda TSKclock	and #1	bne @frame2	@frame1:	jsl PICput	dw lifterf8	bra @setframe	@frame2:	jsl PICput	dw lifterf9	@setframe:	lda PICtemp1,x	jsl PICxadd		lda PICtemp2,x	jsl PICyadd		lda PICylo,x	cmp #165	bcs @fizzout			;hit floor		lda PIChit,x	bne @hit		rtl	@hit:		lda #1	jsl justdrainstrengthl@fizzout:	stz PICtype,x		jsl PICput	dw lifterf8	lda #2	jsl TSKwait	jsl PICput	dw lifterf9	lda #2	jsl TSKwait	jsl PICput	dw lifterf10	lda #2	jsl TSKwait	jsl PICput	dw lifterf11	lda #2	jsl TSKwait		jsl TSKcancel	rtl		laserframe:	dc.b	-7,7	dc.b	-5,8			;x,y move per cycle	dc.b	-3,9	dc.b	-1,10	dc.b	1,10	dc.b	3,9			;x,y move per cycle	dc.b	5,8	dc.b	7,7	dc.b	7,7	dc.b	5,8	dc.b	3,9			;x,y move per cycle	dc.b	1,10	dc.b	-1,10	dc.b	-3,9	dc.b	-5,8			;x,y move per cycle	dc.b	-7,7;---------------------------------------------------------------	neg:			;make value held in A negative	sec	sbc #1	eor #$ff	rts;---------------------------------------------------------------pussturrettask:			;little puss turrets in ultra force	lda PIClogic,x	asl a	asl a	clc	adc PIClogic,x			;*5 table offset	tay	lda pussturretdata,y		;x dir	sta PICdir,x	lda pussturretdata+1,y		;bullet speed x	sta PICtemp1,x	lda pussturretdata+2,y		;bullet speed y	sta PICtemp2,x				lda pussturretdata+3,y		;anim type	sta PICstatus,x	lda pussturretdata+4,y		;vdir	sta PICdirv,x		jsr setdir	jsr setdirv		lda #ufbank			sta PICbank,x		lda #2	sta PICcolor,x		lda #2	sta PICscroll,x		lda PICstatus,x	jsr initanim	jsr animborg		lda #1	sta PICsize,x		lda #5	sta PIChealth,x	;----------------	jsl TSKsuspend	lda #15	jsr shootenemy		jsr animborg		lda PICanim,x	cmp #1	bne @noshot	lda PICcount,x	cmp #1	bne @noshot		lda PICtemp2,x	tay	lda PICtemp1,x	ldx #13	jsr fire_bullet	@noshot:	rtl	pussturretdata:		;hdir, vdir, PICsize, anim	dc.b	1,8,0,pussturretside,0	dc.b	1,0,8,pussturretvert,1	dc.b	0,8,0,pussturretside,0	dc.b	1,0,-8,pussturretvert,0	;----------------------------------------armbosstask:		;remoed and saved into armboss.a					;which is currently not included;-------------------------------------------------------	fallingbricktask:		 ;ancient falling wall bricks	stz PICtype,x		lda #abank	sta PICbank,x		lda #5	sta PICcolor,x		lda #2	sta PICscroll,x		lda #5	sta PIChealth,x			lda #1	sta PICsize,x		jsl TSKsuspend		lda PICyhi,x	bne @offscreen		lda PICylo,x	cmp #120	bcc @onscreen		;below bobola@offscreen:	rtl	@onscreen:	lda #30			;just a simple timed delay....	jsl TSKwait	;----------------------			lda #falling_brick		;start anim	jsr initanim		lda #type_enemy	sta PICtype,x;-------------------------------------------------------	jsl TSKsuspend		;main loop		lda #5	jsr shootenemy		jsr animborg			;no		lda PICflag,x		;ready to drop?	bne @falling		rtl	@falling:		;bombs away...	lda #sfxfruitdrop		;eyepop	jsl soundeffects		jsl TSKsuspend		;main loop		lda #5	jsr shootenemy		lda #0	ldy #8	jsl bgcoll_longer		lda chartype	cmp #solid	bne @fall2	@splatdropper:				;kill ball	lda #5	jmp explode	@fall2	inc PICtemp1,x	lda PICtemp1,x	cmp #10	bcc @speedup		lda #10	sta PICtemp1,x	@speedup:	lsr a	sta PICmovev,x		lda PICtemp1,x	jsl PICyadd	@movedropper:@stopmove:	lda PICcollide,x	beq @missed		lda #drain1	jsl drainstrengthl	bra @splatdropper	@missed:	rtl*********************************************************************blinkenemy:			;generic routine to make enemy blink when shot				lda PIChit,x		;hit?	beq @nothit		stz PIChit,x		;clear hit flag	lda #15				;set flash value	sta PICcolorhit,x	@nothit:	rts;--------------------------------------------------------maxmutoid		equ	10		;max number of bossesmutoidcolors:			dc.b	1,3,4,5	mutoidpowerup:		;list of mutoid men powerups	dc.b	255,2,3,1,2,15,3,255,5,255mutoidxpos:	dc.b	200,77,128,170,128,64,196,90,210,150mutoidhealth		equ	18;-------------------------------mutoidbosstask:			;;mutoid skeleton alien bosses (many!)	stz bossflag2	mutoidboss2:			;2nd guy who drops in...	mutoidmain:					;control logic for all men...	stx bosstarget		lda bossflag1	sta PICthingy,x	lda PICthingy,x		;* 8	asl a	asl a	asl a	sta PICtether,x		;table offset for move sequences		lda PICthingy,x			;set colour	and #3	tay	lda mutoidcolors,y	sta PICcolor,x		;4 diff. colours		lda PICthingy,x		;no delay for last guy	cmp #maxmutoid	beq @nodelay		lda #10	sec	sbc PICthingy,x	asl a	asl a	asl a	jsl TSKwait	@nodelay:	lda #mutoidbank	sta PICbank,x		lda #mutoidhealth	sta PIChealth,x		lda #56			;was 16	sta PICsize,x		lda PICthingy,x	tay	lda mutoidxpos,y		;start xpos	sta PICxlo,x		lda #144	sta PICylo,x		lda #-1	sta PICyhi,x		stz PICxhi,x		jsr initdir	jsr setdir2	lda #manjump	jsr initanim		lda #6	sta PIClogic,x		;set entry flag		jsl TSKsuspend 		lda lockscreen				;wait for screen lock	bne @mancomeout		rtl	@mancomeout:	lda #sfxqueenscream	jsl soundeffects			;dropping in...	;-----------------------------	jsl TSKsuspend		lda PIChealth,x	asl a	sta bossstrength		lda bossflag1			;only 1 other comes out	cmp #maxmutoid-1	bcs @nomorebadguys		lda bossflag1	cmp #maxmutoid-2	bcc @one_at_atime		;keep one mutoid on at once		lda PIChealth,x	cmp #mutoidhealth/2	bcs @nomorebadguys		bra @addguy	@one_at_atime:	lda enemydie	bne @addguy		lda PIChealth,x		;if health low, send out his brother	bne @nomorebadguys@addguy:	jsl TSKsuspend		lda #type_enemy		;shchedule #2	jsl TSKschedule	dw mutoidboss2	bcs @killdude		rtl@nomorebadguys:	lda enemydie			;bombed?	bne @killdude		lda PIChealth,x			;alive ?	bne @alive	@killdude:	inc bossflag1	stz PICtype,x			;blow up mutoid	inc bossflag2	jmp @manbustopen		@alive:	jsr blinkenemy		jsr animborg; 0 = shuffle; 1 = jump, 2 = land; 3 = kick; 4 = punch; 5 = shoot	lda PIClogic,x	bne @noshuffle	jmp @shuffle@noshuffle:	cmp #1	bne @notjump	jmp @jump@notjump:	cmp #2	beq @land	cmp #3	bne @notkick	jmp @kick@notkick:	cmp #4	bne @notpunch	brl @punch@notpunch:	cmp #5	bne @notshoot	jmp @shoot@notshoot:	cmp #6	beq @entry		;enter screen		lda status	cmp #dying	bne @newattack		lda #manstand	jsr initanim	rtl	@newattack:	lda PICdirv,x	inc a	and #7	sta PICdirv,x	clc	adc PICtether,x		;add table offset for diff. guy	tay	lda mutoid_pattern,y	sta PIClogic,x	brl @nomorebadguys				;new attack...	@entry:	lda #16	jsl PICyadd	lda #8	sta PICmovev,x		lda PICyhi,x	bne @falling	lda PICylo,x	cmp #144	bcc @falling		lda #144	sta PICylo,x	lda #30	sta shakescreen		lda #sfxexplode2	jsl soundeffects		lda #2	sta PIClogic,x		;set landing	lda #manland	jsr initanim	@falling:	rtl	;--------------------------------------------------	@land:					;wait for landing to finish!	lda PICflag,x	beq @falling		lda #99	sta PIClogic,x	rtl;----------------------------------------------------	@shuffle:	lda PICstatus,x	cmp #manshuffle	beq @s1		lda #manshuffle	jsr initanim	@s1:	jsr initdir	jsr setdir2		lda #30	jsr bobzone	bcc @trackbob		lda #99				;found bob	sta PIClogic,x	rtl;---------------------------------@trackbob:	lda PICxlo,x	sbc #10	cmp bobxpos	bcs @left		lda PICxlo,x	adc #10	cmp bobxpos	bcc @right	@found:	sec	lda #99				;found bob	sta PIClogic,x	rtl			;found bob	@right:	lda #3	jsl PICxadd		lda PICxlo,x	cmp #-30	bcs @found	rtl		@left:	lda #3	jsl PICxsub	lda PICxlo,x	cmp #30	bcc @found	rtl;---------------------------------@punch:	lda PICstatus,x	cmp #manpunch	beq @p1	@tryagain:	lda status	cmp #dying	beq @toofar			;bob is dead. stop attack.		lda #manpunch	jsr initanim@p1:	jsr initdir	jsr setdir2	lda PICanim,x	cmp #9	bne @j31	lda PICcount,x	beq @j31				;at right spot		lda #type_enemy	jsl TSKschedule	dw bugstinger	bcc @j31	jsl copytask2	lda #2	sta PIClogic,y		;2 = mutoid man	lda #sfxbugsplat1	jsl soundeffects		;PUNCH SFX	@j31:	lda PICflag,x		;done yet?	beq @p2	@notnear:		@toofar:	lda #99					;done	sta PIClogic,x	rtl	@p2:	rtl;--------------------------------------------@jump:	lda PICstatus,x	cmp #manjump	beq @j1	cmp #manland	beq @jump4		jsr initdir	jsr setdir2	lda #manjump	jsr initanim	stz PICcount2,x		lda #sfxfishjump	jsl soundeffects	@j1:	lda PICflag,x	beq @donejump		lda PICcount2,x	inc PICcount2,x		;read ymove from table	tay	lda mutoidjump,y	cmp #128			;eof?	bne @jump3					;reset flight counter	stz PICcount2,x		lda #manland	jsr initanim		lda #20	sta shakescreen			;boooom!		lda #sfxeggopen	jsl soundeffects		jmp @donejump	@jump3:	jsl PICyadd		jsr @jumpxmove			;follow bob		bra @donejump	@jump4:			;wait for landing to end, then jump again	lda PICflag,x	beq @donejump		;still waiting to finish		lda #99	sta PIClogic,x		stz PICstatus,x		rtl	@donejump:	rtl	;--------------------------------------------@kick:	lda PICstatus,x	cmp #manjumpkick	beq @k1	cmp #manland	beq @kick4		lda status	cmp #dying	beq @stopkick			;bob is dead. stop attack.		jsr initdir	jsr setdir2	lda #manjumpkick	jsr initanim	stz PICcount2,x@k1:	lda PICanim,x	cmp #6	bcc @donekick		;pause before kick		cmp #12	bne @nohurt	lda PICcount,x	beq @nohurt				;at right spot		lda #type_enemy	jsl TSKschedule	dw bugstinger	bcc @nohurt	jsl copytask2	lda #3	sta PIClogic,y		;2 = mutoid man	lda #sfxbugsplat1	jsl soundeffects		;PUNCH SFX@nohurt:	lda PICcount2,x	inc PICcount2,x		;read ymove from table	tay	lda mutoidkick,y	cmp #128			;eof?	bne @kick3					;reset flight counter	stz PICcount2,x		lda #manland	jsr initanim		lda #20	sta shakescreen			;boooom!		lda #sfxeggopen	jsl soundeffects		jmp @donekick	@kick3:	jsl PICyadd		jsr @jumpxmove			;follow bob		bra @donekick	@kick4:			;wait for landing to end, then kick again	lda PICflag,x	beq @donekick		;still waiting to finish@stopkick:		lda #99	sta PIClogic,x		@donekick:	rtl;---------------------------------------------------------@shoot:	lda PICstatus,x	cmp #manshoot	beq @sh1		lda status	cmp #dying	beq @stopshot			;bob is dead. stop attack.		lda #manshoot	jsr initanim	@sh1:	jsr initdir	jsr setdir2		lda PICcount,x		;1 shot per frame	cmp #1	bne @noshoot		lda PICanim,x		;which frames to shoot on	cmp #8	beq @goshoot	cmp #11	beq @goshoot	cmp #14		bne @noshoot	@goshoot:		lda #-10	jsl PICyadd		lda PICdir,x	beq @leftshot	@rightshot:	lda #24	jsl PICxadd		lda #8	ldy #0	ldx #10	jsr fire_bullet		lda #24	jsl PICxsub		bra @resetypos@leftshot:	lda #24	jsl PICxsub		lda #8	ldy #0	ldx #10	jsr fire_bullet		lda #24	jsl PICxadd	@resetypos:	lda #10	jsl PICyadd@noshoot:	lda PICflag,x		;done yet?	beq @s2	@stopshot:	lda #99	sta PIClogic,x	@s2:	rtl;--------------------------------------------------@jumpxmove:				;move during jump	lda PICdir,x	beq @jumpleft	@jumpright:	lda PICxlo,x	cmp #-24	bcs @nofollow		lda #3	jsl PICxadd	rts	@jumpleft:	lda PICxlo,x	cmp #24	bcc @nofollow		lda #3	jsl PICxsub	@nofollow:	rts;-------------------@manbustopen:			;mutoid man death, skully thing		lda #sfxbugsplat2	jsl soundeffects		lda #manexplode	jsr initanim		jsl TSKsuspend		jsr animborg		lda PICylo,x	cmp #145	bcs @boomola		lda #4	jsl PICyadd	lda #2	sta PICmovev,x		rtl	@boomola:	lda #145	sta PICylo,x		txa				;alternate generation of powerup xpos	and #1	asl a	asl a	asl a	asl a	asl a	clc	adc #128-16	sta temp			ldy bossflag1			;drop bonus powerup	lda mutoidpowerup-1,y	bmi @none		ldy temp	jsl makepowerup2	@none:	jsl TSKsuspend		jsr animborg		lda PICflag,x	beq @waitskull		lda bossflag2	cmp #maxmutoid	bcs @skullready	@waitskull:	rtl@skullready:		;remaining skull rises to attack					;the unsuspecting bob!						;boo!	stz bosstarget		lda #100	jsl TSKwait		txa	and #15	asl a	asl a	adc #15	sta PICshake,x	lsr a	jsl TSKwait		lda #2	sta PIChealth,x	stz bossstrength		lda #0	sta PICsize,x		lda #type_enemy	sta PICtype,x		lda #2	sta PICcount2,x		;bounce table 			lda #manskull	;rise anim	jsr initanim		stz PIChit,x	;	txa;	and #7;	sta PICanim,x		lda #sfxqueenscream	jsl soundeffects		jsl TSKsuspend	jsr animborg			jsl PICxunflip	lda PICanim,x	cmp #12	bcc @noflip		jsl PICxflip	@noflip:	lda PIChealth,x	bne @safeskull		inc bosscount1			;final death counter		lda bosscount1	cmp #maxmutoid	bcc @safeskull		lda #60	sta winflag	lda #maxstrength	sta strength		jsr score25000	jsr score5000	@safeskull:		lda #14	jsr shootenemy	@getskully:	lda PICcount2,x	inc PICcount2,x	tay	lda mutoidskullbounce,y	cmp #128	bne @bounce_it		stz PICcount2,x		jsr initdir		lda #sfxfishjump	jsl soundeffects		bra @getskully	@bounce_it:	jsl PICyadd		txa	and #3	inc a	jsr movetaskx		lda PICdir,x	bne @rightbounce	@leftbounce:		lda PICxlo,x	cmp #16	bcs @goodbounce		inc PICdir,x	bra @goodbounce	@rightbounce:		lda PICxlo,x	cmp #-16	bcc @goodbounce		stz PICdir,x@goodbounce:		jsr animborg	rtl	mutoidskullbounce:	dc.b	-10,-10,-10,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,0,0,0,0	dc.b	1,2,3,4,5,6,7,8,9,10,10,10,10,128;---------------------------------------------------------------mutoidjump:	dc.b	-10,-9,-8,-8,-7,-7,-6,-6,-5,-5	dc.b	-4,-4,-3,-3,-2,-1,0	dc.b	1,2,3,3,4,4,5,5,6,6,7,7,8,8	dc.b	9,10	dc.b	128			mutoidkick:	dc.b	-7,-6,-5,-4,-3,-3,-2,-2,-1,-1	dc.b	0,0,0,0	dc.b	1,1,2,2,3,3,4,5,6,7,128	mutoid_pattern:		;attack patterns....; 0 = shuffle; 1 = jump, 2 = land; 3 = kick; 4 = punch; 5 = shoot	;#1 - shuffle, punch	dc.b 	0,4,0,4,0,4,4,4	; #2  - jump, punch	dc.b 	0,4,1,0,4,1,0,4	; #3  - add kick	dc.b 	1,0,4,3,0,1,4,0	; #4  - add shoot	dc.b 	0,4,0,5,0,5,0,4		; 5 	jump & shoot	dc.b	5,1,0,4,5,1,0,4	; 6 	jump,shoot, kick	dc.b	3,0,4,5,5,1,0,4	; 7 	jump,shoot, kick	dc.b	3,5,3,5,3,0,4,5	; 8 	jump,shoot, kick	dc.b	3,5,3,5,3,0,4,5	; 9 	jumper based	dc.b	0,3,1,3,0,3,1,3	; 10 	ground based	dc.b	0,4,5,0,5,0,5,4		;;-----------------------------------------------------pussvolcanotask:	;floor-based pussball volcano	;drop interval timer is PIClogic		lda PIClogic,x	adc #8	sta PICtemp2,x		;make 6 drops after count		lda #7	sta PIChealth,x		lda #2	sta PICscroll,x		lda #1	sta PICsize,x	lda #ufbank	sta PICbank,x		lda #4	sta PICcolor,x		lda #pussdropper	jsr initanim	jsr animborg		jsl PICyflip	;-----------------	jsl TSKsuspend				lda #16	jsr shootenemy		jsr animborg		inc PICcount2,x	lda PICcount2,x	cmp PIClogic,x		;drop interval timer is PIClogic	bcc @nopuss		;not time yet		cmp PICtemp2,x	bcc @dropmore		;drop a stream of 6		stz PICcount2,x	@dropmore:	lda PICcount2,x	and #1	bne @notasks		;make every 2nd cycle		lda PICcount2,x	and #7	clc	sta PICdir,x		lda PICyhi,x	bne @notasks		lda #type_enemy	jsl TSKschedule	dw up_pussballtask			bcc @notasks		jsl copytask	@notasks:@nopuss:	rtl	;---------------------------------------------up_pussballtask:		;balls that drops from wee pussdropper	lda #8	jsl PICxadd		lda #1	sta PIChealth,x	sta PICscroll,x		lda #0	sta PICsize,x	lda #ufbank	sta PICbank,x		lda #4	sta PICcolor,x		stz PICcount2,x		lda #pussdrop	jsr initanim	jsr animborg		stz PICtemp2,x	;-----------------	jsl TSKsuspend				lda #15				jsr shootenemy		jsr animborg		lda PICtemp2,x	inc PICtemp2,x	tay	lda pussballymove,y	cmp #10	bne @moveball		;max velocity?		dec PICtemp2,x	lda #2	sta PICscroll,x	lda #5	sta PICmovev,x	lda #10@moveball:	jsl PICyadd	@no_float	lda PICdir,x	sbc #3	jsl PICxadd	lda #0	ldy #8	jsl bgcoll_longer		lda chartype	cmp #solid	bne @fall2	@splatdropper:				;kill dropper	lda #15				;spalt w/o bits (for speed concerns)			jmp explode	@fall2	@notready:	lda PICcollide,x	beq @nothit		lda #drain1	jsl drainstrengthl	bra @splatdropper	@nothit:	rtl	pussballymove:	dc.b    -10,-10,-10,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,0,0	dc.b	1,2,3,4,5,6,7,8,9,10;-------------------------------------------------------------;---------------------------------------------------------------virus_delay		equ	5		;wait while offscreenvirus_zoomout	equ	1		;special PIClogic flags for virusvirus_zoomin	equ	2		;zoom invirus_right		equ	3		;fly by rightvirus_left		equ	4		;fly by leftvirus_up		equ	5		;fly by upvirus_down		equ	6		;fly by downvirus_bounce	equ	7		;bounce aroundvirus_stick		equ	8		;stick to edges of screenvirus_change	equ	9		;change attackvirus_centre	equ	10		;centre itself in middle of screenvirus_shoot1	equ	11		;shoot in a circlevirus_shoot2	equ	12		;shoot at bob in final formvirus_circle	equ	13		;circle around in distancevirusspeedx		equ	12		;x flight speedvirusspeedy		equ	10		;y speedfvspeed			equ	1		;final boss speed;---------------------fvirushealth	equ	128		;final virus healthvirustask:			;the final ultra force boss-a-ronia!!!!!!	stx bosstarget		stz powerupflag		lda #3	ldy #-32	jsl makepowerup2	lda #120	jsl TSKwait		lda vpos2	adc #18	sta vpos2		lda #virusbank	sta PICbank,x		lda #127			sta PIChealth,x		lda #3				;only shoot at centre!	sta PICsize,x		lda #128	ldy #60	jsl PICxyset		lda #3	sta PICcolor,x		lda #viruszoomin	jsr initanim		lda #virus_zoomin	jsr initvirus		inc bossflag1			;make sure virus does full attacks		;-----------------------------@mainvirusloop:	jsl TSKsuspend		lda PIChealth,x	bne @alive		inc bossflag2		;is boss in first or second stage?		lda bossflag2	cmp #2	bne @notdeath1		jmp @killthefucker		;the end	@notdeath1:		lda #virus_bounce		;little bouncy motherfucker	jsr initvirus		lda #virusturnfinal	jsr initanim		lda #64	sta PIChealth,x		stz PICtemp1,x		lda #60	sta PICcount2,x		lda #40	sta PICshake,x	sta PICcolorhit,x		lda #1					;more powerups!	ldy #32	jsl makepowerup2	lda #15	ldy #128	jsl makepowerup2	lda #3	ldy #-32	jsl makepowerup2	jmp @done;;;;;;;;;;;;;;;;;;;	@alive:	lda PIChealth,x		;display boss strength	lsr a	sta bossstrength		lda PIChit,x			;been shot?	beq @nohits		lda lasthealth		;make a sound?	sec	sbc PIChealth,x	cmp #10	bcc @nohurtsound		lda #sfxcluster			;hurt sound	jsl soundeffects		jsr makebits	lda PIChealth,x	sta lasthealth	@nohurtsound:	jsr blinkenemy				;blinky!!!!		@nohits:				;give a shield powerup?				lda PIChealth,x	cmp #100	bcs @nope		lda powerupflag	cmp #0	bne @nope		inc powerupflag		lda bobxpos	eor $ff	tay	lda #15	jsl makepowerup2	@nope:	lda PIChealth,x			;wave gun ?	cmp #64	bcs @nope2		lda powerupflag	cmp #1	bne @nope2		inc powerupflag		lda bobxpos	eor $ff	tay	lda #7	jsl makepowerup2	@nope2:	lda PICstatus,x	pha	jsr animvirus	jsr animborg	pla	sta PICstatus,x	; main movement logic	lda PICcount2,x			;pause?	beq @nowait		dec PICcount2,x	jmp @done				;waiting for new movement	@nowait:	lda PIClogic,x			;what flight pattern?	cmp #virus_right	bne @notright	jmp @right@notright:	cmp #virus_left	bne @notleft	jmp @left@notleft:	cmp #virus_up	bne @notup	jmp @up@notup:	cmp #virus_down	bne @notdown	jmp @down@notdown:	cmp #virus_zoomin	bne @notzoomin	jmp @zoomin@notzoomin:	cmp #virus_zoomout	bne @not_zoomout	jmp @zoomout@not_zoomout:	cmp #virus_shoot1	bne @notshoot1	jmp @shoot1@notshoot1:	cmp #virus_shoot2	bne @notshoot2	jmp @shoot2@notshoot2:	cmp #virus_bounce	bne @notbounce	jmp @bounce@notbounce:	cmp #virus_circle	bne @notcircle	jmp @circle@notcircle:	jmp @done;-------------------@circle:	;circle around in distance and fire at bob	lda PICtemp1,x		inc PICtemp1,x		lsr a	and #15	tay	phy	lda viruscircledata_x,y	jsl PICxadd		ply	lda viruscircledata_y,y	jsl PICyadd		lda PICtemp1,x	cmp #40	bcc @morecircle		;wait a bit to start shooting	cmp #225	bcs @noshot			;wait a bit after shooting too...		and #7	bne @noshot		lda PIChealth,x	cmp #100	bcs @finish_circle		lda enemyblind	bne @noshot		lda #type_enemy	jsl TSKschedule	dw virus3dbullettask		;fire a bullet	bcc @noshot			;no tasks!	jsl copytask2	@noshot:	lda PICtemp1,x	cmp #250	bcc @morecircle	@finish_circle:	lda #virus_zoomin	jsr initvirus		lda #viruszoomin	jsr initanim	lda #sfxqueenscream		;in sound	jsl soundeffects	@morecircle:	jmp @done;-------------------------------	@bounce:	stz PICtemp1,x		lda bosscount1	cmp #250	bcs @maxspeed		inc bosscount1		lda bosscount2	beq @maxspeed		inc bosscount1	inc bosscount1	inc bosscount1	@maxspeed:	lda bosscount1	lsr a	lsr a	lsr a	sta temp+4		ldy	PICdir,x	bne	@rightfire@leftfire:		lda #1	jsr knockbob		lda temp+4	jsl	PICxsub		bra @movey	@rightfire:		lda #2	jsr knockbob		lda temp+4	jsl	PICxadd	@movey	lda PICdirv,x	bne @bdown	@bup:	lda #0	jsr knockbob		lda temp+4	jsl PICysub	bra @bounce2	@bdown	lda #3	jsr knockbob		lda temp+4	jsl PICyadd	@bounce2:	lda PICxhi,x	cmp #-1	beq @settoleft		lda PICxlo,x	cmp #32	bcs @b1	@settoleft:	stz PICxhi,x		lda #32	sta PICxlo,x		lda #sfxdrip	jsl soundeffects	lda #1	sta PICdir,x@b1:	lda PICxhi,x	cmp #1	beq @settoright		lda PICxlo,x	cmp #-32	bcc @b2	@settoright:	stz PICxhi,x		lda #-32	sta PICxlo,x	lda #sfxdrip	jsl soundeffects	lda #0	sta PICdir,x	@b2:	lda PICdirv,x	cmp #1	beq @justgodown			;if coming from top of screen, leave ypos		lda PICylo,x	cmp #32	bcs @b3		lda PICyhi,x		;if offscreen ,send back onscreen	bne @justgodown		lda #32	sta PICylo,x	lda #10	sta shakescreen		lda #sfxdrip	jsl soundeffects	inc PICtemp1,x		;when it hits top of screen, attack@justgodown:	lda #1	sta PICdirv,x	@b3	lda PICylo,x	cmp #160	bcc @b4		lda PICyhi,x	bne @b4				;if off top, ignore		lda #160	sta PICylo,x	lda #10	sta shakescreen		lda #sfxdrip	jsl soundeffects	lda #0	sta PICdirv,x	@b4	lda PICtemp1,x		;stuck at top? if yes, fire down	bne	@stick	@notstick:	jmp @done@stick:	stz PICtemp1,x	;	lda PIChealth,x		;only fire when health  gets lower;	cmp #100;	bcs @notstick		lda bosscount1	cmp #250	bcc @notstick			;must be at max speed too				;init virus to make some shots...				lda #sfxegg			;stick to wall sound	jsl soundeffects	lda #sfxbugsplat1		;stick to wall sound	jsl soundeffects	lda #virusshoot	jsr initanim		lda #virus_shoot2	jsr initvirus		stz bosscount1			;reset speed after shots		lda #1	sta bosscount2			;all other bouncing now accel faster		jmp @done;---------------------@shoot1:			;shoot in circular pattern					;then attack			stz temp		;centred flag. 0= ready to attack		lda PICylo,x	cmp #36	bcc @ready1		lda #2	jsl PICysub	inc temp	@ready1:	jsr centretaskx	bcs @killbob		inc temp	@killbob:	lda temp	bne @poguehead		;still not centred so wait....			lda #10			;wait between shots	sta PICcount2,x		lda PICtemp1,x	tay	lda vshoot1dir,y	sta PICdir,x	lda vshoot1speed,y	sta tmp	lda vshoot1y,y	tay	lda tmp	ldx #18	jsr fire_bullet		inc PICtemp1,x	lda PICtemp1,x	cmp #10	bne @poguehead	@doneshoot1:	inc bosscount1		;new direction		lda bosscount1	and #1	sta PICdir,x	beq @startleft	@startright:	lda #virus_right	bra @getgoing@startleft:	lda #virus_left@getgoing:	jsr initvirus	;	lda #15;	sta PICcount2,x		lda #sfxqueenscream	jsl soundeffects	stz PICtemp1,x	stz PICthingy,x	@poguehead:	jmp @done	;---------------------@shoot2:			;shoot in final form			jsr initdir		lda PICflag,x	bne @reload		lda PICanim,x	cmp #4	bne @poguehead2		lda enemyblind			;bulb stops fire	bne @poguehead2		lda PICcount,x	cmp #1	bne @poguehead2		lda PICtemp1,x	ldy #16	ldx #18	jsr fire_bullet					jmp @done	@reload:	inc PICtemp1,x	lda PICtemp1,x	cmp #3	bcs @doneshoot2		lda #virusshoot	jsr initanim	jmp @done	@doneshoot2:	lda #virus_bounce	jsr initvirus		lda #virusturnfinal	jsr initanim		lda #10	sta PICcount2,x		stz PICtemp1,x	@poguehead2:	jmp @done;---------------------------------					@right:	lda #2	sta PICdir,x	jsr knockbob		lda #virusspeedx	jsl PICxadd	lda #virusspeedx/2	sta PICmoveh,x		lda PICxhi,x	cmp #1	beq @changeleft	@right2:	jmp @done	@changeleft:	lda PICxlo,x	cmp #64	bcc @right2		stz PICyhi,x	lda PICylo,x	adc #48	sta PICylo,x	lda #virus_left	jsr initvirus		lda #sfxqueenscream	jsl soundeffects	stz PICthingy,x	inc PICtemp1,x	lda PICtemp1,x	cmp #4	bcc @ngaw		jmp @go_away	@ngaw	jmp @done;------------	@left:	stz PICdir,x		lda #1	jsr knockbob		lda #virusspeedx	jsl PICxsub	lda #-virusspeedx/2	sta PICmoveh,x		lda PICxhi,x	cmp #-1	beq @changeright@left2:		jmp @done	@changeright:	lda PICxlo,x	cmp #-64	bcs @left2		stz PICyhi,x	lda PICylo,x	adc #48	sta PICylo,x		lda #virus_right	jsr initvirus	stz PICthingy,x	lda #sfxqueenscream	jsl soundeffects		inc PICtemp1,x	lda PICtemp1,x	cmp #4	bcs @go_away		jmp @done	@go_away:	stz PICtemp1,x		inc bossflag1	lda bossflag1	and #1	bne @zoomtime		;zoom out?		lda #virus_up		;down			;go up/down	jsr initvirus	lda #sfxqueenscream	jsl soundeffects		lda #1				;get under bob	sta PICyhi,x	lda #80	sta PICylo,x	stz PICxhi,x	lda bobxpos	sta PICxlo,x		jmp @done	@zoomtime:					;zoom out	lda #virus_zoomout	jsr initvirus			lda #sfxqueenscream	;out sound	jsl soundeffects		jmp @done	;--------------------@up:	lda #0	jsr knockbob	lda #virusspeedy	jsl PICysub	lda #-virusspeedy/2	sta PICmovev,x		lda PICyhi,x	cmp #-1	beq @changedown	@up2	jmp @done	@changedown:	lda PICylo,x		;make sure virus is totally offscreen	cmp #-64	bcs @up2		stz PICxhi,x		;track bob	lda bobxpos	sta PICxlo,x		lda #virus_down	jsr initvirus	lda #sfxqueenscream	jsl soundeffects	stz PICthingy,x		inc PICtemp1,x	lda PICtemp1,x	cmp #5	bcs @go_away		jmp @done;--------------------@down:	lda #3	jsr knockbob	lda #virusspeedy	jsl PICyadd	lda #virusspeedy/2	sta PICmovev,x		lda PICyhi,x	cmp #1	beq @changeup		jmp @done	@changeup:	stz PICxhi,x		;track bob	lda bobxpos	sta PICxlo,x		lda #virus_up	jsr initvirus	lda #sfxqueenscream	jsl soundeffects	stz PICthingy,x		inc PICtemp1,x	lda PICtemp1,x	cmp #5	bcc @cu2		jmp @go_away	@cu2:		jmp @done;---------------------@zoomout:		stz temp	@zo3:	lda PICyhi,x		;centre ypos	bmi @zdown	bne @zup	lda PICylo,x	cmp #40	bcc @zdown	cmp #48	bcs @zup		bra @doneyc	@zup:	lda #-4	bra @yc2@zdown:	lda #4@yc2:	jsl PICyadd	inc temp	@doneyc:	jsr centretaskx	jsr centretaskx	bcc @notcentre		lda temp	bne @notcentre		;must also be centred vetically...		lda PICstatus,x	cmp #viruszoomout	beq @skipzoom2		stz PICtype,x		;make invincible	lda #viruszoomout	jsr initanim		lda #sfxqueenscream	jsl soundeffects	@skipzoom2:	lda PICflag,x	beq @notcentre		;done shrink?		lda #virusturntiny	jsr initanim	lda #virus_circle		;now start 3d attack	jsr initvirus	stz PICtemp1,x	@notcentre:	bra @done	;------------------------@zoomin:		lda PICanim,x	jsl PICysub		lda PICflag,x			;fulley emerged?	beq @done		lda #type_enemy			;yes!	sta PICtype,x		;make shootable	lda #virus_shoot1		;attack!	jsr initvirus		stz PICtemp1,x		lda #virusturn1	jsr initanim	bra @done	;------------------------------	@done:	stz PICcollide,x		rtl	;--------------------------------@killthefucker:		stz bossstrength		lda #sfxqueenscream	jsl soundeffects		lda #60	sta PICshake,x	sta PICcolorhit,x	lsr a	jsl TSKwait		lda #16	sta PICtemp1,x	;drop dead boss to floor		jsl PICput	dw virusf15		jsl TSKsuspend		inc PICtemp1,x		lda PICtemp1,x	;accelerate falling	lsr a	lsr a	jsl PICyadd		lda PICylo,x	;at bottom?	cmp #170	bcs @hitbottom		rtl	@hitbottom:	lda #sfxbugsplat1	jsl soundeffects	lda #170	sta PICylo,x		lda #15	sta shakescreen		;boing!		lda #1	sta virusbossflag		;keep pause from happening		lda #34			;load in big body	sta sdmaflag	stz sdmacount		lda #90			;wait	jsl TSKwait		lda #15			;shake a bit	sta PICshake,x		lda #60+60+15			;wait after jiggle	jsl TSKwait		lda #1	jsl makepowerup		lda #30			;shake a bit more	sta PICshake,x		lda #30+90			;wait after jiggle	jsl TSKwait		lda #60			;shake a lot	sta PICshake,x		lda #30	jsl TSKwait		lda #sfxqueenscream	jsl soundeffects		lda #15					;more powerups!	ldy #32	jsl makepowerup2;	lda #15;	ldy #128;	jsl makepowerup2	lda #6	ldy #-32	jsl makepowerup2	lda #4	sta PICcolor,x	jsl PICput		;starts to grow large	dw virus2f0		lda #24	jsl PICysub	jsl TSKsuspend		lda #20	jsl PICysub	jsl TSKsuspend		lda #16	jsl PICysub	jsl TSKsuspend		jsl PICput		;starts to grow large	dw virus2f1	lda #12	jsl PICysub	jsl TSKsuspend		lda #8	jsl PICysub	jsl TSKsuspend		lda #6	jsl PICysub	jsl TSKsuspend		lda #3	jsl PICysub	jsl TSKsuspend	lda #1	jsl PICysub	jsl TSKsuspend	lda #fvirushealth	sta PIChealth,x		;reset health			lda #57	sta PICsize,x		;full grown virus guy	;	lda #type_enemy		;make dangerous again;	sta PICtype,x		lda #36			;now load in remaining body bits	sta sdmaflag	stz sdmacount	stz PICcount2,x	stz PIChit,x	lda #1	sta PICflag,x	;----------------------	lda #4	jsl TSKwait	;	jsr floattask		;make virus float	lda #3	jsl PICysub		lda PICylo,x	cmp #28	bcc @attop		jmp @nomine	@attop:	jsl TSKsuspend		;new attack logic	;-------------------; attack in final form	jsr floattask		;make virus float		jsr centretaskx	jsr centretaskx	bcs @finalattack		jmp @nomine	@finalattack:;---------------------------	stz bossflag1				;attack flag	stz PICdirv,x				;drop dir	stz bossflag2		lda #virus_float	jsr initanim		jsl TSKsuspend		jsl PICxunflip	 	lda PICstatus,x	cmp #virus_dropmine	bne @nmi	;	lda PICflag,x;	beq @startattack		;stop during mine fire@nmi:		lda PIChealth,x	cmp #fvirushealth/2	bcs @ignoreme		lda bossflag1			;stop when punching?	bne @startattack	@ignoreme:	lda PICfloat,x	inc a	cmp #24	bcc @okf	lda #0@okf:	sta PICfloat,x	tay	lda virusfloat,y	jsl PICyadd	lda #8	jsr movetaskx	@startattack:	lda PICxlo,x			;check edges	cmp #-32	bcs @turnleft	cmp #32	bcs @setx		lda #32	sta PICxlo,x	lda #1	sta PICdir,x	bra @setx	@turnleft:	lda #-32	sta PICxlo,x	stz PICdir,x	@setx:		lda PIChealth,x			;which attack to use?	cmp #fvirushealth/2	bcc @vpunch		@dropmine:	lda enemyblind	bne @nomine						lda PICstatus,x	cmp #virus_dropmine	beq @timeformine				;already dropped		inc PICcount2,x		;drop a mine?	lda PICcount2,x	cmp #11	bcc @nomine		stz PICcount2,x		lda #virus_dropmine	jsr initanim	@timeformine:	lda PICanim,x	cmp #4	bne @nomine	lda PICcount,x	bne @nomine		lda #type_enemy	jsl TSKschedule	dw virusminetask	bcc @nomine	jsl copytask	lda #sfxdrip	jsl soundeffects	@nomine:	lda PICflag,x	beq @gosk	lda #virus_float	jsr initanim	@gosk:	jmp @skipover;-----------------------@vpunch:			;punch left or right		lda bossflag1	cmp #1	beq @swoopdown			;1=swoop down	cmp #2	beq @canpunch		;2=punch	cmp #3	beq @swoopup		;3=back up	; no attack, then count until ready....	inc PICcount2,x			lda PICcount2,x	cmp #20	bcs @comedown	@stayup:	jmp @skipover	@comedown:	dec PICcount2,x			;keep at 20		lda #64	jsr bobzone	bcc @stayup			;only if in range		stz PICcount2,x		inc bossflag1	bra @swoopdown	@swoopup:	lda #2	jsr movetaskx	lda PICylo,x			;back at top?	cmp #24	bcc @endswoop		lda #8	jsl PICysub	jmp @skipover	@endswoop:	lda #24	sta PICylo,x	stz PICfloat,x	stz bossflag1		jmp @skipover	@swoopdown:	jsr initdir	lda #48	jsr bobzone	bcs @find		lda #4	jsr movetaskx@find:		lda PICyhi,x	bmi @sd2	lda PICylo,x	cmp #130	bcs @atbottom			;ready to attack	@sd2:	lda #12	jsl PICyadd	bra @skipover	@atbottom:	lda #2	sta bossflag1		@canpunch:	lda PICstatus,x	cmp #virus_punchright	beq @vp2	cmp #virus_punchleft	beq @vp2	jsr initdir		lda PICdir,x	sta viruspdir	bne @initr		lda #virus_punchleft	bra @initp@initr:	lda #virus_punchright@initp:	jsr initanim	@vp2:	lda PICanim,x	cmp #2	bne @vp3	lda PICcount,x	cmp #1	bne @vp3		lda #type_enemy	jsl TSKschedule	dw viruspunchtask	jsl copytask2		lda #sfxdrip	jsl soundeffects	@vp3:	jsr floattask		lda PICflag,x	beq @vp4		lda #3	sta bossflag1		lda #virus_float	jsr initanim	@vp4:@skipover:	lda PIChealth,x	lsr a	sta bossstrength		lda PIChealth,x	beq @finaldeath		;finally!!! dead virus!		jsr blinkenemy	jsr animborg		jsr setbosspos		rtl	@finaldeath:;;;	stz PICtype,x		lda #virus_freak		;virus freaks out!!!!	jsr initanim	lda #30	sta PICcolorhit,x		lda #60	sta PICcount2,x			;final freak counter;-----------------	jsl TSKsuspend		lda TSKclock	sta PICshake,x			;keep shaking		jsr animborg		lda PICylo,x	cmp #112	beq	@readytodie	bcc @lowerdie		lda #1	jsl PICysub	jsr centretaskx	rtl	@lowerdie:	lda #1	jsl PICyadd	jsr centretaskx	rtl;-------------------------@readytodie:					;virus final, final death	jsr centretaskx		;make sure in centre too	bcs @rd2		rtl	@rd2:		dec PICcount2,x			;hold freak a bit longer	lda PICcount2,x	beq @rd3		rtl	@rd3:		lda #45	sta PICshake,x		jsl PICput	dw virus2f14		lda #32	sta sdmaflag	stz sdmacount		;bank in death stuff		lda #30	jsl TSKwait		lda #30	sta shakescreen		lda #type_enemy	jsl TSKschedule	dw virusdeathtask		;make other part of virus death	jsl copytask		lda #virus_death1	jsr initanim		lda #sfxqueenscream	jsl soundeffects	lda #sfxexplode2	jsl soundeffects	lda #sfxcellmanfire	jsl soundeffects	jsl TSKsuspend			lda #5	sta PICcolor,x	playvirusdeath:	jsl TSKsuspend		lda #10	sta PICbank,x		;change PICbank		jsr animborg	lda PICanim,x	and #3	bne @nosound	lda PICcount,x	bne @nosound		lda #sfxbugsplat1	jsl soundeffects	@nosound:	lda PICflag,x	beq vdying		lda #120	sta winflag	lda #maxstrength	sta strength		jsr score25000	jsr score25000	lda #sfxqueenscream	jsl soundeffects	lda #sfxexplode2	jsl soundeffects	lda #sfxcellmanfire	jsl soundeffects	lda #30	sta shakescreen	jsl TSKcancel	vdying:	rtl;----------------------virusfloat:	dc.b	8,6,4,2,1,0,0,-1,-2,-4,-6,-8,-8,-6,-4,-2,-1,0,0,1,2,4,6,8;-------------------------------------------------------knockbob:		;blown away by virus?	sta temp		lda PICthingy,x	beq @knockhim		dec PICthingy,x		;delay for safety	rts	@knockhim:	lda PICcollide,x		;hit by virus?	beq @nothit		lda status	cmp #windblown	beq @nothit			;only once		lda	#windblown	sta	status	lda	#5	sta	startblowing	lda temp	sta blowdir		lda #3	jsl drainstrengthl	lda #20	sta PICthingy,x			;delay between knocks@nothit:		rts;-------------------------------------------------------viruspunchtask:		;virus arm punch extension	lda #virusbank	sta PICbank,x			lda #58				;wide collision range	sta PICsize,x		lda viruspdir			;which arm?	bne @rightarm		jsl PICput	dw virus2f16	lda #-64	bra @setarm	@rightarm:	jsl PICput	dw virus2f15	lda #64	@setarm:	sta PICtemp1,x		;save offset for later....	ldy #0	jsr getbosspos	lda #type_enemy	sta PICtype,x			jsl TSKsuspend		lda viruspdir	inc a	jsr knockbob		lda PICtemp1,x	ldy #0	jsr getbosspos		lda #type_enemy	sta PICtype,x	jsl TSKsuspend		lda viruspdir	inc a	jsr knockbob	jsl TSKcancel	rtl	;-------------------------------------------------------virusdeathtask:		;play overlay of virus death frames		lda #virus_death2	jsr initanim		lda #4	sta PICcolor,x	jmp playvirusdeath	;----------------------------------------------------virus3dbullettask:		;fire a bullet	inc bosscount1			;bullet dir counter		lda bosscount1	and #7				sta PICtemp2,x	asl a	tay	lda v3db_dir,y	sta PICdir,x	lda v3db_dir+1,y	sta PICdirv,x			stz PICtype,x		lda #virusbank	sta PICbank,x		lda #3				;only shoot at centre!	sta PICsize,x		lda #7	sta PICcolor,x		lda #virus3dbullet	jsr initanim		lda #3	sta PICscroll,x	;-----------------------------	lda #2	sta PIChealth,x		lda #sfxworker	jsl soundeffects		jsl TSKsuspend		lda enemyblind	bne @donexmove		;freeze attack		jsr animborg		lda PICdirv,x	bne @down3d	@up3d:	lda PICanim,x	lsr a	jsl PICysub	bra @donev3d	@down3d:	lda PICanim,x	lsr a		lsr a		jsl PICyadd@donev3d:	lda PICtemp2,x	;make diff. patterns	and #1	bne @narrow		;wide or narrow shot?	@wide:	lda PICanim,x	lsr a	lsr a	lsr a	jsr movetaskx	bra @donexmove@narrow:	lda PICanim,x	lsr a	lsr a	jsr movetaskx	bra @donexmove	@donexmove:	lda PICanim,x		;can bullet hit bob yet (at full size?)	cmp #8+6	bcc @bulletok			;no, too small to hit bob		lda #type_enemy	sta PICtype,x			;yes	lda #1	sta PICprior,x			;make foreground		lda #26	jsr shootenemy		lda PICcollide,x	beq @bulletok			lda #drain1	jsl drainstrengthl		lda #26		; explode	jmp explode@bulletok:	rtl	v3db_dir:		;h,v dir of bullet	dc.b	0,1		;	dc.b	0,1		;	dc.b	1,1	dc.b	1,1	dc.b	0,1		;	dc.b	1,1		;	dc.b	0,1	dc.b	1,1;;---------------------------------------------------------virusminetask:		;slow dropping virus mine	lda #66	jsl PICyadd		lda #virusbank	sta PICbank,x		lda #1					sta PICsize,x	sta PICprior,x			lda #4	sta PICcolor,x	lda #5	sta PIChealth,x		jsl PICput	dw virus2f4		lda #3	sta PICscroll,x	;-----------------------------	jsl TSKsuspend	lda #26	jsr shootenemy		lda PICtemp2,x	lsr a	jsl PICyadd		lda PICylo,x	cmp #175	bcc @dropdown		lda #175			;at bottom	sta PICylo,x	inc PICcount2,x	bra @noflip	@dropdown:	inc PICtemp2,x		jsl PICxunflip		lda TSKclock	and #2	bne @noflip		jsl PICxflip	@noflip:	lda PICcount2,x	cmp #60	bcs @selfdest		;timed blow up?	cmp #50	bne @noshake		lda #30	sta PICshake,x	@noshake:	lda PICcollide,x	;or hit bob?	beq @nohit		lda #drain1	jsl drainstrengthl	@selfdest:	lda #26	jmp explode	@nohit:		rtl;------------------------------------------------centretaskx:		;routine to centre task xpos					;clc = not centered										;sec = centered			lda PICxhi,x	bmi @right	bne @left		lda PICxlo,x	cmp #128	beq @donex		lda PICxlo,x	bpl @right	@left:	lda #1	jsl PICxsub	clc	rts	@right:	lda #1	jsl PICxadd	clc	rts	@donex:	sec	rts;-----------------------------------------------------------;-------------------------------	vshoot1dir:	dc.b	0,0,0,1,1,1,1,0,0,0vshoot1speed:	dc.b	6,3,0,3,6,5,2,1,4,7vshoot1y:	dc.b	4,6,8,6,4,4,6,8,6,4	viruscircledata_x:		;circle virus xoff	dc.b	2,2,2,2,0,0,-2,-2,-2,-2	dc.b	-2,-2,0,0,2,2	viruscircledata_y:		;circle virus yoff	dc.b	0,0,2,2,2,2,2,2,0,0	dc.b	-2,-2,-2,-2,-2,-2	;-----------------------------------------------initvirus:				;set new virus flight path...	sta PIClogic,x		lda #5					;virus_delay	sta PICcount2,x	rts;----------------------------------------animvirus:		;make sure virus is in correct size	lda PICstatus,x	cmp #virusturntiny		;if tiny, only 1 size!	beq @tinyanim		lda bossflag2			;don't change last guy!	bne @keepsame		lda PIChealth,x		;health / 64		lsr a	lsr a	lsr a	lsr a	lsr a		and #3	eor #3		clc	adc PICstatus,x		sta PICstatus,x	@keepsame:	rts	@tinyanim:	jsl PICxunflip		lda TSKclock	and #2	bne @noflip		jsl PICxflip	@noflip:	rts	;---------------------------------------------------floattask:		;make task float in a lifelife way	inc PICfloat,x		lda PICfloat,x	and #15	tay	lda taskfloatdata,y	jsl PICyadd	rts	floattaskx:		;make task xfloat in a lifelife way	inc PICfloat,x		lda PICfloat,x	and #15	tay	lda taskfloatdata,y	jsl PICxadd	rtstaskfloatdata:	dc.b	0,1,2,3,2,1,0,0,-1,-2,-3,-2,-1,0,0,0	;	dc.b	0,1,0,1,1,0,1,0,0,-1,0,-1,-1,0,-1,0	;---------------------------------------------------fireballtask:	lda #2	sta PICscroll,x		lda PICyhi,x			;always start from top of screen...	bmi @onscreen		rtl	@onscreen:		lda #3	sta PIChealth,x		lda #6	sta PICcolor,x		lda #abank	sta PICbank,x		lda #fireball	jsr initanim		jsr initdir	jsr setdir	jsl	TSKsuspend;----------------------------		lda #6	jsr shootenemy		jsr animborg		lda PICcollide,x	beq @notnear		lda #drain1	jsl drainstrengthl	@killbullet:	lda #7				;small fire explode	jmp explode	@notnear:		lda #2	jsr movetaskx			lda #5	jsl PICyadd	lda #3	sta PICmovev,x		rtl	;--------------------------------------movetaskx:		;generic move xpos routines	sta temp		;A holds x speed		lda PICdir,x	;right or left?	bne @right	@left:	lda temp	jsl PICxsub	lda temp	lsr a	beq @done	sec	sbc #1	eor $ff@done:	sta PICmoveh,x		;set picmoveh negative	rts	@right:	lda temp	jsl PICxadd		lda temp	lsr a	sta PICmoveh,x	rts	;-------------------------------------------------------------	** to be called from borg bank..*makepowerup2:			;this one sets its own xpos	sta temp	tya	sta temp+1	bra zxc	makepowerup:			;this one gets task's xpos	sta temp	lda PICxlo,x	sta temp+1zxc:		phb	lda	#7	pha		plb	lda	#type_item	jsl	TSKschedule	dw	bossitem	bcc	@noitem	pha		inc slotnumber		;auto inc powerups	lda slotnumber	cmp #3	bcc @okslot		stz slotnumber	@okslot:	pla	tay		lda	#7						sta	TSKbank,y	lda	slotnumber			sta	PICed,y			;which of 3 slots	lda	temp	sta	PIClogic,y		;which power up (refer to intro.asm - box)	lda	temp+1		sta	PICxlo,y		;screen pos...	lda	#70	sta	PICylo,y		;always high up!	@noitem:	plb	rtl		** item shows up during boss encounter*	bossitem:	lda #45	jsl TSKwait	inc PICprior,x		lda	#13				;pics are here..	sta	PICbank,x	stz	PICtype,x		lda	PICed,x			;get passed slot...	tay	lda	#1	sta	dmabox0,y		;slot is occupied	lda	PIClogic,x	sta	itemin0,y		;with what	tya		sta	PICanim,x		;save slot	stz	PICvomit,x	jsl	TSKsuspend	stz	PICadrLo,x	stz	PICadrHi,x		lda	PICcount,x	cmp	#20	bcs	@in	and	#2	bne	@draw	bra	@nodraw@in:	cmp	#100	bcc	@draw	and	#1	beq	@nodraw	@draw:	jsl	drawitem@nodraw:** countdown timer*	inc	PICcount,x	lda	PICcount,x	cmp	#120	bcc	@fine		lda	PICanim,x			;clear the slot	tay	lda	#0	sta	dmabox0,y	sta	itemin0,y	jml	TSKcancel		** else continue....*@fine:	lda	PICvomit,x	beq	@lookforpickup** else explode...*	lda	PICanim,x			;clear the slot	tay	lda	#0	sta	dmabox0,y	sta	itemin0,y		lda	#3	sta	PICscroll,x	lda	#7	sta	TSKbank,x	lda	#13	pha	jml	longexplode** see if bob runs by*@lookforpickup:	lda	status	cmp	#walking			;dead or dying	bcc	@notyet	jsl	pickupitem	bcc	@notyet	lda	#SFXpickup			;was pickup but sound fucked up!	jsl	soundeffects	jsl	powerupbob@notyet:	rtl;------------------------------------------------------	score25000:	jsr score5000score20000:	jsr score5000score15000:	jsr score5000score10000:	jsr score5000score5000:	lda #4	jsl addscore	rts	