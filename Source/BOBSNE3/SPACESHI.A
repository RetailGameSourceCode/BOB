** module to handle space ship*SHIPMAXUP		EQU	-3SHIPMAXDOWN		EQU	3SHIPMAXLEFT		EQU	-4SHIPMAXRIGHT	EQU	4SHIPYDECEL		EQU	3SHIPXDECEL		EQU	3SHIPYACCEL		EQU	3SHIPXACCEL		EQU	3SHIPXLEFT		EQU	-16SHIPXRIGHT		EQU	16SHIPYTOP		EQU	-24SHIPYBOTTOM		EQU	24TAKEOFFTIME		EQU	60	** task lock guy*bossguy:	lda	status	cmp	#stopping	bne	@fine	lda	#walking	sta	status@fine:	stz	beatboss		lda	#1	sta	centrescroll	lda	#64+12			;distance to scroll left	sta	centrescrx		stz	centreydir		;scroll down		lda	PICylo,x		;128 is norm	cmp	#128+50+8	bcs	@otherdir	sta	temp	lda	#128+50+8	sec	sbc	temp	and	#$fe	sta	centrescry	jmp	@waithere@otherdir:	sec	sbc	#128+50+8	and	#$fe	sta	centrescry	inc	centreydir@waithere:	jsl	TSKsuspend	lda	beatboss	bne	@over	rtl@over:	lda	status	cmp	#walking	beq	@done	cmp	#crouching	beq	@done	rtl@done:	lda	#-1	sta	centrescroll	stz	lockscreen		lda	#50+8	sta	centrescry	lda	#3	sta	PICscroll,x		lda	doorknob	ora	nomainscroll	beq	@end	rtl@end:	jmp	TSKcancel		** bob is in spaceship on goth*bobspaceship:	;section deleted - boring...** boob climbs in car and leaves*bobleavegoth:	lda	caryadjust	beq	@ydone	dec	a	dec	a	sta	caryadjust	lda	#2	sta	bobymove	stz	bobxmove	rts@ydone:	ldy	whichbigship	lda	#0	sta	PICscroll,y	lda	takeoff			;give engines time to rev up	cmp	#TAKEOFFTIME	bcs	@fly	inc	takeoff			;pad delay time	stz	PICtemp1,x		;ship speed	stz	PICtemp2,x		;ship flight time	stz	PICcount,x	stz	PICcount2,x	bra	@notfast** ship takes off*@fly:	lda	PICcount,x	cmp	#7	bcs	@screamoff		lda	cputime	and	#15	cmp	#15	bne	@noinc	inc	PICcount,x	inc	PICtemp2,x@noinc:	lda	PICtemp2,x	sta	bobxmove	bra	@notfast@screamoff:	lda	PICcount2,x	cmp	#60	bcs	@driveoff	inc	a	sta	PICcount2,x	lda	#7	sta	bobxmove	bra	@notfast@driveoff:	lda	cputime	and	#15	cmp	#15	bne	@noinc2	dec	PICtemp2,x@noinc2:	lda	PICtemp2,x	sta	bobxmove	lda	#7	jsl	PICxadd	lda	PICtemp1,x	inc	a	sta	PICtemp1,x	cmp	#80	bcc	@notfast	lda	winflag	bne	@notfast	jsr	dofadeout	inc	winflag@notfast:	ldy	whichbigship	lda	PICxlo,x	sta	PICxlo,y	lda	PICylo,x	sta	PICylo,y		lda	PICxhi,x	sta	PICxhi,y	lda	PICyhi,x	sta	PICyhi,y	rts			** big ship in port*bigship:	lda	#32+8			;	jsl	PICysub		lda	#1	sta	PICscroll,x	sta	PICprior,x		lda	#3	sta	PICcolor,x		lda	#13	sta	PICbank,x		stx	whichbigship		lda	#type_generic	sta	PICtype,x		jsl	TSKsuspend** which world....*	lda	world	cmp	#2	bne	@cadd	jsl	PICput					dw	chev0	bra	@drawn@cadd:	cmp	#1	bne	@vette	jsl	PICput	dw	vetteframe0	bra	@drawn@vette:	jsl	PICput	dw	caddframe1	@drawn:** has the car taken off?*	lda	takeoff	bne	@stay		lda	PICxhi,x	bne	@stay		lda	PICxlo,x	cmp	#130	bcs	@stay		lda	PICylo,x	sec		sbc	bobypos	and	#$fe	sta	caryadjust		inc	takeoff	lda	#leavegoth	sta	status;	stz	PICscroll,x@stay:	rtl